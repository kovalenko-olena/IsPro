<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.4.3" DotMatrixReport="false" IniFile="\Software\Fast Reports" OldStyleProgress="true" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38908,4754065972" ReportOptions.Description.Text="" ReportOptions.Name="FR ЮГОК Расчетная ведомость по видам оплат 03/2023" ReportOptions.LastChange="44998,5154147454" ReportOptions.DirectExportType="deRtf" ReportOptions.DirectExportMode="dmOpen" ReportOptions.DirectExportPages="depSingleSheet" ReportOptions.DirectExportChunkSize="0" ScriptLanguage="PascalScript" ScriptText.Text="//===========================================================&#13;&#10;// Отчет 181 Расчетно-платежная ведомость на дату (RU)&#13;&#10;//===========================================================&#13;&#10;// SetUserRepParam/GetUserRepParam заменено на SetFirmUserRepParam/GetFirmUserRepParam // 12/11/10 16:33 CDN (445920)&#13;&#10;//===========================================================&#13;&#10;// Цех и МВЗ на последний день месяца&#13;&#10;// доработка март 2023&#13;&#10;&#13;&#10;var desc:integer;&#13;&#10;var str_sql,strsqlSe:string;&#13;&#10;var leng:integer;&#13;&#10;var datn,datk:TDateTime;&#13;&#10;var kolmon:Integer;&#13;&#10;var str_Query1:String;&#13;&#10;var SteCd :String;&#13;&#10;var pTn:Double;&#13;&#10;var sml,lnn:integer;&#13;&#10;var StrPdrSql,str_grppd:string;&#13;&#10;var ValMt:integer;&#13;&#10;var i,LIC,LIC1,Y:integer;&#13;&#10;const maxx=1;&#13;&#10;var masi1:array[1..maxx] of string;&#13;&#10;var mas_save:array[1..256] of string;&#13;&#10;var mas_save1:array[1..256] of string;&#13;&#10;var t_rec1,t_rec2,i2,z:integer;&#13;&#10;var str_vo,str_gr,str_pd,ss,ss1,hh,hh1,xxx,str_sm,str_smrp,str_nch,str_udr:string;&#13;&#10;var DTUP,DTUP1,LDTUP:TDateTime;&#13;&#10;var nu,ud:double;&#13;&#10;var str_sqlvo,str_vogrp:string;&#13;&#10;var strsmgrp,strsmgrpr,str_sld:string;&#13;&#10;var sld_in,sld_nch,sld_out,sld_udr:double;&#13;&#10;var sld_in1,sld_nch1,sld_out1,sld_udr1:double;&#13;&#10;//==========Псевдокоды для групп записей ВО =====&#13;&#10;//   1025 - Всего начислено&#13;&#10;//   1026 - Прочие начисления&#13;&#10;//   1027 - Всего удержано&#13;&#10;//   1028 - Прочие удержания&#13;&#10;//===============================================&#13;&#10;var massm:array[1..1024]of double;&#13;&#10;var massm1:array[1..1024]of double;&#13;&#10;var masgrp:array[1..1024]of string;&#13;&#10;var flg_act:integer;&#13;&#10;&#13;&#10;var flg_Pacc,flg_Tacc:integer;&#13;&#10;var CdFrm:integer;&#13;&#10;var strPacc,strTacc:string;&#13;&#10;&#13;&#10;// Флаг: 0 - создание, 1 - редактирование&#13;&#10;var flg_crt:integer;&#13;&#10;&#13;&#10;// Для хранения кодов ВО, включаемых в группы&#13;&#10;var massiv:array[1..1024]of string;&#13;&#10;// Индексы отмеченных записей&#13;&#10;var massividx:array[1..1024]of string;&#13;&#10;// Для хранения между сеансами&#13;&#10;var m:array[1..1024]of string;&#13;&#10;var m1:array[1..1024]of string;&#13;&#10;var m2:array[1..1024]of string;&#13;&#10;// Данные таблицы групп ВО&#13;&#10;var mas_tbl:array[1..1024,1..4]of string;&#13;&#10;&#13;&#10;// Виды оплат по группам (исключать из выборки)&#13;&#10;var str_groupvo:string;&#13;&#10;&#13;&#10;// Массив для итогов по группам&#13;&#10;var mgrp:array[1..1024]of double;&#13;&#10;var mgrp1:array[1..1024]of double;&#13;&#10;&#13;&#10;// ===== Для обработки TreeView&#13;&#10;var pRec_Ct:integer;&#13;&#10;var mspd:array[1..1]of string;&#13;&#10;var l:integer;&#13;&#10;var str_pcd:string;&#13;&#10;var RcdMrk,RcdMrkC:string;&#13;&#10;var RcdUncMrk:string;&#13;&#10;var Tmp_RcdMrk:string;&#13;&#10;var flg_Alt:integer;&#13;&#10;var inc_pd:string;&#13;&#10;//=========================================&#13;&#10;&#13;&#10;// 29/07/10 14:07 CDN { (442368)&#13;&#10;// ===================================================================================================================&#13;&#10;// _CheckStayOK - проверка возможности печати отчета&#13;&#10;// ===================================================================================================================&#13;&#10;procedure _CheckStayOK();&#13;&#10;begin&#13;&#10;  Button1.Enabled := False;&#13;&#10;    If ( ( RadioButton1.Checked = True ) Or ( ( RadioButton2.Checked = True ) And ( str_pd &#60;&#62; '' ) ) )&#13;&#10;       And&#13;&#10;       ( ( RadioButton3.Checked = True ) Or ( ( RadioButton4.Checked = True ) And ( str_vo &#60;&#62; '' ) ) )&#13;&#10;    Then&#13;&#10;      Begin&#13;&#10;        Button1.Enabled := True;&#13;&#10;      End;&#13;&#10;end;&#13;&#10;// 29/07/10 14:07 CDN } (442368)&#13;&#10;&#13;&#10;// Получить код родительского подразделения для группировки&#13;&#10;function GetGrpCd( pPD:String; pStr:String ):String;&#13;&#10;var tmpStr:String;&#13;&#10;var ResStr:String;&#13;&#10;begin&#13;&#10;  ResStr:='';&#13;&#10;  tmpStr:= pStr;&#13;&#10;  while Pos( ',', tmpStr )&#60;&#62;0 do&#13;&#10;    begin&#13;&#10;      If Copy( tmpStr, 1, Pos( ',', tmpStr )-1 )=Copy( pPD, 1, Length( Copy( tmpStr, 1, Pos( ',', tmpStr )-1 ) ) ) then&#13;&#10;        begin&#13;&#10;          ResStr:=Copy( tmpStr, 1, Pos( ',', tmpStr )-1 );&#13;&#10;        end;&#13;&#10;      Delete( tmpStr, 1, Pos( ',', tmpStr ) );&#13;&#10;    end;&#13;&#10;   If tmpStr=Copy( pPD, 1, Length( tmpStr ) ) then&#13;&#10;     begin&#13;&#10;       ResStr:=Copy( tmpStr, 1, Length( tmpStr ) );&#13;&#10;     end;&#13;&#10;   Delete( tmpStr, 1, Length( tmpStr ) );&#13;&#10;   Result:= ResStr;&#13;&#10;end;&#13;&#10;&#13;&#10;function DT_STR(D:TDateTime):string;  //(dd.mm.yyyy)&#13;&#10;var dd,mm:string;&#13;&#10;begin&#13;&#10;  If Length(DayOf(D))=1 then&#13;&#10;    begin&#13;&#10;      dd:='0'+IntToStr(DayOf(D));&#13;&#10;    end&#13;&#10;  Else If Length(DayOf(D))=2 then&#13;&#10;    begin&#13;&#10;      dd:=IntToStr(DayOf(D));&#13;&#10;    end;&#13;&#10;  If Length(MonthOf(D))=1 then&#13;&#10;    begin&#13;&#10;      mm:='0'+IntToStr(MonthOf(D));&#13;&#10;    end&#13;&#10;  Else If Length(MonthOf(D))=2 then&#13;&#10;    begin&#13;&#10;      mm:=IntToStr(MonthOf(D));&#13;&#10;    end;&#13;&#10;  Result:=dd+'.'+mm+'.'+IntToStr(YearOf(D));&#13;&#10;end;&#13;&#10;&#13;&#10;Function NVL(T:Integer):Integer;&#13;&#10;const ms=[74,34,48,49,50,95,79,80,81,116,29,83,78];&#13;&#10;var i:integer;&#13;&#10;begin&#13;&#10;  Result:=0;&#13;&#10;  For i:=0 to 12 do&#13;&#10;    begin&#13;&#10;      If ms[i]=T then&#13;&#10;        begin&#13;&#10;          Result:=1;&#13;&#10;          break;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;// Определяет количество месяцев между двумя датами&#13;&#10;function KolMonth(dat1 :TDATETIME; dat2 :TDATETIME) :Integer;&#13;&#10;var m1,m2,y1,y2 :integer;&#13;&#10;begin&#13;&#10;  m1 := MonthOf(dat1);&#13;&#10;  m2 := MonthOf(dat2);&#13;&#10;  y1 := YearOf(dat1);&#13;&#10;  y2 := YearOf(dat2);&#13;&#10;  Result := (y2-y1)*12+(m2-m1);&#13;&#10;end;&#13;&#10;&#13;&#10;function MY(D:TDateTime):string;&#13;&#10;var str_txt:string;&#13;&#10;begin&#13;&#10;  If MonthOf(D)=1 then&#13;&#10;    begin&#13;&#10;      str_txt:='январь';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=2 then&#13;&#10;    begin&#13;&#10;      str_txt:='февраль';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=3 then&#13;&#10;    begin&#13;&#10;      str_txt:='март';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=4 then&#13;&#10;    begin&#13;&#10;      str_txt:='апрель';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=5 then&#13;&#10;    begin&#13;&#10;      str_txt:='май';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=6 then&#13;&#10;    begin&#13;&#10;      str_txt:='июнь';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=7 then&#13;&#10;    begin&#13;&#10;      str_txt:='июль';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=8 then&#13;&#10;    begin&#13;&#10;      str_txt:='август';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=9 then&#13;&#10;    begin&#13;&#10;      str_txt:='сентябрь';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=10 then&#13;&#10;    begin&#13;&#10;      str_txt:='октябрь';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=11 then&#13;&#10;    begin&#13;&#10;      str_txt:='ноябрь';&#13;&#10;    end&#13;&#10;  Else If MonthOf(D)=12 then&#13;&#10;    begin&#13;&#10;      str_txt:='декабрь';&#13;&#10;    end;&#13;&#10;  str_txt:=str_txt+' '+IntToStr(YearOf(D));&#13;&#10;  Result:=str_txt;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  StopCloseReport;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnCloseQuery(Sender: TfrxComponent; var CanClose: Boolean);&#13;&#10;begin&#13;&#10;  If Page2.ModalResult=2 then&#13;&#10;  StopCloseReport;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If flg_Act=0 then&#13;&#10;    begin&#13;&#10;      If CheckBox5.Checked=True then&#13;&#10;        begin&#13;&#10;          DateEdit1.Enabled:=True;&#13;&#10;          ComboBox1.Enabled:=False;&#13;&#10;          ComboBox2.Enabled:=False;&#13;&#10;          CheckBox1.Checked:=False;&#13;&#10;          CheckBox1.Enabled:=False;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          DateEdit1.Enabled:=False;&#13;&#10;          ComboBox1.Enabled:=True;&#13;&#10;          ComboBox2.Enabled:=True;&#13;&#10;          CheckBox1.Enabled:=True;&#13;&#10;        end;&#13;&#10;      CheckBox2.Checked:=True;&#13;&#10;      CheckBox8.Checked:=True;    // VDG 05/04/2008&#13;&#10;      RadioButton1.Checked:=True;&#13;&#10;      RadioButton3.Checked:=True;&#13;&#10;      RadioButton5.Checked:=True;&#13;&#10;      If RadioButton1.Checked=True then&#13;&#10;        begin&#13;&#10;          Button3.Enabled:=False;&#13;&#10;          CheckBox4.Enabled:=False;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          Button3.Enabled:=True;&#13;&#10;          CheckBox4.Enabled:=True;&#13;&#10;        end;&#13;&#10;      If RadioButton3.Checked=True then&#13;&#10;        begin&#13;&#10;          Button4.Enabled:=False;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          Button4.Enabled:=True;&#13;&#10;        end;&#13;&#10;      CdFrm:=GetCargoVal( 'BPI_CDFIRM' );&#13;&#10;      strPacc:='select PayAcc_Pdr from PayAccP where PayAcc_Role = 0 and PayAcc_Usr = :Usr and PayAcc_IsKdr=0'+&#13;&#10;      ' union all select PayAcc_Pdr from PayAccP where PayAcc_Role = 1 and PayAcc_IsKdr=0 and PayAcc_Usr'+&#13;&#10;      ' in (select userrole_rcd from usertorole where user_rcd =:Usr1'+&#13;&#10;      ' and userrole_firm= :FrmCd'+&#13;&#10;      ' )';&#13;&#10;      strTacc:='SELECT Kpu_Tn FROM KpuX X INNER JOIN PayAccT ON'+&#13;&#10;      ' ((PayAccT.PayAcc_IsKdr = 0 AND PayAcc_Role = 0 AND PayAccT.PayAcc_Usr = :Usr2 AND X.Kpu_Tn BETWEEN PayAcc_TnOt AND PayAcc_TnDo)'+&#13;&#10;      ' OR (PayAccT.PayAcc_IsKdr = 0 AND PayAcc_Role = 1 AND PayAccT.PayAcc_Usr IN (SELECT UserRole_Rcd FROM UserToRole WHERE User_Rcd = :Usr3 AND UserRole_Firm = :FrmCd1) AND X.Kpu_Tn BETWEEN PayAcc_TnOt AND PayAcc_TnDo))';&#13;&#10;      // Подразделения&#13;&#10;      flg_Pacc:=0;&#13;&#10;      PDRACC.First;&#13;&#10;      If PDRACC.Eof = False then&#13;&#10;        begin&#13;&#10;          flg_Pacc:=1;&#13;&#10;        end;&#13;&#10;      // Табельные номера&#13;&#10;      flg_Tacc:=0;&#13;&#10;      TNACC.First;&#13;&#10;      If TNACC.Eof = False then&#13;&#10;        begin&#13;&#10;          flg_Tacc:=1;&#13;&#10;        end;&#13;&#10;      ComboBox1.Items.Clear;&#13;&#10;      ComboBox2.Items.Clear;&#13;&#10;      qDat.Open;&#13;&#10;      datn := &#60;qDat.&#34;datn&#34;&#62;;&#13;&#10;      If CheckBox9.Checked then&#13;&#10;        begin&#13;&#10;          Button20.Enabled := True;&#13;&#10;          RadioButton1.Enabled := False;&#13;&#10;          RadioButton2.Enabled := False;&#13;&#10;          Button3.Enabled := False;&#13;&#10;          CheckBox4.Enabled := True;&#13;&#10;          CheckBox4.Caption := 'Формировать один отчет на выбранные структурные единицы';&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          Button20.Enabled := False;&#13;&#10;          RadioButton1.Enabled := True;&#13;&#10;          RadioButton2.Enabled := True;&#13;&#10;          Button3.Enabled := False;&#13;&#10;          If RadioButton1.Checked=True then&#13;&#10;            begin&#13;&#10;              Button3.Enabled:=False;&#13;&#10;              CheckBox4.Enabled:=False;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Button3.Enabled:=True;&#13;&#10;              CheckBox4.Enabled:=True;&#13;&#10;            end;&#13;&#10;          CheckBox4.Caption := 'Формировать один отчет на выбранные подразделения';&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          datk := GetCargoVal('sPayRep_DatUp');&#13;&#10;          DateEdit1.Date:=GetCargoVal('sPayRep_DatUp');&#13;&#10;          // VDG 23/02/2009 СОИД 287232 {&#13;&#10;          //DateEdit1.Enabled := False;&#13;&#10;          //CheckBox5.Checked := False;&#13;&#10;          //CheckBox5.Enabled := False;&#13;&#10;          //ComboBox1.Enabled := False;&#13;&#10;          //ComboBox2.Enabled := False;&#13;&#10;          // VDG 23/02/2009 СОИД 287232 }&#13;&#10;          RadioButton1.Enabled := False;&#13;&#10;          RadioButton2.Enabled := False;&#13;&#10;          RadioButton1.Checked := True;&#13;&#10;          Button3.Enabled := False;&#13;&#10;          CheckBox4.Checked := False;&#13;&#10;          CheckBox4.Enabled := False;&#13;&#10;          CheckBox9.Enabled:= False;&#13;&#10;          CheckBox9.Checked:= False;&#13;&#10;          Button20.Enabled := False;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          datk := BPRO.CUR_UP().Value;&#13;&#10;          DateEdit1.Date:=BPRO.CUR_UP().Value;&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;      kolmon := KolMonth(datn,datk);&#13;&#10;      datk := datn;&#13;&#10;      for i := 0 to kolmon do&#13;&#10;        begin&#13;&#10;          If datk = BPRO.CUR_UP().Value then&#13;&#10;            begin&#13;&#10;              combobox1.Items.add(' '+BPRO.FMONTH_NAME(datk,1)+' '+chr(39)+Copy(inttostr(YearOf(datk)),3,2)+' (текущий)');&#13;&#10;              combobox2.Items.add(' '+BPRO.FMONTH_NAME(datk,1)+' '+chr(39)+Copy(inttostr(YearOf(datk)),3,2)+' (текущий)');&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              combobox1.Items.add(' '+BPRO.FMONTH_NAME(datk,1)+' '+chr(39)+Copy(inttostr(YearOf(datk)),3,2)+' (закрытый)');&#13;&#10;              combobox2.Items.add(' '+BPRO.FMONTH_NAME(datk,1)+' '+chr(39)+Copy(inttostr(YearOf(datk)),3,2)+' (закрытый)');&#13;&#10;            end;&#13;&#10;          datk := IncMonth(datk,1);&#13;&#10;        end;&#13;&#10;      Combobox1.ItemIndex := kolmon;&#13;&#10;      Combobox2.ItemIndex := kolmon;&#13;&#10;      // 31/08/10 YEA (444834)&#13;&#10;      if GetFirmUserRepParam('DateS') &#60;&#62; '' then&#13;&#10;        Combobox1.ItemIndex := StrToInt(GetFirmUserRepParam('DateS'));&#13;&#10;      if GetFirmUserRepParam('DatePo') &#60;&#62; '' then&#13;&#10;        Combobox2.ItemIndex := StrToInt(GetFirmUserRepParam('DatePo'));&#13;&#10;      // 31/08/10 YEA (444834)&#13;&#10;      CheckBox9.Checked := False;&#13;&#10;      _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;    end;&#13;&#10;  // 31/08/10 YEA (444834)&#13;&#10;  if GetFirmUserRepParam('I0') = '1'  then&#13;&#10;    RadioButton2.Checked := true//По предприятию&#13;&#10;  else&#13;&#10;    RadioButton1.Checked := true;//По подразделениям&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B1') = '1'  then&#13;&#10;    CheckBox4.Checked := true;//Формировать один отчёт на все подразделения&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B2') = '1'  then&#13;&#10;    CheckBox9.Checked := true;//По структурным единицам&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('I1') = '1'  then&#13;&#10;    RadioButton4.Checked := true;//Включать виды оплат выборочно&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B3') = '1'  then&#13;&#10;    CheckBox1.Checked := true;//Виды оплат выводятся в разрезе периодов, за которые расчитаны&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B4') = '1'  then&#13;&#10;    CheckBox2.Checked := true//Отображать записи, которые не входят в Н/У&#13;&#10;  else&#13;&#10;    CheckBox2.Checked := false;&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B5') = '1'  then&#13;&#10;    CheckBox3.Checked := true;//Учитывать поле номер п/п платёжной ведомости&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B6') = '1'  then&#13;&#10;    CheckBox6.Checked := true;//Отображать только работников с &#34;ненулевыми&#34; суммами&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('B7') = '1'  then&#13;&#10;    CheckBox8.Checked := true//Включать работников, у которых отсутствует движение по РЛ,...&#13;&#10;  else&#13;&#10;    CheckBox8.Checked := false;&#13;&#10;&#13;&#10;  if GetFirmUserRepParam('I2') = '1'  then&#13;&#10;    RadioButton6.Checked := true;//Сортировка по ТН&#13;&#10;  // 31/08/10 YEA (444834)&#13;&#10;  flg_act:=1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure FPDOnResize(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Button5.Anchors := [akRight, akBottom];&#13;&#10;  Button6.Anchors := [akRight, akBottom];&#13;&#10;  CheckBox7.Anchors:=[akBottom,akLeft];&#13;&#10;  Bevel6.Anchors:=[akRight, akBottom,akLeft];&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    // 31/08/10 YEA (444834)&#13;&#10;  if RadioButton1.Checked = true  then&#13;&#10;    SetFirmUserRepParam('I0', '0' )//По предприятию&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('I0', '1' );//По подразделениям&#13;&#10;&#13;&#10;  if CheckBox4.Checked = true then&#13;&#10;    SetFirmUserRepParam('B1','1')//Формировать один отчёт на все подразделения&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B1','0');&#13;&#10;&#13;&#10;  if CheckBox9.Checked = true then&#13;&#10;    SetFirmUserRepParam('B2','1')//По структурным единицам&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B2','0');&#13;&#10;&#13;&#10;  if RadioButton4.Checked = true then&#13;&#10;    SetFirmUserRepParam('I1', '1')//Включать виды оплат выборочно&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('I1', '0');&#13;&#10;&#13;&#10;  if  CheckBox1.Checked = true then&#13;&#10;    SetFirmUserRepParam('B3','1')//Виды оплат выводятся в разрезе периодов, за которые расчитаны&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B3','0');&#13;&#10;&#13;&#10;  if  CheckBox2.Checked = true then&#13;&#10;    SetFirmUserRepParam('B4','1')//Отображать записи, которые не входят в Н/У&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B4','0');&#13;&#10;&#13;&#10;  if  CheckBox3.Checked = true then&#13;&#10;    SetFirmUserRepParam('B5','1')//Учитывать поле номер п/п платёжной ведомости&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B5','0');&#13;&#10;&#13;&#10;  if  CheckBox6.Checked = true then&#13;&#10;    SetFirmUserRepParam('B6','1')//Отображать только работников с &#34;ненулевыми&#34; суммами&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B6','0');&#13;&#10;&#13;&#10;  if  CheckBox8.Checked = true then&#13;&#10;    SetFirmUserRepParam('B7','1')//Включать работников, у которых отсутствует движение по РЛ,...&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('B7','0');&#13;&#10;&#13;&#10;  if RadioButton6.Checked = true then&#13;&#10;    SetFirmUserRepParam('I2', '1')//Сортировка по ТН&#13;&#10;  else&#13;&#10;    SetFirmUserRepParam('I2', '0');&#13;&#10;&#13;&#10;  SetFirmUserRepParam( 'DateS', IntToStr(Combobox1.ItemIndex) );&#13;&#10;  SetFirmUserRepParam( 'DatePo',IntToStr(Combobox2.ItemIndex) );&#13;&#10;  // 31/08/10 YEA (444834)&#13;&#10;&#13;&#10;  str_Query1 := '';&#13;&#10;  If CheckBox9.Checked = False then&#13;&#10;    begin&#13;&#10;      SteCd := '';&#13;&#10;    end;&#13;&#10;  // Если строки пустые по всем записям (подразделения, виды оплат)&#13;&#10;  If str_vo='' then&#13;&#10;    begin&#13;&#10;      str_vo:='select vo_cd from payvo1 where vo_cd &#60;&#62;0';&#13;&#10;    end;&#13;&#10;  DTUP  := EncodeDate(YearOf(IncMonth(datn,Combobox1.ItemIndex)),MonthOf(IncMonth(datn,Combobox1.ItemIndex)),1);&#13;&#10;  DTUP1  := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),1);&#13;&#10;  LDTUP := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),DaysInMonth(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex))));&#13;&#10;  GetDsMark(120);&#13;&#10;  dsMark.First;&#13;&#10;  If dsMark.EOF = False then&#13;&#10;    begin&#13;&#10;      BPRO.PUT_MRK_SRV(120);&#13;&#10;    end;&#13;&#10;  If (DTUP=BPRO.CUR_UP().Value) or (DTUP1=BPRO.CUR_UP().Value) then&#13;&#10;    begin&#13;&#10;      If BPRO.PAY_CALC_PRED(1).Value = 0 THEN StopCloseReport;&#13;&#10;    end;&#13;&#10;&#13;&#10;  // VDG 16/04/2009 СОИД 308070 {&#13;&#10;  // Условия на исключение ВО , который входят в группы ниже добавлено&#13;&#10;  // а str_groupvo была пустая, вашу мать .....&#13;&#10;  TBL.First;&#13;&#10;  str_groupvo:='';&#13;&#10;  while not TBL.Eof do&#13;&#10;    begin&#13;&#10;    // Группа определена (включены виды оплат для группировки)&#13;&#10;      If &#60;TBL.&#34;PRZ&#34;&#62;=1 then&#13;&#10;        begin&#13;&#10;          If massiv[&#60;TBL.&#34;ID&#34;&#62;+1]&#60;&#62;'' then&#13;&#10;            begin&#13;&#10;              str_groupvo:=str_groupvo+massiv[&#60;TBL.&#34;ID&#34;&#62;+1]+',';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      TBL.Next;&#13;&#10;    end;&#13;&#10;  str_groupvo:=Copy(str_groupvo,1,Length(str_groupvo)-1);&#13;&#10;  If str_groupvo = '' then&#13;&#10;    begin&#13;&#10;      str_groupvo := '0';&#13;&#10;    end;&#13;&#10;  // VDG 16/04/2009 СОИД 308070 }&#13;&#10;&#13;&#10;  // Расчетная ведомость за интервал учетных периодов&#13;&#10;  If CheckBox5.Checked = False then&#13;&#10;    begin&#13;&#10;      str_Query1 := str_Query1+' SELECT KpuX.Kpu_Tn,KpuC1.Kpu_Fio,'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ('+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   SELECT CASE WHEN SUM({fn convert(KpuRl_Sin,SQL_DECIMAL)})/({fn Power(10,:mt)}) IS NULL'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   THEN 0'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   ELSE SUM({fn convert(KpuRl_Sin,SQL_DECIMAL)})/({fn Power(10,:mt1)})'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   END'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   FROM KpuRloNus'+Chr(13);&#13;&#10;// 17/05/10 12:28 CDN { (420042)&#13;&#10;//      str_Query1 := str_Query1+'   WHERE KpuRloNus.KpuRl_DatUp BETWEEN :DTUP1 AND :DTUP2'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   WHERE KpuRloNus.KpuRl_DatUp = :DTUP1 '+Chr(13);&#13;&#10;// 17/05/10 12:28 CDN } (420042)&#13;&#10;      str_Query1 := str_Query1+'   AND KpuRloNus.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ) As KpuRl_Sin,'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ('+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   SELECT CASE WHEN SUM({fn convert(KpuRl_Nch,SQL_DECIMAL)})/({fn Power(10,:mt2)}) IS NULL'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   THEN 0'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   ELSE SUM({fn convert(KpuRl_Nch,SQL_DECIMAL)})/({fn Power(10,:mt3)})'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   END'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   FROM KpuRloNus'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   WHERE KpuRloNus.KpuRl_DatUp BETWEEN :DTUP3 AND :DTUP4'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   AND KpuRloNus.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ) As KpuRl_Nch,'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ('+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   SELECT CASE WHEN SUM({fn convert(KpuRl_Udr,SQL_DECIMAL)})/({fn Power(10,:mt4)}) IS NULL'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   THEN 0'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   ELSE SUM({fn convert(KpuRl_Udr,SQL_DECIMAL)})/({fn Power(10,:mt5)})'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   END'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   FROM KpuRloNus'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   WHERE KpuRloNus.KpuRl_DatUp BETWEEN :DTUP5 AND :DTUP6'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   AND KpuRloNus.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ) As KpuRl_Udr,'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ('+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   SELECT CASE WHEN SUM({fn convert(KpuRl_Sout,SQL_DECIMAL)})/({fn Power(10,:mt6)}) IS NULL'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   THEN 0'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   ELSE SUM({fn convert(KpuRl_Sout,SQL_DECIMAL)})/({fn Power(10,:mt7)})'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   END'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   FROM KpuRloNus'+Chr(13);&#13;&#10;// 17/05/10 12:28 CDN { (420042)&#13;&#10;//      str_Query1 := str_Query1+'   WHERE KpuRloNus.KpuRl_DatUp BETWEEN :DTUP7 AND :DTUP8'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   WHERE KpuRloNus.KpuRl_DatUp = :DTUP8'+Chr(13);&#13;&#10;// 17/05/10 12:28 CDN } (420042)&#13;&#10;      str_Query1 := str_Query1+'   AND KpuRloNus.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ) As KpuRl_Sout'+Chr(13);&#13;&#10;      // По подразделениям&#13;&#10;      If (RadioButton2.Checked) AND (CheckBox4.Checked = False) then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+',Podr.SprPdr_NmFull,Podr.SprPdr_Pd,Podr.SprPdr_Pos'+Chr(13);&#13;&#10;        end;&#13;&#10;      // По структурным единицам&#13;&#10;      If (CheckBox9.Checked) AND (SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+',PayAcc_Se'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_Query1 := str_Query1+' FROM KpuX'+Chr(13);&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;          str_Query1 := str_Query1+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;      str_Query1 := str_Query1+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      // 06&#13;&#10;      If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;       //студенты&#13;&#10;         str_Query1 := str_Query1+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;      else&#13;&#10;       //работники&#13;&#10;         str_Query1 := str_Query1+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248)}&#13;&#10;      str_Query1 := str_Query1+' INNER JOIN KpuPrk1 ON KPUPRK1.bookmark ='+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   ( SELECT MAX(P2.bookmark)'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     FROM KpuPRk1 P2'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     WHERE P2.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'       ( SELECT MAX(P1.KpuPrkz_DtV)'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'         FROM KPUPRK1 P1'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'         WHERE KpuC1.Kpu_Rcd=P1.Kpu_Rcd AND P1.KpuPrkz_DtV &#60;=:DDT'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'         AND P1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'       )'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     AND P2.Kpu_Rcd=KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     AND P2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   )'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' INNER JOIN '+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ('+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' SELECT DISTINCT FF.Kpu_Tn';&#13;&#10;      str_Query1 := str_Query1+' FROM';&#13;&#10;      str_Query1 := str_Query1+' (';&#13;&#10;      str_Query1 := str_Query1+'   SELECT Rl.Kpu_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   FROM KpuRlo1 Rl'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   WHERE Rl.KpuRl_DatUp BETWEEN :DTT1 AND :DTT2'+Chr(13);&#13;&#10;      // СОИД 172828 04.06.2007 { =======================&#13;&#10;      // Отобразить работников только с &#34;ненулевыми&#34; суммами&#13;&#10;      If CheckBox6.Checked=True then&#13;&#10;        begin&#13;&#10;          // Выборочно по видам оплат&#13;&#10;          If RadioButton4.Checked then&#13;&#10;            begin&#13;&#10;              str_Query1 := str_Query1 + ' AND KpuRl_CdVo IN ('+str_vo+')'+Chr(13);&#13;&#10;            end;&#13;&#10;          // VDG 27/05/2009 СОИД 314334 {&#13;&#10;          str_Query1 := str_Query1 + ' AND Rl.KpuRl_Sm &#60;&#62; 0'+Chr(13);&#13;&#10;          // VDG 27/05/2009 СОИД 314334 }&#13;&#10;        end;&#13;&#10;      // Не включать записи внутренних совместителей&#13;&#10;      // 14.06.2007 WOLF&#13;&#10;      str_Query1 := str_Query1 + ' and { fn MOD( { fn TRUNCATE( Rl.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      // USV - не нужно фильтровать эти записи&#13;&#10;      // 10/03/2009&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //str_Query1 := str_Query1 + ' and { fn MOD( { fn TRUNCATE( Rl.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      // СОИД 181838 18/10/2007 Включать работников, у которых нет записей в РЛ&#13;&#10;      // и есть ненулевое сальдо ==========================================={&#13;&#10;      If CheckBox8.Checked then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1 +' UNION ALL'+Chr(13);&#13;&#10;          str_Query1 := str_Query1 +' SELECT Nus.Kpu_Tn'+Chr(13);&#13;&#10;          str_Query1 := str_Query1 +' FROM KpuRloNus Nus'+Chr(13);&#13;&#10;          str_Query1 := str_Query1 +' WHERE Nus.KpuRl_DatUp BETWEEN :DTUP9 AND :DTUP10'+Chr(13);&#13;&#10;          str_Query1 := str_Query1 +' AND ( Nus.KpuRl_Sin &#60;&#62; 0 OR Nus.KpuRl_Sout &#60;&#62; 0 )'+Chr(13);&#13;&#10;        end;&#13;&#10;      // =================================================================== }&#13;&#10;      str_Query1 := str_Query1 + ' ) FF '+Chr(13);&#13;&#10;      str_Query1 := str_Query1 + ' ) AA ON KpuX.Kpu_Tn = AA.Kpu_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1 + ' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :DDT1 between SprPdr_DatN and SprPdr_DatK '+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1 + 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;          str_Query1 := str_Query1 + 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_Query1 := str_Query1 + ' WHERE '+Chr(13);&#13;&#10;&#13;&#10;      str_Query1 := str_Query1 + '  { fn MOD( { fn TRUNCATE( Kpu_Flg / 2, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;      str_Query1 := str_Query1 + ' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 1, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1 + 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      If dsMark.EOF = False then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      Query1.SQL.Text := str_Query1;&#13;&#10;      Query1.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt1').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt2').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt3').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt4').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt5').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt6').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('mt7').DataType:=ftInteger;&#13;&#10;      Query1.ParamByName('DTUP1').DataType:=ftDate;&#13;&#10;// 17/05/10 12:28 CDN (420042)       Query1.ParamByName('DTUP2').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTUP3').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTUP4').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTUP5').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTUP6').DataType:=ftDate;&#13;&#10;// 17/05/10 12:28 CDN (420042)       Query1.ParamByName('DTUP7').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTUP8').DataType:=ftDate;&#13;&#10;      If CheckBox8.Checked then&#13;&#10;        begin&#13;&#10;          Query1.ParamByName('DTUP9').DataType:=ftDate;&#13;&#10;          Query1.ParamByName('DTUP10').DataType:=ftDate;&#13;&#10;        end;&#13;&#10;      Query1.ParamByName('DTT1').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTT2').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DDT').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DDT1').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('mt').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt1').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt2').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt3').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt4').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt5').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt6').Value:=ValMt;&#13;&#10;      Query1.ParamByName('mt7').Value:=ValMt;&#13;&#10;      Query1.ParamByName('DTUP1').Value:=DTUP;&#13;&#10;// 17/05/10 12:28 CDN (420042)       Query1.ParamByName('DTUP2').Value:=DTUP1;&#13;&#10;      Query1.ParamByName('DTUP3').Value:=DTUP;&#13;&#10;      Query1.ParamByName('DTUP4').Value:=DTUP1;&#13;&#10;      Query1.ParamByName('DTUP5').Value:=DTUP;&#13;&#10;      Query1.ParamByName('DTUP6').Value:=DTUP1;&#13;&#10;// 17/05/10 12:28 CDN (420042)       Query1.ParamByName('DTUP7').Value:=DTUP;&#13;&#10;      Query1.ParamByName('DTUP8').Value:=DTUP1;&#13;&#10;      If CheckBox8.Checked then&#13;&#10;        begin&#13;&#10;          Query1.ParamByName('DTUP9').Value:=DTUP;&#13;&#10;          Query1.ParamByName('DTUP10').Value:=DTUP1;&#13;&#10;        end;&#13;&#10;      Query1.ParamByName('DTT1').Value:=DTUP;&#13;&#10;      Query1.ParamByName('DTT2').Value:=DTUP1;&#13;&#10;      Query1.ParamByName('DDT').Value:=LDTUP;&#13;&#10;      Query1.ParamByName('DDT1').Value:=LDTUP;&#13;&#10;    end&#13;&#10;  // Расчетная ведомость на дату&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      str_Query1 := str_Query1+' SELECT KpuX.Kpu_Tn,KpuC1.Kpu_Fio'+Chr(13);&#13;&#10;      // По подразделениям&#13;&#10;      If (RadioButton2.Checked) AND (CheckBox4.Checked = False) then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+',Podr.SprPdr_NmFull,Podr.SprPdr_Pd,Podr.SprPdr_Pos'+Chr(13);&#13;&#10;        end;&#13;&#10;      // По структурным единицам&#13;&#10;      If (CheckBox9.Checked) AND (SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+',PayAcc_Se'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_Query1 := str_Query1+' FROM KpuX'+Chr(13);&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;          str_Query1 := str_Query1+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;      str_Query1 := str_Query1+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248){&#13;&#10;      If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;       //студенты&#13;&#10;         str_Query1 := str_Query1+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;      else&#13;&#10;       //работники&#13;&#10;         str_Query1 := str_Query1+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248)}&#13;&#10;      str_Query1 := str_Query1+' INNER JOIN KpuPrk1 ON KPUPRK1.bookmark ='+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   ( SELECT MAX(P2.bookmark)'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     FROM KpuPRk1 P2'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     WHERE P2.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'       ( SELECT MAX(P1.KpuPrkz_DtV)'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'         FROM KPUPRK1 P1'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'         WHERE KpuC1.Kpu_Rcd=P1.Kpu_Rcd AND P1.KpuPrkz_DtV &#60;=:DDT'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'         AND P1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'       )'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     AND P2.Kpu_Rcd=KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'     AND P2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   )'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' INNER JOIN'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+' ( SELECT DISTINCT Rl.PayRld_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   FROM  PayRldo1 Rl'+Chr(13);&#13;&#10;      str_Query1 := str_Query1+'   WHERE Rl.PayRld_Dat BETWEEN :DTT1 AND :DTT2'+Chr(13);&#13;&#10;      // СОИД 172828 04.06.2007 { =======================&#13;&#10;      // Отобразить работников только с &#34;ненулевыми&#34; суммами&#13;&#10;      If CheckBox6.Checked=True then&#13;&#10;        begin&#13;&#10;          // Выборочно по видам оплат&#13;&#10;          If RadioButton4.Checked then&#13;&#10;            begin&#13;&#10;              str_Query1 := str_Query1 + ' AND Rl_CdVo IN ('+str_vo+')'+Chr(13);&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // Не включать записи внутренних совместителей&#13;&#10;      // 14.06.2007 WOLF&#13;&#10;      str_Query1 := str_Query1 + ' and { fn MOD( { fn TRUNCATE( Rl.rl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      // USV Не надо фильтровать такие записи&#13;&#10;      // 10/03/2009 {&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //str_Query1 := str_Query1 + ' and { fn MOD( { fn TRUNCATE( Rl.rl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      str_Query1 := str_Query1 + ' ) AA ON KpuX.Kpu_Tn = AA.PayRld_Tn'+Chr(13);&#13;&#10;      str_Query1 := str_Query1 + ' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :DDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1 + 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;          str_Query1 := str_Query1 + 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_Query1 := str_Query1 + ' WHERE '+Chr(13);&#13;&#10;      str_Query1 := str_Query1 + '  { fn MOD( { fn TRUNCATE( Kpu_Flg / 2, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;      str_Query1 := str_Query1 + ' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 1, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1 + 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      If dsMark.EOF = False then&#13;&#10;        begin&#13;&#10;          str_Query1 := str_Query1+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      Query1.SQL.Text := str_Query1;&#13;&#10;      Query1.ParamByName('DTT1').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTT2').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DDT').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DDT1').DataType:=ftDate;&#13;&#10;      Query1.ParamByName('DTT1').Value:=DateEdit1.Date;&#13;&#10;      Query1.ParamByName('DTT2').Value:=DateEdit1.Date;&#13;&#10;      Query1.ParamByName('DDT').Value:=DateEdit1.Date;&#13;&#10;      Query1.ParamByName('DDT1').Value:=DateEdit1.Date;&#13;&#10;    end;&#13;&#10;  // ==============================================}&#13;&#10;  // Отобразить работников только с &#34;ненулевыми&#34; суммами&#13;&#10;  If CheckBox6.Checked=True then&#13;&#10;    begin&#13;&#10;    // За интервал учетных периодов&#13;&#10;      If CheckBox5.Checked=False then&#13;&#10;        begin&#13;&#10;          // Доступ к подразделениям&#13;&#10;          If flg_Pacc=1 then&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add(' and kpuprk1.kpuprkz_pd in ('+strPacc+')');&#13;&#10;              Query1.ParamByName('Usr').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr1').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('FrmCd').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('Usr1').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('FrmCd').Value:=CdFrm;&#13;&#10;            end;&#13;&#10;          // Доступ к табельным номерам&#13;&#10;          If flg_Tacc=1 then&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add(' and kpux.kpu_tn in ('+strTacc+')');&#13;&#10;              Query1.ParamByName('Usr2').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr3').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('FrmCd1').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr2').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('Usr3').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('FrmCd1').Value:=CdFrm;&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      // На дату&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          // Доступ к подразделениям&#13;&#10;          If flg_Pacc=1 then&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add(' and kpuprk1.kpuprkz_pd in ('+strPacc+')');&#13;&#10;              Query1.ParamByName('Usr').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr1').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('FrmCd').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('Usr1').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('FrmCd').Value:=CdFrm;&#13;&#10;            end;&#13;&#10;          // Доступ к табельным номерам&#13;&#10;          If flg_Tacc=1 then&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add(' and kpux.kpu_tn in ('+strTacc+')');&#13;&#10;              Query1.ParamByName('Usr2').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr3').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('FrmCd1').DataType:=ftInteger;&#13;&#10;              Query1.ParamByName('Usr2').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('Usr3').Value:=BPRO.USER_RCD.Value;&#13;&#10;              Query1.ParamByName('FrmCd1').Value:=CdFrm;&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      // Доступ к подразделениям&#13;&#10;      If flg_Pacc=1 then&#13;&#10;        begin&#13;&#10;          Query1.SQL.Add(' and kpuprk1.kpuprkz_pd in ('+strPacc+')');&#13;&#10;          Query1.ParamByName('Usr').DataType:=ftInteger;&#13;&#10;          Query1.ParamByName('Usr1').DataType:=ftInteger;&#13;&#10;          Query1.ParamByName('FrmCd').DataType:=ftInteger;&#13;&#10;          Query1.ParamByName('Usr').Value:=BPRO.USER_RCD.Value;&#13;&#10;          Query1.ParamByName('Usr1').Value:=BPRO.USER_RCD.Value;&#13;&#10;          Query1.ParamByName('FrmCd').Value:=CdFrm;&#13;&#10;        end;&#13;&#10;      // Доступ к табельным номерам&#13;&#10;      If flg_Tacc=1 then&#13;&#10;        begin&#13;&#10;          Query1.SQL.Add(' and kpux.kpu_tn in ('+strTacc+')');&#13;&#10;          Query1.ParamByName('Usr2').DataType:=ftInteger;&#13;&#10;          Query1.ParamByName('Usr3').DataType:=ftInteger;&#13;&#10;          Query1.ParamByName('FrmCd1').DataType:=ftInteger;&#13;&#10;          Query1.ParamByName('Usr2').Value:=BPRO.USER_RCD.Value;&#13;&#10;          Query1.ParamByName('Usr3').Value:=BPRO.USER_RCD.Value;&#13;&#10;          Query1.ParamByName('FrmCd1').Value:=CdFrm;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  If str_pd='' then&#13;&#10;    begin&#13;&#10;      PDR.Close;&#13;&#10;      PDR.SQL.TEXT:=StrPdrSql;&#13;&#10;      PDR.ParamByname('DT').DataType:=ftDate;&#13;&#10;      PDR.ParamByname('DT').Value:=LDTUP;&#13;&#10;      PDR.First;&#13;&#10;      while not PDR.Eof do&#13;&#10;        begin&#13;&#10;          str_pd:=str_pd+IntToStr(&#60;PDR.&#34;SPRPDR_RCD&#34;&#62;)+',';&#13;&#10;          PDR.Next;&#13;&#10;        end;&#13;&#10;      str_pd:=Copy(str_pd,1,Length(str_pd)-1);&#13;&#10;    end;&#13;&#10;  FPD.Visible:=False;&#13;&#10;  FVO.Visible:=False;&#13;&#10;  GRP.Visible:=False;&#13;&#10;  CRT.Visible:=False;&#13;&#10;  GRPVO.Visible:=False;&#13;&#10;  // СОИД 109588 04.10.2006 wolf&#13;&#10;  If CheckBox5.Checked=True then&#13;&#10;    // Отчет на дату&#13;&#10;    begin&#13;&#10;      Page1.Visible:=False;&#13;&#10;      Page3.Visible:=True;&#13;&#10;      str_sm := 'SELECT KpuX.Kpu_Tn, Vo_Cd,('+Chr(13);&#13;&#10;      str_sm := str_sm+' SELECT'+Chr(13);&#13;&#10;      str_sm := str_sm+' CASE WHEN SUM({fn CONVERT(RL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt)} IS NULL THEN 0 ELSE SUM({fn CONVERT(RL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt1)} END'+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM PayRlDo1'+Chr(13);&#13;&#10;      str_sm := str_sm+' WHERE PayRld_Dat = :DT1'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND PayRlDo1.PayRlD_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND PayRlDo1.Rl_CdVo = PayVo1.Vo_cd'+Chr(13);&#13;&#10;      str_sm := str_sm+' ) AS KpuRl_Sm '+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM PayVo1'+Chr(13);&#13;&#10;      str_sm := str_sm+' INNER JOIN KpuX ON 1=1'+Chr(13);&#13;&#10;      If dsMark.EOF = False then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;          str_sm := str_sm+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;      str_sm := str_sm+' INNER JOIN'+Chr(13);&#13;&#10;      str_sm := str_sm+' ( SELECT DISTINCT Rl.PayRlD_Tn'+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM PayRlDo1 Rl'+Chr(13);&#13;&#10;      str_sm := str_sm+' WHERE Rl.PayRld_Dat = :DT2'+Chr(13);&#13;&#10;      str_sm := str_sm+' ) AA ON KpuX.Kpu_Tn = AA.PayRlD_Tn'+Chr(13);&#13;&#10;      str_sm := str_sm+' INNER JOIN'+Chr(13);&#13;&#10;      str_sm := str_sm+' ( SELECT DISTINCT RVo.Rl_CdVo'+Chr(13);&#13;&#10;      // СОИД 121880 WOLF 19.04.2007&#13;&#10;      // ' FROM ( SELECT RlVo.Rl_CdVo,SUM(Rl_Sm) as Sm'+Chr(13)+&#13;&#10;      str_sm := str_sm+' FROM ( SELECT RlVo.Rl_CdVo'+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM PayRlDo1 RlVo'+Chr(13);&#13;&#10;      // VDG 18/06/2009 СОИД 323730 {&#13;&#10;      str_sm := str_sm+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      If dsMark.EOF = False then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      // VDG 16/09/2009 СОИД 341142 {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;          str_sm := str_sm+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;        end;&#13;&#10;      // VDG 16/09/2009 СОИД 341142 }&#13;&#10;      str_sm := str_sm+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark= ( SELECT MAX(PP1.bookmark) FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;      str_sm := str_sm+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd AND PP1.KpuPrkz_RkPd = 1 AND PP1.KpuPrkz_Dtv = ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM KpuPrk1 PP2 WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd AND PP2.KpuPrkz_RkPd = 1 AND PP2.KpuPrkz_Dtv &#60;= :DTREP1 ))'+Chr(13);&#13;&#10;      str_sm := str_sm+' left JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :DTREP2 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;      // Выборочно по подразделениям&#13;&#10;      If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          // Включать подчиненные подразделения&#13;&#10;          If CheckBox7.Checked then&#13;&#10;            begin&#13;&#10;              str_sm := str_sm+'and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;            end&#13;&#10;          // Не включать подчиненные подразделения&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              str_sm := str_sm+'and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // VDG 18/06/2009 СОИД 323730 }&#13;&#10;      str_sm := str_sm+' WHERE RlVo.PayRlD_Dat = :DT3'+Chr(13);&#13;&#10;      str_sm := str_sm+' GROUP BY RlVo.Rl_CdVo'+Chr(13);&#13;&#10;      str_sm := str_sm+' HAVING SUM({fn CONVERT(RL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt10)}&#60;&#62;0'+Chr(13);&#13;&#10;      str_sm := str_sm+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.Rl_CdVo'+Chr(13);&#13;&#10;      str_sm := str_sm+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248){&#13;&#10;      If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;       //студенты&#13;&#10;         str_sm := str_sm+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;      else&#13;&#10;       //работники&#13;&#10;         str_sm := str_sm+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248)}&#13;&#10;      str_sm := str_sm+' INNER JOIN KpuPrk1 ON KpuPRk1.bookmark ='+Chr(13);&#13;&#10;      str_sm := str_sm+' ( SELECT MAX(P1.bookmark)'+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM KpuPrk1 P1'+Chr(13);&#13;&#10;      str_sm := str_sm+' WHERE P1.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND P1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND P1.KpuPrkz_Dtv = '+Chr(13);&#13;&#10;      str_sm := str_sm+' ( SELECT MAX(P2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;      str_sm := str_sm+' FROM KpuPrk1 P2'+Chr(13);&#13;&#10;      str_sm := str_sm+' WHERE P2.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND P2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND P2.KpuPrkz_Dtv &#60;= :DT4 ) )'+Chr(13);&#13;&#10;      str_sm := str_sm+' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :DDD between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) OR ( SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;          str_sm := str_sm+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_sm := str_sm+' WHERE Vo_Cd &#60;&#62; 0'+Chr(13);&#13;&#10;      str_sm := str_sm+' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 2, 0 ) }, 2 ) } = 0 '+Chr(13);&#13;&#10;      str_sm := str_sm+' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 1, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) OR ( SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;        end;&#13;&#10;&#13;&#10;      //If dsMark.EOF = False then&#13;&#10;      //  begin&#13;&#10;      //    str_sm := str_sm+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;      //  end;&#13;&#10;      QSM.SQL.TEXT := str_sm;&#13;&#10;      QSM.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      QSM.ParamByName('mt1').DataType:=ftInteger;&#13;&#10;      QSM.ParamByName('mt10').DataType:=ftInteger;&#13;&#10;      QSM.ParamByName('DT1').DataType:=ftDate;&#13;&#10;      QSM.ParamByName('DT2').DataType:=ftDate;&#13;&#10;      QSM.ParamByName('DT3').DataType:=ftDate;&#13;&#10;      QSM.ParamByName('DT4').DataType:=ftDate;&#13;&#10;      QSM.ParamByName('DDD').DataType:=ftDate;&#13;&#10;      QSM.ParamByName('DTREP1').DataType := ftDate;&#13;&#10;      QSM.ParamByname('DTREP2').DataType := ftDate;&#13;&#10;      QSM.ParamByName('mt').Value:=ValMt;&#13;&#10;      QSM.ParamByName('mt1').Value:=ValMt;&#13;&#10;      QSM.ParamByName('mt10').Value:=ValMt;&#13;&#10;      QSM.ParamByName('DT1').Value:=DateEdit1.Date;&#13;&#10;      QSM.ParamByName('DT2').Value:=DateEdit1.Date;&#13;&#10;      QSM.ParamByName('DT3').Value:=DateEdit1.Date;&#13;&#10;      QSM.ParamByName('DT4').Value:=DateEdit1.Date;&#13;&#10;      QSM.ParamByName('DDD').Value:=DateEdit1.Date;&#13;&#10;      QSM.ParamByName('DTREP1').Value := DateEdit1.Date;&#13;&#10;      QSM.ParamByName('DTREP2').Value := DateEdit1.Date;&#13;&#10;      // Включать работников только с ненулевыми суммами&#13;&#10;      If CheckBox6.Checked=True then&#13;&#10;        begin&#13;&#10;          // Включать все виды оплат&#13;&#10;          If RadioButton3.Checked = True then&#13;&#10;            begin&#13;&#10;            end&#13;&#10;          // Выборочно по видам оплат&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              QSM.SQL.Add('and vo_cd in ('+str_vo+')');&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      // Всех работников&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          // Включать все виды оплат&#13;&#10;          If RadioButton3.Checked = True then&#13;&#10;            begin&#13;&#10;            end&#13;&#10;          // Выборочно по видам оплат&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              QSM.SQL.Add('and vo_cd in ('+str_vo+')');&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // Доступ к подразделениям&#13;&#10;      If flg_Pacc=1 then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add(' and kpuprk1.kpuprkz_pd in ('+strPacc+')');&#13;&#10;          QSM.ParamByName('Usr').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr1').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('FrmCd').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('Usr1').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('FrmCd').Value:=CdFrm;&#13;&#10;        end;&#13;&#10;      // Доступ к табельным номерам&#13;&#10;      If flg_Tacc=1 then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add(' and kpux.kpu_tn in ('+strTacc+')');&#13;&#10;          QSM.ParamByName('Usr2').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr3').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('FrmCd1').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr2').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('Usr3').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('FrmCd1').Value:=CdFrm;&#13;&#10;        end;&#13;&#10;      // Включать записи в которые не входит начисленно/удержано&#13;&#10;      If CheckBox2.Checked = False then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add('and vo_nur = 0 ');&#13;&#10;          QSM.SQL.Add('AND Vo_Met not in (74,34,48,49,50,95,79,80,81,116,29,83,78)');&#13;&#10;        end;&#13;&#10;      // Выборочно по подразделениям&#13;&#10;      If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          // Включать подчиненные подразделения&#13;&#10;          If CheckBox7.Checked then&#13;&#10;            begin&#13;&#10;              QSM.SQL.Add('and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})');&#13;&#10;            end&#13;&#10;          // Не включать подчиненные подразделения&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              QSM.SQL.Add('and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))');&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // Группы видов оплат&#13;&#10;      If str_groupvo &#60;&#62; '' then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add('and payvo1.vo_cd not in ('+str_groupvo+')');&#13;&#10;        end;&#13;&#10;      strsmgrp:='select sum({fn convert(payrldo1.rl_sm,SQL_DECIMAL)})/({fn Power(10,:mt)}) as kpurl_Sm'+Chr(13)+&#13;&#10;      ' from payrldo1'+Chr(13)+&#13;&#10;      ' inner join payvo1 on payrldo1.rl_cdvo=payvo1.vo_cd'+Chr(13)+&#13;&#10;      ' where payrldo1.payrld_tn=:tn'+Chr(13)+&#13;&#10;      ' and payrldo1.payrld_Dat=:DT'+Chr(13)+&#13;&#10;      ' and { fn MOD( { fn TRUNCATE( payrldo1.rl_prz / 65536,  0 ) }, 2 ) }=0'+Chr(13);&#13;&#10;      // USV Не надо фильтровать такие записи&#13;&#10;      // 10/03/2009 {&#13;&#10;      //' and { fn MOD( { fn TRUNCATE( payrldo1.rl_prz2 / 2,  0 ) }, 2 ) }=0'+Chr(13);&#13;&#10;      SMGRP.SQL.Text:=strsmgrp;&#13;&#10;      SMGRP.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('tn').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SMGRP.ParamByName('mt').Value:=ValMt;&#13;&#10;      SMGRP.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;      str_nch:='select sum({fn convert(payrldo1.rl_sm,SQL_DECIMAL)})/({fn Power(10,:mt)}) as nch'+Chr(13)+&#13;&#10;      ' from payrldo1'+Chr(13)+&#13;&#10;      ' inner join payvo1 on rl_cdvo=vo_cd'+Chr(13)+&#13;&#10;      ' where { fn MOD( { fn TRUNCATE( payrldo1.Rl_Prz / 65536,  0 ) }, 2 ) }=0'+Chr(13)+&#13;&#10;      // USV Не надо фильтровать такие записи&#13;&#10;      // 10/03/2009 {&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //' and { fn MOD( { fn TRUNCATE( payrldo1.Rl_Prz2 / 2,  0 ) }, 2 ) }=0'+Chr(13)+&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      ' and vo_nur=0'+Chr(13)+&#13;&#10;      ' and vo_Met not in (74,34,48,49,50,95,79,80,81,116,29,83,78)'+Chr(13)+&#13;&#10;      ' and vo_grp&#60;=127'+Chr(13)+&#13;&#10;      ' and payrld_dat=:DT and payrld_tn = :tn'+Chr(13);&#13;&#10;     // ' and payrld_dat BETWEEN :DTBEG AND :DT and payrld_tn = :tn'+Chr(13);&#13;&#10;      QNCH.SQL.Text:=str_nch;&#13;&#10;      QNCH.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      QNCH.ParamByName('tn').DataType:=ftVariant;&#13;&#10;      QNCH.ParamByName('DT').DataType:=ftDate;&#13;&#10;      //QNCH.ParamByName('DTBEG').DataType:=ftDate;&#13;&#10;      QNCH.ParamByName('mt').Value:=ValMt;&#13;&#10;      QNCH.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;      //QNCH.ParamByName('DTBEG').Value:=EncodeDate(YearOf(DateEdit1.Date),MonthOf(DateEdit1.Date),01);&#13;&#10;      str_udr:='select sum({fn convert(payrldo1.rl_sm,SQL_DECIMAL)})/({fn Power(10,:mt)}) as udr'+Chr(13)+&#13;&#10;      ' from payrldo1'+Chr(13)+&#13;&#10;      ' inner join payvo1 on rl_cdvo=vo_cd'+Chr(13)+&#13;&#10;      ' where { fn MOD( { fn TRUNCATE( payrldo1.Rl_Prz / 65536,  0 ) }, 2 ) }=0'+Chr(13)+&#13;&#10;      // USV Не надо фильтровать такие записи&#13;&#10;      // 10/03/2009 {&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //' and { fn MOD( { fn TRUNCATE( payrldo1.Rl_Prz2 / 2,  0 ) }, 2 ) }=0'+Chr(13)+&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      ' and vo_nur=0'+Chr(13)+&#13;&#10;      ' and vo_Met not in (74,34,48,49,50,95,79,80,81,116,29,83,78)'+Chr(13)+&#13;&#10;      ' and vo_grp&#62;127'+Chr(13)+&#13;&#10;      ' and payrld_dat=:DT and payrld_tn = :tn'+Chr(13);&#13;&#10;      //' and payrld_dat BETWEEN :DTBEG AND :DT and payrld_tn = :tn'+Chr(13);&#13;&#10;      QUDR.SQL.Text:=str_udr;&#13;&#10;      QUDR.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      QUDR.ParamByName('tn').DataType:=ftVariant;&#13;&#10;      QUDR.ParamByName('DT').DataType:=ftDate;&#13;&#10;      //QUDR.ParamByName('DTBEG').DataType:=ftDate;&#13;&#10;      QUDR.ParamByName('mt').Value:=ValMt;&#13;&#10;      QUDR.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;      //QNCH.ParamByName('DTBEG').Value:=EncodeDate(YearOf(DateEdit1.Date),MonthOf(DateEdit1.Date),01);&#13;&#10;    end&#13;&#10;  // За интервал учетных периодов&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Page1.Visible:=True;&#13;&#10;      Page3.Visible:=False;&#13;&#10;      str_sm:='SELECT KpuX.Kpu_Tn,Vo_Cd,('+Chr(13);&#13;&#10;      str_sm:=str_sm+' SELECT'+Chr(13);&#13;&#10;      str_sm:=str_sm+' CASE WHEN SUM({fn CONVERT(KPURL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt)} IS NULL THEN 0 ELSE SUM({fn CONVERT(KPURL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt1)} END'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuRlo1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' WHERE KpuRl_DatUp BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND KpuRlo1.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND KpuRlo1.KpuRl_CdVo = PayVo1.Vo_cd'+Chr(13);&#13;&#10;      str_sm:=str_sm+' and { fn MOD( { fn TRUNCATE( KpuRlo1.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      // USV - не нужно фильтровать эти записи&#13;&#10;      // 10/03/2009&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //str_sm:=str_sm+' and { fn MOD( { fn TRUNCATE( KpuRlo1.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      str_sm:=str_sm+' ) AS KpuRl_Sm '+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM PayVo1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' INNER JOIN KpuX ON 1=1'+Chr(13);&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;          str_sm := str_sm+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;      str_sm:=str_sm+' INNER JOIN '+Chr(13);&#13;&#10;      str_sm:=str_sm+' ( '+Chr(13);&#13;&#10;      str_sm:=str_sm+' SELECT DISTINCT FF.Kpu_Tn'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM'+Chr(13);&#13;&#10;      str_sm:=str_sm+' ('+Chr(13);&#13;&#10;      str_sm:=str_sm+' SELECT Rl.Kpu_Tn'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuRlo1 Rl'+Chr(13);&#13;&#10;      str_sm:=str_sm+' WHERE Rl.KpuRl_DatUp BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;      // СОИД 172828 04.06.2007&#13;&#10;      // WOLF { =================================&#13;&#10;      // Включать работников только с ненулевыми суммами&#13;&#10;      If CheckBox6.Checked=True then&#13;&#10;        begin&#13;&#10;          // Выборочно по видам оплат&#13;&#10;          If RadioButton4.Checked then&#13;&#10;            begin&#13;&#10;              str_sm:=str_sm+(' AND KpuRl_CdVo IN ('+str_vo+')')+Chr(13);&#13;&#10;            end;&#13;&#10;          // VDG 27/05/2009 СОИД 314334 {&#13;&#10;          str_sm := str_sm + ' AND Rl.KpuRl_Sm &#60;&#62; 0'+Chr(13);&#13;&#10;          // VDG 27/05/2009 СОИД 314334 }&#13;&#10;        end;&#13;&#10;      // =======================================}&#13;&#10;      // Не включать записи внутренних совместителей&#13;&#10;      // 14.06.2007 WOLF&#13;&#10;      str_sm:=str_sm+' and { fn MOD( { fn TRUNCATE( Rl.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      // USV - не нужно фильтровать эти записи&#13;&#10;      // 10/03/2009&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //str_sm:=str_sm+' and { fn MOD( { fn TRUNCATE( Rl.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      // СОИД 181838 18/10/2007 Включать работников,у которых нет записей в РЛ&#13;&#10;      // и есть ненулевое сальдо ================================================{&#13;&#10;      If CheckBox8.Checked then&#13;&#10;        begin&#13;&#10;          str_sm:=str_sm+' UNION ALL'+Chr(13);&#13;&#10;          str_sm:=str_sm+' SELECT Nus.Kpu_Tn'+Chr(13);&#13;&#10;          str_sm:=str_sm+' FROM KpuRloNus Nus'+Chr(13);&#13;&#10;          str_sm:=str_sm+' WHERE Nus.KpuRl_DatUp BETWEEN :DTUP9 AND :DTUP10'+Chr(13);&#13;&#10;          str_sm:=str_sm+' AND ( Nus.KpuRl_Sin &#60;&#62; 0 OR Nus.KpuRl_Sout &#60;&#62; 0 )'+Chr(13);&#13;&#10;        end;&#13;&#10;      // =========================================================================}&#13;&#10;      str_sm:=str_sm+' ) FF'+Chr(13);&#13;&#10;      str_sm:=str_sm+' ) AA ON KpuX.Kpu_Tn = AA.Kpu_Tn'+Chr(13);&#13;&#10;      str_sm:=str_sm+' INNER JOIN'+Chr(13);&#13;&#10;      str_sm:=str_sm+' ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;      // СОИД 121880 WOLF 19.04.2007&#13;&#10;//      str_sm:=str_sm+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;      str_sm:=str_sm+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;      If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;          str_sm := str_sm+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;        end;&#13;&#10;      // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;      str_sm:=str_sm+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;      str_sm:=str_sm+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;      str_sm:=str_sm+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;      str_sm:=str_sm+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))'+Chr(13);&#13;&#10;      str_sm:=str_sm+' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT2 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If (CheckBox9.Checked) AND (SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_sm:=str_sm+' INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;          str_sm:=str_sm+' AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_sm:=str_sm+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT5 AND :DT6'+Chr(13);&#13;&#10;       If dsMark.EOF = False then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;        end;&#13;&#10;&#13;&#10;      // По структурным единицам&#13;&#10;      If (CheckBox9.Checked) AND (SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_sm:=str_sm+' AND PayAcc_SE IN ('+SteCd+') '+Chr(13);&#13;&#10;        end;&#13;&#10;      // СОИД 172828 04.06.2007&#13;&#10;      // WOLF { =================================&#13;&#10;      // Включать работников только с ненулевыми суммами&#13;&#10;      If CheckBox6.Checked=True then&#13;&#10;        begin&#13;&#10;          // Выборочно по видам оплат&#13;&#10;          If RadioButton4.Checked then&#13;&#10;            begin&#13;&#10;              str_sm:=str_sm+(' AND RlVo.KpuRl_CdVo IN ('+str_vo+')')+Chr(13);&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // =======================================}&#13;&#10;      // Не включать записи внутренних совместителей&#13;&#10;      // 14.06.2007 WOLF&#13;&#10;      str_sm:=str_sm+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      // USV - не нужно фильтровать эти записи&#13;&#10;      // 10/03/2009&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //str_sm:=str_sm+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      // Выборочно по подразделениям&#13;&#10;      If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          // Включать подчиненные подразделения&#13;&#10;          If CheckBox7.Checked then&#13;&#10;            begin&#13;&#10;              str_sm:=str_sm+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;            end&#13;&#10;          // Не включать подчиненные подразделения&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              str_sm:=str_sm+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // VDG 30/09/2008 СОИД 353496 {&#13;&#10;      //str_sm:=str_sm+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;      str_sm:=str_sm+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;      // VDG 30/09/2008 СОИД 353496 }&#13;&#10;      str_sm:=str_sm+' HAVING SUM({fn CONVERT(KPURL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt10)}&#60;&#62;0'+Chr(13);&#13;&#10;      str_sm:=str_sm+' ) RVo'+Chr(13);&#13;&#10;      str_sm:=str_sm+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;      str_sm:=str_sm+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248){&#13;&#10;      If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;       //студенты&#13;&#10;         str_sm:=str_sm+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;      else&#13;&#10;       //работники&#13;&#10;         str_sm:=str_sm+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;      // 06/07/11 ZVN (508248)}&#13;&#10;      str_sm:=str_sm+' INNER JOIN KpuPrk1 ON KpuPRk1.bookmark = '+Chr(13);&#13;&#10;      str_sm:=str_sm+' ( SELECT MAX(P1.bookmark)'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuPrk1 P1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' WHERE P1.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND P1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND P1.KpuPrkz_Dtv = '+Chr(13);&#13;&#10;      str_sm:=str_sm+' ( SELECT MAX(P2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;      str_sm:=str_sm+' FROM KpuPrk1 P2'+Chr(13);&#13;&#10;      str_sm:=str_sm+' WHERE P2.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND P2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND P2.KpuPrkz_Dtv &#60;= :LDT ) )'+Chr(13);&#13;&#10;      str_sm:=str_sm+' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :DDD between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) OR ( SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;          str_sm := str_sm+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;        end;&#13;&#10;      str_sm:=str_sm+' WHERE Vo_Cd &#60;&#62; 0'+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 2, 0 ) }, 2 ) } = 0 '+Chr(13);&#13;&#10;      str_sm:=str_sm+' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 1, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;      // По структурным единицам&#13;&#10;      If ( CheckBox9.Checked ) OR ( SteCd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+ 'AND PayAcc_SE IN ('+SteCD+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      If dsMark.EOF = False then&#13;&#10;        begin&#13;&#10;          str_sm := str_sm+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;        end;&#13;&#10;      QSM.SQL.TEXT := str_sm;&#13;&#10;      QSM.ParamByName('mt').DataType :=ftInteger;&#13;&#10;      QSM.ParamByName('mt1').DataType :=ftInteger;&#13;&#10;      QSM.ParamByName('mt10').DataType :=ftInteger;&#13;&#10;      QSM.ParamByName('DT1').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('DT2').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('DT3').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('DT4').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('DT5').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('DT6').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('LDT').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('LDT1').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('DDD').DataType :=ftDate;&#13;&#10;      QSM.ParamByName('PDRDT2').DataType :=ftDate;&#13;&#10;      If CheckBox8.Checked then&#13;&#10;        begin&#13;&#10;          QSM.ParamByName('DTUP9').DataType :=ftDate;&#13;&#10;          QSM.ParamByName('DTUP10').DataType :=ftDate;&#13;&#10;        end;&#13;&#10;      QSM.ParamByName('mt').Value :=ValMt;&#13;&#10;      QSM.ParamByName('mt1').Value :=ValMt;&#13;&#10;      QSM.ParamByName('mt10').Value :=ValMt;&#13;&#10;      QSM.ParamByName('DT1').Value := DTUP;&#13;&#10;      QSM.ParamByName('DT2').Value := DTUP1;&#13;&#10;      QSM.ParamByName('DT3').Value := DTUP;&#13;&#10;      QSM.ParamByName('DT4').Value := DTUP1;&#13;&#10;      QSM.ParamByName('DT5').Value := DTUP;&#13;&#10;      QSM.ParamByName('DT6').Value := DTUP1;&#13;&#10;      QSM.ParamByName('LDT').Value :=LDTUP;&#13;&#10;      QSM.ParamByName('LDT1').Value :=LDTUP;&#13;&#10;      QSM.ParamByName('DDD').Value :=LDTUP;&#13;&#10;      QSM.ParamByName('PDRDT2').Value :=LDTUP;&#13;&#10;      If CheckBox8.Checked then&#13;&#10;        begin&#13;&#10;          QSM.ParamByName('DTUP9').Value :=DTUP;&#13;&#10;          QSM.ParamByName('DTUP10').Value :=DTUP1;&#13;&#10;        end;&#13;&#10;      // Выборочно по ВО&#13;&#10;      If ( CheckBox6.Checked = False ) AND (RadioButton4.Checked) THEN&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add('AND Vo_Cd IN ('+str_vo+')');&#13;&#10;        end;&#13;&#10;      // Доступ к подразделениям&#13;&#10;      If flg_Pacc=1 then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add(' and kpuprk1.kpuprkz_pd in ('+strPacc+')');&#13;&#10;          QSM.ParamByName('Usr').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr1').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('FrmCd').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('Usr1').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('FrmCd').Value:=CdFrm;&#13;&#10;        end;&#13;&#10;      // Доступ к табельным номерам&#13;&#10;      If flg_Tacc=1 then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add(' and kpux.kpu_tn in ('+strTacc+')');&#13;&#10;          QSM.ParamByName('Usr2').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr3').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('FrmCd1').DataType:=ftInteger;&#13;&#10;          QSM.ParamByName('Usr2').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('Usr3').Value:=BPRO.USER_RCD.Value;&#13;&#10;          QSM.ParamByName('FrmCd1').Value:=CdFrm;&#13;&#10;        end;&#13;&#10;      // Включать записи в которые не входит начисленно/удержано&#13;&#10;      If CheckBox2.Checked = False then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add('and vo_nur = 0');&#13;&#10;          QSM.SQL.Add(' AND Vo_Met not in (74,34,48,49,50,95,79,80,81,116,29,83,78)');&#13;&#10;        end;&#13;&#10;      // Выборочно по подразделениям&#13;&#10;      If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;        begin&#13;&#10;          // Включать подчиненные подразделения&#13;&#10;          If CheckBox7.Checked then&#13;&#10;            begin&#13;&#10;              QSM.SQL.Add('and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})');&#13;&#10;            end&#13;&#10;          // Не включать подчиненные подразделения&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              QSM.SQL.Add('and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))');&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // Группы видов оплат&#13;&#10;      If str_groupvo &#60;&#62; '' then&#13;&#10;        begin&#13;&#10;          QSM.SQL.Add('and payvo1.vo_cd not in ('+str_groupvo+')');&#13;&#10;        end;&#13;&#10;      // Виды оплат выводятся в разрезе периодов, за который расчитаны&#13;&#10;      If CheckBox1.Checked = True then&#13;&#10;        begin&#13;&#10;          str_smrp:='SELECT KpuX.Kpu_Tn, Vo_Cd,('+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' SELECT'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' CASE WHEN SUM({fn CONVERT(KPURL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt)} IS NULL THEN 0 ELSE SUM({fn CONVERT(KPURL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt1)} END'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuRlo1'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE KpuRl_DatUp BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND KpuRlo1.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND KpuRlo1.KpuRl_CdVo = PayVo1.Vo_cd'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND KpuRlo1.KpuRl_DatRp = CC.KpuRl_DatRp'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND KpuRlo1.Kpu_Tn = CC.Kpu_Tn'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( KpuRlo1.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          // USV - не нужно фильтровать эти записи&#13;&#10;          // 10/03/2009&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;          //str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( KpuRlo1.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;          str_smrp:=str_smrp+' ) AS KpuRl_Sm, CC.KpuRl_DatRp'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM PayVo1'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN KpuX ON 1=1'+Chr(13);&#13;&#10;          // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;          If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;            begin&#13;&#10;              str_smrp:=str_smrp+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;              str_smrp:=str_smrp+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;            end;&#13;&#10;          // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( '+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' SELECT DISTINCT FF.Kpu_Tn'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ('+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' SELECT Rl.Kpu_Tn'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuRlo1 Rl'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE Rl.KpuRl_DatUp BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;          // СОИД 172828 04.06.2007&#13;&#10;          // WOLF { =================================&#13;&#10;          // Включать работников только с ненулевыми суммами&#13;&#10;          If CheckBox6.Checked=True then&#13;&#10;            begin&#13;&#10;              // Выборочно по видам оплат&#13;&#10;              If RadioButton4.Checked then&#13;&#10;                begin&#13;&#10;                  str_smrp:=str_smrp+(' AND KpuRl_CdVo IN ('+str_vo+')')+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 27/05/2009 СОИД 314334 {&#13;&#10;              str_smrp := str_smrp + ' AND Rl.KpuRl_Sm &#60;&#62; 0'+Chr(13);&#13;&#10;              // VDG 27/05/2009 СОИД 314334 }&#13;&#10;            end;&#13;&#10;          // =======================================}&#13;&#10;          // Не включать записи внутренних совместителей&#13;&#10;          // 14.06.2007 WOLF&#13;&#10;          str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( Rl.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          // USV - не нужно фильтровать эти записи&#13;&#10;          // 10/03/2009&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;          //str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( Rl.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;          // СОИД 181838 18/10/2007 Включать работников,у которых нет записей в РЛ&#13;&#10;          // и есть ненулевое сальдо ================================================{&#13;&#10;          If CheckBox8.Checked then&#13;&#10;            begin&#13;&#10;              str_smrp:=str_smrp+' UNION ALL'+Chr(13);&#13;&#10;              str_smrp:=str_smrp+' SELECT Nus.Kpu_Tn'+Chr(13);&#13;&#10;              str_smrp:=str_smrp+' FROM KpuRloNus Nus'+Chr(13);&#13;&#10;              str_smrp:=str_smrp+' WHERE Nus.KpuRl_DatUp BETWEEN :DTUP9 AND :DTUP10'+Chr(13);&#13;&#10;              str_smrp:=str_smrp+' AND ( Nus.KpuRl_Sin &#60;&#62; 0 OR Nus.KpuRl_Sout &#60;&#62; 0 )'+Chr(13);&#13;&#10;            end;&#13;&#10;          // =========================================================================}&#13;&#10;          str_smrp:=str_smrp+' ) FF'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ) AA ON KpuX.Kpu_Tn = AA.Kpu_Tn'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;          // СОИД 121880 WOLF 19.04.2007&#13;&#10;//          str_smrp:=str_smrp+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;          // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;          If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;            begin&#13;&#10;              str_smrp := str_smrp+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;              str_smrp := str_smrp+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;            end;&#13;&#10;          // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))'+Chr(13);&#13;&#10;          // Выборочно по подразделениям&#13;&#10;          If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;            begin&#13;&#10;              // Включать подчиненные подразделения&#13;&#10;              If CheckBox7.Checked then&#13;&#10;                begin&#13;&#10;                  str_smrp:=str_smrp+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                end&#13;&#10;              // Не включать подчиненные подразделения&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  str_smrp:=str_smrp+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;          str_smrp:=str_smrp+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT5 AND :DT6'+Chr(13);&#13;&#10;          If dsMark.EOF = False then&#13;&#10;            begin&#13;&#10;              str_smrp := str_smrp+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;            end;&#13;&#10;          // СОИД 172828 04.06.2007&#13;&#10;          // WOLF { =================================&#13;&#10;          // Включать работников только с ненулевыми суммами&#13;&#10;          If CheckBox6.Checked=True then&#13;&#10;            begin&#13;&#10;              // Выборочно по видам оплат&#13;&#10;              If RadioButton4.Checked then&#13;&#10;                begin&#13;&#10;                  str_sm:=str_sm+(' AND RlVo.KpuRl_CdVo IN ('+str_vo+')')+Chr(13);&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;          // =======================================}&#13;&#10;          // Не включать записи внутренних совместителей&#13;&#10;          // WOLF 14.06.2007&#13;&#10;          str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          // USV - не нужно фильтровать эти записи&#13;&#10;          // 10/03/2009&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;          //str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;          // VDG 30/09/2008 СОИД 353496 {&#13;&#10;          //str_smrp:=str_smrp+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;          // VDG 30/09/2008 СОИД 353496 }&#13;&#10;          str_smrp:=str_smrp+' HAVING SUM({fn CONVERT(KPURL_SM,SQL_DECIMAL)})/{fn POWER(10,:mt10)}&#60;&#62;0'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ) RVo'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( SELECT DISTINCT RlRp.Kpu_Tn,RlRp.KpuRl_DatRp'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuRlo1 RlRp'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE RlRp.KpuRl_DatUp BETWEEN :DT7 AND :DT8'+Chr(13);&#13;&#10;          // СОИД 172828 04.06.2007&#13;&#10;          // WOLF { =================================&#13;&#10;          // Включать работников только с ненулевыми суммами&#13;&#10;          If CheckBox6.Checked=True then&#13;&#10;            begin&#13;&#10;              // Выборочно по видам оплат&#13;&#10;              If RadioButton4.Checked then&#13;&#10;                begin&#13;&#10;                  str_smrp:=str_smrp+(' AND RlRp.KpuRl_CdVo IN ('+str_vo+')')+Chr(13);&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;          // 12/09/11 ZVN (516120){&#13;&#10;          If CheckBox1.Checked=True and RadioButton4.Checked then&#13;&#10;            begin&#13;&#10;              str_smrp:=str_smrp + ' AND ('+Chr(13);&#13;&#10;              if (str_vo &#60;&#62; '') then&#13;&#10;                str_smrp:=str_smrp + ' RlRp.KpuRl_CdVo IN ('+str_vo+')'+Chr(13);&#13;&#10;              if (str_vo &#60;&#62; '')and (str_groupvo &#60;&#62; '') then&#13;&#10;                str_smrp:=str_smrp + ' or ';&#13;&#10;              if (str_groupvo &#60;&#62; '') then&#13;&#10;                str_smrp:=str_smrp + ' RlRp.KpuRl_CdVo IN ('+str_groupvo+')'+Chr(13);&#13;&#10;              str_smrp:=str_smrp + '   )'+Chr(13);&#13;&#10;            end;&#13;&#10;&#13;&#10;          // =======================================}&#13;&#10;          // Не включать записи внутренних совместителей&#13;&#10;          // WOLF 14.06.2007&#13;&#10;          str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( RlRp.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          // USV - не нужно фильтровать эти записи&#13;&#10;          // 10/03/2009&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;          //str_smrp:=str_smrp+' and { fn MOD( { fn TRUNCATE( RlRp.kpurl_prz2 / 2,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;          //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;          str_smrp:=str_smrp+' ) CC ON KpuX.Kpu_Tn = CC.Kpu_Tn'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;          // 06/07/11 ZVN (508248){&#13;&#10;          If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;            //студенты&#13;&#10;            str_smrp:=str_smrp+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;          else&#13;&#10;            //работники&#13;&#10;            str_smrp:=str_smrp+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;          // 06/07/11 ZVN (508248)}&#13;&#10;          str_smrp:=str_smrp+' INNER JOIN KpuPrk1 ON KpuPRk1.bookmark ='+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( SELECT MAX(P1.bookmark)'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuPrk1 P1'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE P1.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND P1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND P1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' ( SELECT MAX(P2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' FROM KpuPrk1 P2'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' WHERE P2.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND P2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND P2.KpuPrkz_Dtv &#60;= :LDT ) )'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :DDD between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;          // По структурным единицам&#13;&#10;          If ( CheckBox9.Checked ) OR ( SteCd &#60;&#62; '' ) then&#13;&#10;            begin&#13;&#10;              str_smrp:=str_smrp+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;              str_smrp:=str_smrp+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;            end;&#13;&#10;          str_smrp:=str_smrp+' WHERE Vo_Cd &#60;&#62; 0'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 2, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;          str_smrp:=str_smrp+' AND { fn MOD( { fn TRUNCATE( Kpu_Flg / 1, 0 ) }, 2 ) } = 0'+Chr(13);&#13;&#10;          // По структурным единицам&#13;&#10;          If ( CheckBox9.Checked ) OR ( SteCd &#60;&#62; '' ) then&#13;&#10;            begin&#13;&#10;              str_smrp:=str_smrp+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;            end;&#13;&#10;          If dsMark.EOF = False then&#13;&#10;            begin&#13;&#10;              str_smrp:=str_smrp+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;            end;&#13;&#10;          QSMRP.SQL.TEXT := str_smrp;&#13;&#10;          QSMRP.ParamByName('mt').DataType :=ftInteger;&#13;&#10;          QSMRP.ParamByName('mt1').DataType :=ftInteger;&#13;&#10;          QSMRP.ParamByName('mt10').DataType :=ftInteger;&#13;&#10;          QSMRP.ParamByName('DT1').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT2').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT3').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT4').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT5').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT6').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT7').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DT8').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('LDT').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('LDT1').DataType :=ftDate;&#13;&#10;          QSMRP.ParamByName('DDD').DataType :=ftDate;&#13;&#10;          If CheckBox8.Checked then&#13;&#10;            begin&#13;&#10;              QSMRP.ParamByName('DTUP9').DataType :=ftDate;&#13;&#10;              QSMRP.ParamByName('DTUP10').DataType :=ftDate;&#13;&#10;            end;&#13;&#10;          QSMRP.ParamByName('mt').Value :=ValMt;&#13;&#10;          QSMRP.ParamByName('mt1').Value :=ValMt;&#13;&#10;          QSMRP.ParamByName('mt10').Value :=ValMt;&#13;&#10;          QSMRP.ParamByName('DT1').Value := DTUP;&#13;&#10;          QSMRP.ParamByName('DT2').Value := DTUP1;&#13;&#10;          QSMRP.ParamByName('DT3').Value := DTUP;&#13;&#10;          QSMRP.ParamByName('DT4').Value := DTUP1;&#13;&#10;          QSMRP.ParamByName('DT5').Value := DTUP;&#13;&#10;          QSMRP.ParamByName('DT6').Value := DTUP1;&#13;&#10;          QSMRP.ParamByName('DT7').Value := DTUP;&#13;&#10;          QSMRP.ParamByName('DT8').Value := DTUP1;&#13;&#10;          QSMRP.ParamByName('LDT').Value :=LDTUP;&#13;&#10;          QSMRP.ParamByName('LDT1').Value :=LDTUP;&#13;&#10;          QSMRP.ParamByName('DDD').Value :=LDTUP;&#13;&#10;          If CheckBox8.Checked then&#13;&#10;            begin&#13;&#10;              QSMRP.ParamByName('DTUP9').Value := DTUP;&#13;&#10;              QSMRP.ParamByName('DTUP10').Value := DTUP1;&#13;&#10;            end;&#13;&#10;          // Выборочно по ВО&#13;&#10;          If ( CheckBox6.Checked = False ) AND (RadioButton4.Checked) THEN&#13;&#10;            begin&#13;&#10;              QSMRP.SQL.Add('AND Vo_Cd IN ('+str_vo+')');&#13;&#10;            end;&#13;&#10;          // Доступ к подразделениям&#13;&#10;          If flg_Pacc=1 then&#13;&#10;            begin&#13;&#10;              QSMRP.SQL.Add(' and kpuprk1.kpuprkz_pd in ('+strPacc+')');&#13;&#10;              QSMRP.ParamByName('Usr').DataType:=ftInteger;&#13;&#10;              QSMRP.ParamByName('Usr1').DataType:=ftInteger;&#13;&#10;              QSMRP.ParamByName('FrmCd').DataType:=ftInteger;&#13;&#10;              QSMRP.ParamByName('Usr').Value:=BPRO.USER_RCD.Value;&#13;&#10;              QSMRP.ParamByName('Usr1').Value:=BPRO.USER_RCD.Value;&#13;&#10;              QSMRP.ParamByName('FrmCd').Value:=CdFrm;&#13;&#10;            end;&#13;&#10;          // Доступ к табельным номерам&#13;&#10;          If flg_Tacc=1 then&#13;&#10;            begin&#13;&#10;              QSMRP.SQL.Add(' and kpux.kpu_tn in ('+strTacc+')');&#13;&#10;              QSMRP.ParamByName('Usr2').DataType:=ftInteger;&#13;&#10;              QSMRP.ParamByName('Usr3').DataType:=ftInteger;&#13;&#10;              QSMRP.ParamByName('FrmCd1').DataType:=ftInteger;&#13;&#10;              QSMRP.ParamByName('Usr2').Value:=BPRO.USER_RCD.Value;&#13;&#10;              QSMRP.ParamByName('Usr3').Value:=BPRO.USER_RCD.Value;&#13;&#10;              QSMRP.ParamByName('FrmCd1').Value:=CdFrm;&#13;&#10;            end;&#13;&#10;          // Включать записи в которые не входит начисленно/удержано&#13;&#10;          If CheckBox2.Checked = False then&#13;&#10;            begin&#13;&#10;              QSMRP.SQL.Add('and vo_nur = 0');&#13;&#10;              QSMRP.SQL.Add(' AND Vo_Met not in (74,34,48,49,50,95,79,80,81,116,29,83,78)');&#13;&#10;            end;&#13;&#10;          // Выборочно по подразделениям&#13;&#10;          If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;            begin&#13;&#10;              // Включать подчиненные подразделения&#13;&#10;              If CheckBox7.Checked then&#13;&#10;                begin&#13;&#10;                  QSMRP.SQL.Add('and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})');&#13;&#10;                end&#13;&#10;              // Не включать подчиненные подразделения&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  QSMRP.SQL.Add('and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))');&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;          // Группы видов оплат&#13;&#10;          If str_groupvo &#60;&#62; '' then&#13;&#10;            begin&#13;&#10;              QSMRP.SQL.Add('and payvo1.vo_cd not in ('+str_groupvo+')');&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      strsmgrp:='select sum({fn convert(kpurlo1.kpurl_Sm,SQL_DECIMAL)})/({fn Power(10,:mt)}) as kpurl_Sm'+Chr(13)+&#13;&#10;      ' from kpurlo1'+Chr(13)+&#13;&#10;      ' inner join payvo1 on kpurlo1.kpurl_cdvo=payvo1.vo_cd'+Chr(13)+&#13;&#10;      ' where kpurlo1.kpu_tn=:tn'+Chr(13)+&#13;&#10;      ' and kpurlo1.kpurl_datup between :DT and :DT1'+Chr(13)+&#13;&#10;      ' and { fn MOD( { fn TRUNCATE( kpurlo1.kpurl_prz / 65536,  0 ) }, 2 ) }=0'+Chr(13);&#13;&#10;      // USV - не нужно фильтровать эти записи&#13;&#10;      // 10/03/2009&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 {&#13;&#10;      //' and { fn MOD( { fn TRUNCATE( kpurlo1.kpurl_prz2 / 2,  0 ) }, 2 ) }=0'+Chr(13);&#13;&#10;      //// VDG 05/03/2009 СОИД 301650 }&#13;&#10;      SMGRP.SQL.Text:=strsmgrp;&#13;&#10;      SMGRP.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('tn').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SMGRP.ParamByName('DT1').DataType:=ftDate;&#13;&#10;      SMGRP.ParamByName('mt').Value:=ValMt;&#13;&#10;      SMGRP.ParamByName('DT').Value:=DTUP;&#13;&#10;      SMGRP.ParamByName('DT1').Value:=DTUP1;&#13;&#10;    end;&#13;&#10;  // По предприятию&#13;&#10;  If (RadioButton1.Checked=True) AND (CheckBox9.Checked = False) then&#13;&#10;    begin&#13;&#10;      GroupHeader1.Condition:='1';&#13;&#10;      GroupHeader2.Condition:='1';&#13;&#10;      If RadioButton5.Checked=True then&#13;&#10;        begin&#13;&#10;        // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;        // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;          If CheckBox3.Checked then&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;              QSM.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn , Vo_CdChrs');&#13;&#10;              QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;            end&#13;&#10;        // }&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;              QSM.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn , Vo_CdChrs');&#13;&#10;              QSMRP.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;        // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;        // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;          If CheckBox3.Checked then&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add('ORDER BY KpuX.Kpu_Npp,kpux.kpu_tn');&#13;&#10;              QSM.SQL.Add('ORDER BY KpuX.Kpu_Npp,KpuX.Kpu_Tn , Vo_CdChrs');&#13;&#10;              QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Npp,KpuX.Kpu_Tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;            end&#13;&#10;        // }&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Query1.SQL.Add('ORDER BY kpux.kpu_tn');&#13;&#10;              QSM.SQL.Add('ORDER BY KpuX.Kpu_Tn , Vo_CdChrs');&#13;&#10;              QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;    end&#13;&#10;  // Выборочно по подразделениям&#13;&#10;  Else If RadioButton2.Checked=True then&#13;&#10;    begin&#13;&#10;      // Включать подчиненные подразделения&#13;&#10;      If CheckBox7.Checked then&#13;&#10;        begin&#13;&#10;          Query1.SQL.Add('and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})');&#13;&#10;        end&#13;&#10;      // Не включать подчиненные подразделения&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          Query1.SQL.Add('and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))');&#13;&#10;        end;&#13;&#10;    // Печатать один отчет на все подразделения&#13;&#10;      If CheckBox4.Checked=True then&#13;&#10;        begin&#13;&#10;          GroupHeader1.Condition:='1';&#13;&#10;          GroupHeader2.Condition:='1';&#13;&#10;          If RadioButton5.Checked=True then&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)} ,kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)} ,kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY KpuX.Kpu_Npp,kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY KpuX.Kpu_Npp,KpuX.Kpu_Tn , Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Npp,KpuX.Kpu_Tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY KpuX.Kpu_Tn , Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          GroupHeader1.Condition:='TN.&#34;SPRPDR_PD&#34;';&#13;&#10;          GroupHeader2.Condition:='TN.&#34;SPRPDR_PD&#34;';&#13;&#10;          If RadioButton5.Checked=True then&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by podr.sprpdr_pos, KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY Podr.SprPdr_Pos, KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY Podr.SprPdr_Pos, KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by podr.sprpdr_pos, {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY Podr.SprPdr_Pos, {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY Podr.SprPdr_Pos, {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by podr.sprpdr_pos, KpuX.Kpu_Npp,kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY Podr.SprPdr_Pos, KpuX.Kpu_Npp,KpuX.Kpu_Tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY Podr.SprPdr_Pos, KpuX.Kpu_Npp,KpuX.Kpu_Tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('order by podr.sprpdr_pos, kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY Podr.SprPdr_Pos, KpuX.Kpu_Tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY Podr.SprPdr_Pos, KpuX.Kpu_Tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  // Выборочно по структурным единицам&#13;&#10;  If CheckBox9.Checked then&#13;&#10;    begin&#13;&#10;    // Печатать один отчет на все СЕ&#13;&#10;      If CheckBox4.Checked=True then&#13;&#10;        begin&#13;&#10;          GroupHeader1.Condition:='1';&#13;&#10;          GroupHeader2.Condition:='1';&#13;&#10;          If RadioButton5.Checked=True then&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)} ,kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)} ,kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY KpuX.Kpu_Npp,kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY KpuX.Kpu_Npp,KpuX.Kpu_Tn , Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Npp,KpuX.Kpu_Tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY KpuX.Kpu_Tn , Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY KpuX.Kpu_Tn , CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          GroupHeader1.Condition:='TN.&#34;SPRPDR_PD&#34;';&#13;&#10;          GroupHeader2.Condition:='TN.&#34;SPRPDR_PD&#34;';&#13;&#10;          If RadioButton5.Checked=True then&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Npp,{fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY PayAcc_SE, {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY PayAcc_SE, {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY PayAcc_SE, {fn left(kpuc1.kpu_fio,25)},kpux.kpu_tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;            // Сортировка по порядковому номеру в платежной ведомости&#13;&#10;            // {  WOLF 30.05.2007 СОИД 172820&#13;&#10;              If CheckBox3.Checked then&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Npp,kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Npp,KpuX.Kpu_Tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Npp,KpuX.Kpu_Tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end&#13;&#10;            // }&#13;&#10;              Else&#13;&#10;                begin&#13;&#10;                  Query1.SQL.Add('ORDER BY PayAcc_SE, kpux.kpu_tn');&#13;&#10;                  QSM.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Tn, Vo_CdChrs');&#13;&#10;                  QSMRP.SQL.Add('ORDER BY PayAcc_SE, KpuX.Kpu_Tn, CC.KpuRl_DatRp, Vo_CdChrs');&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10; // =======================Анализ групп видов оплат ============&#13;&#10;   TBL.First;&#13;&#10;   str_groupvo:='';&#13;&#10;   while not TBL.Eof do&#13;&#10;     begin&#13;&#10;     // Группа определена (включены виды оплат для группировки)&#13;&#10;       If &#60;TBL.&#34;PRZ&#34;&#62;=1 then&#13;&#10;         begin&#13;&#10;           If massiv[&#60;TBL.&#34;ID&#34;&#62;+1]&#60;&#62;'' then&#13;&#10;             begin&#13;&#10;               str_groupvo:=str_groupvo+massiv[&#60;TBL.&#34;ID&#34;&#62;+1]+',';&#13;&#10;             end;&#13;&#10;         end;&#13;&#10;       TBL.Next;&#13;&#10;     end;&#13;&#10;   str_groupvo:=Copy(str_groupvo,1,Length(str_groupvo)-1);&#13;&#10;   If str_groupvo = '' then&#13;&#10;     begin&#13;&#10;       str_groupvo := '0';&#13;&#10;     end;&#13;&#10; //=============================================================&#13;&#10; //========================= Вывод колонок с видами оплат ======&#13;&#10;  // За интервал УП&#13;&#10;   If CheckBox5.Checked = False then&#13;&#10;     begin&#13;&#10;      // Включать все виды оплат&#13;&#10;      If RadioButton3.Checked=True then&#13;&#10;        begin&#13;&#10;        // Без групп&#13;&#10;          If str_groupvo='' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from ('+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 Podr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;             // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#60;=127'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs'+Chr(13);&#13;&#10;            end&#13;&#10;          // Группы&#13;&#10;          Else If str_groupvo&#60;&#62;'' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from ('+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#60;=127'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')'+Chr(13);&#13;&#10;             // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              TBL.First;&#13;&#10;              while not TBL.Eof do&#13;&#10;                begin&#13;&#10;                  If &#60;TBL.&#34;PRZ&#34;&#62;=1 then&#13;&#10;                    Begin&#13;&#10;                      str_sqlvo := str_sqlvo + ' UNION ALL ' + Chr(13);&#13;&#10;                      str_sqlvo := str_sqlvo + ' SELECT ' + IntToStr( &#60;TBL.&#34;ID&#34;&#62; ) + ' AS Spr_Cd, ''' + &#60;TBL.&#34;NM&#34;&#62; + ''' AS Spr_Nm, ''' + &#60;TBL.&#34;CD&#34;&#62; + ''' AS Vo_CdChr, ''' + &#60;TBL.&#34;CD&#34;&#62; + ''' AS Vo_CdChrs, 0 AS Grp, 2000 AS Vo_Met, 2 AS Vo_Nur' + Chr(13);&#13;&#10;                      // 16/01/09 12:46 CDN { (288738)&#13;&#10;                      If GetCargoVal( 'BPI_SQLSERVERTYPE' ) = 2 Then&#13;&#10;                        Begin&#13;&#10;                          str_sqlvo := str_sqlvo + ' FROM DUAL' + Chr(13);&#13;&#10;                        End;&#13;&#10;                      // 16/01/09 12:46 CDN } (288738)&#13;&#10;                    End;&#13;&#10;                  TBL.Next;&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs'+Chr(13);&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      // Выборочно&#13;&#10;      Else If RadioButton4.Checked=True then&#13;&#10;        begin&#13;&#10;        // Без групп&#13;&#10;          If str_groupvo='' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from ( select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202 and payvo1.vo_grp&#60;=127'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_Cd in ('+str_vo+')'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_cd in ('+str_vo+')'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs'+Chr(13);&#13;&#10;            end&#13;&#10;        // Группы&#13;&#10;          Else If str_groupvo&#60;&#62;'' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from ( select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202 and payvo1.vo_grp&#60;=127'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_Cd in ('+str_vo+')'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              TBL.First;&#13;&#10;              while not TBL.Eof do&#13;&#10;                begin&#13;&#10;                  If &#60;TBL.&#34;PRZ&#34;&#62;=1 then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' union all'+Chr(13);&#13;&#10;                      str_sqlvo:=str_sqlvo+' select '+IntToStr(&#60;TBL.&#34;ID&#34;&#62;)+' as spr_cd, '''+&#60;TBL.&#34;NM&#34;&#62;+''' as spr_nm, '''+&#60;TBL.&#34;CD&#34;&#62;+''' as vo_cdchr,'''+&#60;TBL.&#34;CD&#34;&#62;+''' as vo_cdchrs,0 as grp,2000 as vo_met,2 as vo_nur'+Chr(13);&#13;&#10;                      // 16/01/09 12:46 CDN { (288738)&#13;&#10;                      If GetCargoVal( 'BPI_SQLSERVERTYPE' ) = 2 Then&#13;&#10;                        Begin&#13;&#10;                          str_sqlvo := str_sqlvo + ' FROM DUAL' + Chr(13);&#13;&#10;                        End;&#13;&#10;                      // 16/01/09 12:46 CDN } (288738)&#13;&#10;                    end;&#13;&#10;                  TBL.Next;&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuRlo1 RlVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Kpu_Tn = KpuX.Kpu_Tn'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv ='+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.KpuRl_DatUp BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;              str_sqlvo:=str_sqlvo+' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+Chr(13);&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})'+Chr(13);&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))'+Chr(13);&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 30/09/2008 СОИД 353496 {&#13;&#10;              //str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.KpuRl_CdVo,RlVo.Kpu_Tn'+Chr(13);&#13;&#10;              // VDG 30/09/2008 СОИД 353496 }&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_cd in ('+str_vo+')'+Chr(13);&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')'+Chr(13);&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs'+Chr(13);&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;     end&#13;&#10;   // На дату&#13;&#10;   Else&#13;&#10;     begin&#13;&#10;       // Включать все виды оплат&#13;&#10;      If RadioButton3.Checked=True then&#13;&#10;        begin&#13;&#10;        // Без групп&#13;&#10;          If str_groupvo='' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from (';&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr';&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.kpu_tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;             // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#60;=127';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all';&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs';&#13;&#10;            end&#13;&#10;          // Группы&#13;&#10;          Else If str_groupvo&#60;&#62;'' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from (';&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr';&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#60;=127';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')';&#13;&#10;             // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              TBL.First;&#13;&#10;              while not TBL.Eof do&#13;&#10;                begin&#13;&#10;                  If &#60;TBL.&#34;PRZ&#34;&#62;=1 then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' union all';&#13;&#10;                      str_sqlvo:=str_sqlvo+' select '+IntToStr(&#60;TBL.&#34;ID&#34;&#62;)+' as spr_cd, '''+&#60;TBL.&#34;NM&#34;&#62;+''' as spr_nm, '''+&#60;TBL.&#34;CD&#34;&#62;+''' as vo_cdchr,'''+&#60;TBL.&#34;CD&#34;&#62;+''' as vo_cdchrs,0 as grp,2000 as vo_met,2 as vo_nur';&#13;&#10;                      // 16/01/09 12:46 CDN { (288738)&#13;&#10;                      If GetCargoVal( 'BPI_SQLSERVERTYPE' ) = 2 Then&#13;&#10;                        Begin&#13;&#10;                          str_sqlvo := str_sqlvo + ' FROM DUAL' + Chr(13);&#13;&#10;                        End;&#13;&#10;                      // 16/01/09 12:46 CDN } (288738)&#13;&#10;                    end;&#13;&#10;                  TBL.Next;&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all';&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs';&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      // Выборочно&#13;&#10;      Else If RadioButton4.Checked=True then&#13;&#10;        begin&#13;&#10;        // Без групп&#13;&#10;          If str_groupvo='' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from ( select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202 and payvo1.vo_grp&#60;=127';&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_Cd in ('+str_vo+')';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all';&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr';&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.Payrld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT3 AND :DT4'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127';&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_cd in ('+str_vo+')';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs';&#13;&#10;            end&#13;&#10;        // Группы&#13;&#10;          Else If str_groupvo&#60;&#62;'' then&#13;&#10;            begin&#13;&#10;              str_sqlvo:='select tt.spr_cd,tt.spr_nm,tt.vo_cdchr,tt.vo_cdchrs,tt.grp,tt.vo_met,tt.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from ( select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,0 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT1 AND :DT2'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202 and payvo1.vo_grp&#60;=127';&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_Cd in ('+str_vo+')';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              TBL.First;&#13;&#10;              while not TBL.Eof do&#13;&#10;                begin&#13;&#10;                  If &#60;TBL.&#34;PRZ&#34;&#62;=1 then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' union all';&#13;&#10;                      str_sqlvo:=str_sqlvo+' select '+IntToStr(&#60;TBL.&#34;ID&#34;&#62;)+' as spr_cd, '''+&#60;TBL.&#34;NM&#34;&#62;+''' as spr_nm, '''+&#60;TBL.&#34;CD&#34;&#62;+''' as vo_cdchr,'''+&#60;TBL.&#34;CD&#34;&#62;+''' as vo_cdchrs,0 as grp,2000 as vo_met,2 as vo_nur';&#13;&#10;                      // 16/01/09 12:46 CDN { (288738)&#13;&#10;                      If GetCargoVal( 'BPI_SQLSERVERTYPE' ) = 2 Then&#13;&#10;                        Begin&#13;&#10;                          str_sqlvo := str_sqlvo + ' FROM DUAL' + Chr(13);&#13;&#10;                        End;&#13;&#10;                      // 16/01/09 12:46 CDN } (288738)&#13;&#10;                    end;&#13;&#10;                  TBL.Next;&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' union all';&#13;&#10;              str_sqlvo:=str_sqlvo+' select pspr.spr_cd,pspr.spr_nm,payvo1.vo_cdchr,payvo1.vo_cdchrs,1 as grp,payvo1.vo_met,payvo1.vo_nur';&#13;&#10;              str_sqlvo:=str_sqlvo+' from pspr';&#13;&#10;              str_sqlvo:=str_sqlvo+' inner join payvo1 on pspr.spr_cd=payvo1.vo_cd';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo';&#13;&#10;              // СОИД 121880 WOLF 19.04.2007&#13;&#10;              //str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.KpuRl_CdVo,SUM(KpuRl_Sm) as Sm';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM ( SELECT RlVo.Rl_CdVo AS KpuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM PayRldo1 RlVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuX ON RlVo.PayRld_Tn = KpuX.Kpu_Tn';&#13;&#10;              // 06/07/11 ZVN (508248){&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuC1 ON KpuX.Kpu_Rcd = KpuC1.Kpu_Rcd'+Chr(13);&#13;&#10;               If  ((GetCargoVal('BpI_CdMd') = 543) or (GetCargoVal('BpI_CdMd') = 687)) then&#13;&#10;                 //студенты&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 1'+Chr(13)&#13;&#10;               else&#13;&#10;                 //работники&#13;&#10;                 str_sqlvo:=str_sqlvo+ ' AND KpuC1.Kpu_Type = 0'+Chr(13);&#13;&#10;              // 06/07/11 ZVN (508248)}&#13;&#10;              str_sqlvo:=str_sqlvo+' INNER JOIN KpuPrk1 ON KpuPrk1.bookmark=';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP1.bookmark)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP1';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP1.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP1.KpuPrkz_Dtv =';&#13;&#10;              str_sqlvo:=str_sqlvo+' ( SELECT MAX(PP2.KpuPrkz_Dtv)';&#13;&#10;              str_sqlvo:=str_sqlvo+' FROM KpuPrk1 PP2';&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE PP2.Kpu_Rcd = KpuX.Kpu_Rcd';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_RkPd = 1';&#13;&#10;              str_sqlvo:=str_sqlvo+' AND PP2.KpuPrkz_Dtv &#60;= :LDT1 ))';&#13;&#10;              str_sqlvo:=str_sqlvo+' LEFT JOIN SprPdr1 SprPdr ON KpuPrkz_PdRcd = SprPdr_Rcd and :PDRDT1 between SprPdr_DatN and SprPdr_DatK'+Chr(13);&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'INNER JOIN PayAccPdrSE ON SprPdr_Pd = PayAcc_Pdr'+Chr(13);&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND SprPdr_Dt = PayAcc_PdrDt'+Chr(13);&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ {&#13;&#10;              If (GetCargoVal('BpI_CdMd') = 576) then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' INNER JOIN KdrLsMarkTn ON KdrLSTN_KpuTn = KpuX.Kpu_Tn';&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KdrLSTN_Session = '+IntToStr(GetStationCd());&#13;&#10;                end;&#13;&#10;              // VDG 11/08/2008 Фильтр в РВ }&#13;&#10;              str_sqlvo:=str_sqlvo+' WHERE RlVo.PayRld_Dat BETWEEN :DT3 AND :DT4';&#13;&#10;              // По структурным единицам&#13;&#10;              If ( CheckBox9.Checked ) AND (SteCd &#60;&#62; '') then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+ 'AND PayAcc_SE IN ('+SteCd+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              // Выборочно по подразделениям&#13;&#10;              If ( RadioButton2.Checked = True ) and (str_pd &#60;&#62; '' ) then&#13;&#10;                begin&#13;&#10;                  // Включать подчиненные подразделения&#13;&#10;                  If CheckBox7.Checked then&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (SELECT k2.sprpdr_pd FROM sprpdr k1, sprpdr k2 WHERE k1.sprpdr_rcd IN ('+str_pd+') AND k2.sprpdr_pd LIKE {fn concat(k1.sprpdr_pd,''%'')})';&#13;&#10;                    end&#13;&#10;                  // Не включать подчиненные подразделения&#13;&#10;                  Else&#13;&#10;                    begin&#13;&#10;                      str_sqlvo:=str_sqlvo+' and kpuprk1.kpuprkz_pd in (select sprpdr_pd from sprpdr where sprpdr_rcd in ('+str_pd+'))';&#13;&#10;                    end;&#13;&#10;                end;&#13;&#10;              If dsMark.EOF = False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' AND KpuX.Kpu_Rcd IN (SELECT ServerMrk_Rcd FROM /*SYS_SHEMA*/ServerMrk WHERE ServerMrk_Type = 120 AND ServerMrk_Sess='+IntToStr(GetStationCd())+')'+Chr(13);&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' GROUP BY RlVo.Rl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:MTT1)})&#60;&#62;0';&#13;&#10;              str_sqlvo:=str_sqlvo+' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo';&#13;&#10;              str_sqlvo:=str_sqlvo+' where pspr.sprspr_cd=787202';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_grp&#62;127';&#13;&#10;              str_sqlvo:=str_sqlvo+' and spr_cd in ('+str_vo+')';&#13;&#10;              str_sqlvo:=str_sqlvo+' and payvo1.vo_cd not in ('+str_groupvo+')';&#13;&#10;              // Не включать виды оплат, которые не входят в Н/У&#13;&#10;              If CheckBox2.Checked=False then&#13;&#10;                begin&#13;&#10;                  str_sqlvo:=str_sqlvo+' and payvo1.vo_nur=0';&#13;&#10;                end;&#13;&#10;              str_sqlvo:=str_sqlvo+' ) tt order by tt.vo_cdchrs';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;     end;&#13;&#10;  VO.SQL.TEXT:=str_sqlvo;&#13;&#10;  VO.ParamByName('DT1').DataType:=ftDate;&#13;&#10;  VO.ParamByName('DT2').DataType:=ftDate;&#13;&#10;  VO.ParamByName('DT3').DataType:=ftDate;&#13;&#10;  VO.ParamByName('DT4').DataType:=ftDate;&#13;&#10;  VO.ParamByName('LDT').DataType:=ftDate;&#13;&#10;  VO.ParamByName('LDT1').DataType:=ftDate;&#13;&#10;  VO.ParamByName('MTT').DataType:=ftInteger;&#13;&#10;  VO.ParamByName('MTT1').DataType:=ftInteger;&#13;&#10;  VO.ParamByName('PDRDT').DataType:=ftDate;&#13;&#10;  VO.ParamByName('PDRDT1').DataType:=ftDate;&#13;&#10;  // На дату&#13;&#10;  If CheckBox5.Checked then&#13;&#10;    begin&#13;&#10;      VO.ParamByName('DT1').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('DT2').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('DT3').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('DT4').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('LDT').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('LDT1').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('PDRDT').Value:=DateEdit1.Date;&#13;&#10;      VO.ParamByName('PDRDT1').Value:=DateEdit1.Date;&#13;&#10;    end&#13;&#10;  // За интервал учетных периодов&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      VO.ParamByName('DT1').Value:=DTUP;&#13;&#10;      VO.ParamByName('DT2').Value:=DTUP1;&#13;&#10;      VO.ParamByName('DT3').Value:=DTUP;&#13;&#10;      VO.ParamByName('DT4').Value:=DTUP1;&#13;&#10;      VO.ParamByName('LDT').Value:=LDTUP;&#13;&#10;      VO.ParamByName('LDT1').Value:=LDTUP;&#13;&#10;      VO.ParamByName('PDRDT').Value:=LDTUP;&#13;&#10;      VO.ParamByName('PDRDT1').Value:=LDTUP;&#13;&#10;    end;&#13;&#10;  VO.ParamByName('MTT').Value:=ValMt;&#13;&#10;  VO.ParamByName('MTT1').Value:=ValMt;&#13;&#10; //=============================================================&#13;&#10;  // Детализировать по РП&#13;&#10;   If CheckBox1.Checked=True then&#13;&#10;     begin&#13;&#10;       DetailData1.Visible:=True;&#13;&#10;     end&#13;&#10;  // Без детализации по РП&#13;&#10;   Else&#13;&#10;     begin&#13;&#10;       DetailData1.Visible:=False;&#13;&#10;     end;&#13;&#10;&#13;&#10;{  desc:=BPRO.FILE_OPEN('C:\\TEMP\QSM.TXT',1);&#13;&#10;  str_sql:=QSM.SQL.TEXT;&#13;&#10;  leng:=Length(str_sql);&#13;&#10;  I:=1;&#13;&#10;  while I&#60;leng do&#13;&#10;    begin&#13;&#10;      BPRO.FILE_WRITE(desc,Copy(str_sql,i,80));&#13;&#10;      i:=i+80;&#13;&#10;    end;&#13;&#10;  BPRO.FILE_CLOSE(desc);&#13;&#10;}&#13;&#10;&#13;&#10;   QSM.First;&#13;&#10;   If CheckBox1.Checked = True then&#13;&#10;     begin&#13;&#10;       QSMRP.First;&#13;&#10;     end;&#13;&#10;   // СОИД 110220&#13;&#10;   Query1.First;&#13;&#10;   while not Query1.EOF do&#13;&#10;     begin&#13;&#10;       TN.Insert;&#13;&#10;       TN.FieldByName('KPU_TN').Value:=&#60;Query1.&#34;KPU_TN&#34;&#62;;&#13;&#10;       TN.FieldByName('KPU_FIO').Value:=&#60;Query1.&#34;KPU_FIO&#34;&#62;;&#13;&#10;       TN.FieldByName('KPU_FIOSRT').Value:=Copy(&#60;Query1.&#34;KPU_FIO&#34;&#62;,1,25);&#13;&#10;       If CheckBox9.Checked = False then&#13;&#10;         begin&#13;&#10;           TN.FieldByName('SPRPDR_POS').Value:='';&#13;&#10;         end;&#13;&#10;       If ((RadioButton1.Checked) or (CheckBox4.Checked)) AND (CheckBox9.Checked = False) then&#13;&#10;         begin&#13;&#10;           TN.FieldByName('SPRPDR_PD').Value:='';&#13;&#10;         end&#13;&#10;       // Выборочно по подразделениям&#13;&#10;       Else If RadioButton2.Checked then&#13;&#10;         begin&#13;&#10;         // Включать подчиненные&#13;&#10;           If CheckBox7.Checked then&#13;&#10;             begin&#13;&#10;               TN.FieldByName('SPRPDR_PD').Value:=GetGrpCd(&#60;Query1.&#34;SPRPDR_PD&#34;&#62;,str_grppd);&#13;&#10;               TN.FieldByName('SPRPDR_NM').Value:=BPRO.PDR_GET_FULL(GetGrpCd(&#60;Query1.&#34;SPRPDR_PD&#34;&#62;,str_grppd),0,LDTUP);&#13;&#10;             end&#13;&#10;         // Не включать подчиненные&#13;&#10;           Else&#13;&#10;             begin&#13;&#10;               TN.FieldByName('SPRPDR_PD').Value:=&#60;Query1.&#34;SPRPDR_PD&#34;&#62;;&#13;&#10;               TN.FieldByName('SPRPDR_NM').Value:=BPRO.PDR_GET_FULL(&#60;Query1.&#34;SPRPDR_PD&#34;&#62;,0,LDTUP);&#13;&#10;             end;&#13;&#10;         end&#13;&#10;       // По структурным единицам&#13;&#10;       Else If (CheckBox9.Checked) then&#13;&#10;         begin&#13;&#10;           TN.FieldByName('SPRPDR_PD').Value:=&#60;Query1.&#34;PayAcc_SE&#34;&#62;;&#13;&#10;         end;&#13;&#10;       // За интервал учетных периодов&#13;&#10;       If CheckBox5.Checked = False then&#13;&#10;         begin&#13;&#10;           TN.FieldByName('KPURL_SIN').Value:=&#60;Query1.&#34;KPURL_SIN&#34;&#62;;&#13;&#10;           TN.FieldByName('KPURL_NCH').Value:=&#60;Query1.&#34;KPURL_NCH&#34;&#62;;&#13;&#10;           TN.FieldByName('KPURL_UDR').Value:=&#60;Query1.&#34;KPURL_UDR&#34;&#62;;&#13;&#10;           TN.FieldByName('KPURL_SOUT').Value:=&#60;Query1.&#34;KPURL_SOUT&#34;&#62;;&#13;&#10;         end;&#13;&#10;       // Цех и МВЗ на последний день месяца&#13;&#10;       // доработка март 2023&#13;&#10;       MVZ_CEH.Close;&#13;&#10;       MVZ_CEH.ParamByName('LDT').Value:=LDTUP;&#13;&#10;       MVZ_CEH.ParamByName('kpu_tn').Value:=&#60;Query1.&#34;KPU_TN&#34;&#62;;&#13;&#10;       MVZ_CEH.First;&#13;&#10;       TN.FieldByName('CEH').Value:=copy(trim(&#60;MVZ_CEH.&#34;ceh&#34;&#62;),1,2);&#13;&#10;       TN.FieldByName('MVZ').Value:=trim(&#60;MVZ_CEH.&#34;mvz&#34;&#62;);&#13;&#10;&#13;&#10;       TN.Post;&#13;&#10;       Query1.Next;&#13;&#10;     end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button3OnClick(Sender: TfrxComponent);&#13;&#10;var formPODR:integer;&#13;&#10;begin&#13;&#10;  PDR.Close;&#13;&#10;  formPODR := TfrxDialogPage(FPD).ShowModal;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button4OnClick(Sender: TfrxComponent);&#13;&#10;var formVO:integer;&#13;&#10;var sql_vo:string;&#13;&#10;begin&#13;&#10;  DTUP  := EncodeDate(YearOf(IncMonth(datn,Combobox1.ItemIndex)),MonthOf(IncMonth(datn,Combobox1.ItemIndex)),1);&#13;&#10;  DTUP1  := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),1);&#13;&#10;  LDTUP := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),DaysInMonth(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex))));&#13;&#10;  If CheckBox5.Checked then&#13;&#10;    begin&#13;&#10;      sql_vo:='SELECT PayVo1.Vo_CdChr,PspR.Spr_Nm,PspR.Spr_Cd'+&#13;&#10;      ' FROM PayVo1'+&#13;&#10;      ' INNER JOIN PspR ON PayVo1.Vo_Cd=PspR.Spr_Cd'+&#13;&#10;      ' AND PspR.SprSpr_Cd = 787202'+&#13;&#10;      ' INNER JOIN'+&#13;&#10;      ' ( SELECT DISTINCT RVo.Rl_CdVo'+&#13;&#10;      ' FROM ( SELECT RlVo.Rl_CdVo,SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt)}) as Sm'+&#13;&#10;      ' FROM PayRlDo1 RlVo'+&#13;&#10;      ' WHERE RlVo.PayRld_Dat = :DT'+&#13;&#10;      ' GROUP BY RlVo.Rl_CdVo'+&#13;&#10;      ' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt1)})&#60;&#62;0'+&#13;&#10;      ' ) RVo ) BB ON PayVo1.Vo_Cd = BB.Rl_CdVo'+&#13;&#10;      ' ORDER BY PayVo1.Vo_Grp,PayVo1.Vo_CdChrS';&#13;&#10;      SPRVO.SQL.TEXT:=sql_vo;&#13;&#10;      DTUP:=DateEdit1.Date;&#13;&#10;      SPRVO.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SPRVO.ParamByName('DT').Value:=DTUP;&#13;&#10;      SPRVO.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt1').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt').Value:=ValMt;&#13;&#10;      SPRVO.ParamByName('mt1').Value:=ValMt;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      sql_vo:='SELECT PayVo1.Vo_CdChr,PspR.Spr_Nm,PspR.Spr_Cd'+&#13;&#10;      ' FROM PayVo1'+&#13;&#10;      ' INNER JOIN PspR ON PayVo1.Vo_Cd=PspR.Spr_Cd'+&#13;&#10;      ' AND PspR.SprSpr_Cd = 787202'+&#13;&#10;      ' INNER JOIN ('+&#13;&#10;      ' SELECT DISTINCT RVo.KpuRl_CdVo'+&#13;&#10;      ' FROM'+&#13;&#10;      ' ( SELECT RlVo.KpuRl_CdVo,SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt)}) as Sm'+&#13;&#10;      ' FROM KpuRlo1 RlVo'+&#13;&#10;      ' WHERE RlVo.KpuRl_DatUp BETWEEN :DT AND :DT1'+&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;      ' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;      ' GROUP BY RlVo.KpuRl_CdVo'+&#13;&#10;      ' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt1)})&#60;&#62;0'+&#13;&#10;      ' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+&#13;&#10;      ' ORDER BY PayVo1.Vo_Grp,PayVo1.Vo_CdChrS';&#13;&#10;      SPRVO.SQL.TEXT:=sql_vo;&#13;&#10;      SPRVO.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SPRVO.ParamByName('DT1').DataType:=ftDate;&#13;&#10;      SPRVO.ParamByName('DT').Value:=DTUP;&#13;&#10;      SPRVO.ParamByName('DT1').Value:=DTUP1;&#13;&#10;      SPRVO.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt1').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt').Value:=ValMt;&#13;&#10;      SPRVO.ParamByName('mt1').Value:=ValMt;&#13;&#10;    end;&#13;&#10;  formVO := TfrxDialogPage(FVO).ShowModal;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure RadioButton1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If RadioButton1.Checked=True then&#13;&#10;    begin&#13;&#10;      Button3.Enabled:=False;&#13;&#10;      CheckBox4.Enabled:=False;&#13;&#10;      Button1.Enabled:=True;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button3.Enabled:=True;&#13;&#10;      CheckBox4.Enabled:=True;&#13;&#10;    end;&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure RadioButton2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If RadioButton1.Checked=True then&#13;&#10;    begin&#13;&#10;      Button3.Enabled:=False;&#13;&#10;      CheckBox4.Enabled:=False;&#13;&#10;      Button1.Enabled:=True;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button3.Enabled:=True;&#13;&#10;      CheckBox4.Enabled:=True;&#13;&#10;    end;&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure RadioButton3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If RadioButton3.Checked=True then&#13;&#10;    begin&#13;&#10;      Button4.Enabled:=False;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button4.Enabled:=True;&#13;&#10;    end;&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure RadioButton4OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If RadioButton3.Checked=True then&#13;&#10;    begin&#13;&#10;      Button4.Enabled:=False;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button4.Enabled:=True;&#13;&#10;    end;&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure FPDOnActivate(Sender: TfrxComponent);&#13;&#10;var fkol1,indx:integer;&#13;&#10;begin&#13;&#10;  LDTUP := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),DaysInMonth(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex))));&#13;&#10;  Trw1.SpDate := LDTUP;&#13;&#10;  Trw1.CdFirm := GetCargoVal('BPI_CDFIRM');&#13;&#10;  Trw1.CdUser := GetCargoVal('BPI_CDUSR');&#13;&#10;  Trw1.UseAccess := True;&#13;&#10;  Trw1.IsKdr := False;&#13;&#10;  If inc_pd &#60;&#62; '1' then&#13;&#10;    CheckBox7.Checked := false&#13;&#10;  else&#13;&#10;    CheckBox7.Checked := true;&#13;&#10;&#13;&#10;    If CheckBox7.Checked then&#13;&#10;      begin&#13;&#10;        Trw1.IncSub := True;&#13;&#10;      end&#13;&#10;    Else&#13;&#10;      begin&#13;&#10;        Trw1.IncSub := False;&#13;&#10;      end;&#13;&#10;    If str_pd &#60;&#62; '' Then&#13;&#10;      Begin&#13;&#10;        Trw1.RePaint;&#13;&#10;        Trw1.SetCheckString(str_pd);&#13;&#10;      End&#13;&#10;    Else&#13;&#10;      Begin&#13;&#10;        Trw1.FillSpr;&#13;&#10;      End;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure FVOOnActivate(Sender: TfrxComponent);&#13;&#10;var strv:string;&#13;&#10;begin&#13;&#10;  strv := '';&#13;&#10;  SPRVO.First;&#13;&#10;  while not SPRVO.Eof do&#13;&#10;    begin&#13;&#10;      strv := strv + IntToStr(&#60;SPRVO.&#34;SPR_CD&#34;&#62;)+',';&#13;&#10;      SPRVO.Next;&#13;&#10;    end;&#13;&#10;  strv := Copy(strv,1,Length(strv)-1);&#13;&#10;  TVo1.SetFilterVo(strv);&#13;&#10;  TVo1.FillSpr();&#13;&#10;  TVo1.SetVo(str_vo);&#13;&#10;  TVo1.SetGr(str_gr);&#13;&#10;end;&#13;&#10;&#13;&#10;{procedure CheckListBox1OnClick(Sender: TfrxComponent);&#13;&#10;var i,f:integer;&#13;&#10;begin&#13;&#10;  f:=0;&#13;&#10;  For i:=0 to CheckListBox1.Items.Count-1 do&#13;&#10;    begin&#13;&#10;      If CheckListBox1.Checked[i]=False then&#13;&#10;        begin&#13;&#10;          f:=f+0;&#13;&#10;        end&#13;&#10;      Else If CheckListBox1.Checked[i]=True then&#13;&#10;        begin&#13;&#10;          f:=f+1;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  If f&#62;0 then&#13;&#10;    begin&#13;&#10;      Button5.Enabled:=True;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button5.Enabled:=False;&#13;&#10;    end;&#13;&#10;  masi[t_rec1]:=''; //Очистка элемента массива&#13;&#10;   // Обработка списка&#13;&#10;  for i2 := 0 to (CheckListBox1.Items.Count-1) do&#13;&#10;    begin&#13;&#10;      if CheckListBox1.Checked[i2] then&#13;&#10;      begin&#13;&#10;        masi[t_rec1]:=masi[t_rec1]+IntToStr(i2)+',';&#13;&#10;      end;&#13;&#10;    end;&#13;&#10;  //Получаем элемент массива с индексами отмеченных записей&#13;&#10;  masi[t_rec1]:=Copy(masi[t_rec1],1,length(masi[t_rec1])-1);&#13;&#10;  For i:=1 to 128 do&#13;&#10;    begin&#13;&#10;      SetFirmUserRepParam(mas_save[i],'');&#13;&#10;    end;&#13;&#10;  // СОИД 108336 wolf 28.09.2006 (расширение сохранения отмеченных записей)&#13;&#10;  If Length(masi[t_rec1])&#62;200 then&#13;&#10;    begin&#13;&#10;      sml:=1;&#13;&#10;      lnn:=200;&#13;&#10;      For i:=1 to 128 do&#13;&#10;        begin&#13;&#10;          If Copy(masi[t_rec1],sml,lnn)&#60;&#62;'' then&#13;&#10;            begin&#13;&#10;              SetFirmUserRepParam(mas_save[i], Copy(masi[t_rec1],sml,lnn));&#13;&#10;            end;&#13;&#10;          sml:=sml+200;&#13;&#10;          lnn:=lnn+200;&#13;&#10;        end;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      SetFirmUserRepParam(mas_save[1], masi[t_rec1]);&#13;&#10;    end;&#13;&#10;end;&#13;&#10;}&#13;&#10;&#13;&#10;procedure Button5OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; str_pd:='';&#13;&#10; str_pd := Trw1.GetCheckString;&#13;&#10; str_grppd := Trw1.GetPdList;&#13;&#10; SetFirmUserRepParam('PD',str_pd);&#13;&#10;&#13;&#10; If CheckBox7.Checked = true then&#13;&#10;   inc_pd := '1'&#13;&#10; else&#13;&#10;   inc_pd := '0';&#13;&#10; SetFirmUserRepParam('INC_PD',inc_pd);&#13;&#10;&#13;&#10;// 29/07/10 14:07 CDN { (442368)&#13;&#10;{&#13;&#10;    If str_pd='' then&#13;&#10;      begin&#13;&#10;        Button1.Enabled:=False;&#13;&#10;      end&#13;&#10;    Else&#13;&#10;      begin&#13;&#10;        Button1.Enabled:=True;&#13;&#10;      end;&#13;&#10;}&#13;&#10;  _CheckStayOK();&#13;&#10;// 29/07/10 14:07 CDN } (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button7OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  str_vo:='';&#13;&#10;  str_gr:='';&#13;&#10;  str_vo := TVo1.GetVo();&#13;&#10;  str_gr := TVo1.GetGr();&#13;&#10;  SetFirmUserRepParam('VO',str_vo);&#13;&#10;  SetFirmUserRepParam('GR',str_gr);&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  nu:=0;&#13;&#10;  ud:=0;&#13;&#10;  If CheckBox1.Checked then&#13;&#10;    begin&#13;&#10;      RP.Close;&#13;&#10;      RP.ParamByName('DT').DataType:=ftDate;&#13;&#10;      RP.ParamByName('DT1').DataType:=ftDate;&#13;&#10;      RP.ParamByName('TN').DataType:=ftVariant;&#13;&#10;      RP.ParamByName('DT').Value:=DTUP;&#13;&#10;      RP.ParamByName('DT1').Value:=DTUP1;&#13;&#10;      RP.ParamByName('TN').Value:=&#60;TN.&#34;Kpu_Tn&#34;&#62;;&#13;&#10;      RP.First;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupFooter1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;var i:integer;&#13;&#10;begin&#13;&#10;  Header3.Visible := False;&#13;&#10;  For i:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      massm[i]:=0;&#13;&#10;      mgrp[i]:=0;&#13;&#10;    end;&#13;&#10;  sld_in:=0;&#13;&#10;  sld_out:=0;&#13;&#10;  sld_nch:=0;&#13;&#10;  sld_udr:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo14OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sld_in:=sld_in+Value;&#13;&#10;  sld_in1:=sld_in1+Value;&#13;&#10;  If Value=0 then&#13;&#10;  Memo14.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo4OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If ComboBox1.ItemIndex = ComboBox2.ItemIndex then&#13;&#10;    begin&#13;&#10;      Memo4.Text := 'за '+BPRO.FMONTH_NAME(DTUP,0)+' '+IntToStr(YearOf(DTUP));&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Memo4.Text := 'за '+BPRO.FMONTH_NAME(DTUP,0)+' '+IntToStr(YearOf(DTUP))+' - '+BPRO.FMONTH_NAME(DTUP1,0)+' '+IntToStr(YearOf(DTUP1));&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo3OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If ( RadioButton1.Checked ) AND ( CheckBox9.Checked = False ) then&#13;&#10;    begin&#13;&#10;      Memo3.Text:='По предприятию';&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      If CheckBox4.Checked=False then&#13;&#10;        begin&#13;&#10;          If CheckBox9.Checked then&#13;&#10;            begin&#13;&#10;              BPRO.F_SYSSTE_GET(  0,  &#60;TN.&#34;SPRPDR_PD&#34;&#62;, BPRO.SCBN_STR1 , BPRO.SCBN_STR2, 1);&#13;&#10;              Memo3.Text:=&#60;TN.&#34;SPRPDR_PD&#34;&#62;+' '+BPRO.SCBN_STR1.Value;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Memo3.Text:=&#60;TN.&#34;SPRPDR_PD&#34;&#62;+' '+&#60;TN.&#34;SPRPDR_NM&#34;&#62;;&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          If CheckBox9.Checked then&#13;&#10;            begin&#13;&#10;              Memo3.Text:='По структурным единицам';&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Memo3.Text:='По подразделениям';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var strSQL:string;&#13;&#10;begin&#13;&#10;  Memo3.Align := baCenter;&#13;&#10;  Memo4.Align := baCenter;&#13;&#10;  //// VDG 26/05/2009 {&#13;&#10;  //If CheckBox6.Checked then&#13;&#10;  //  begin&#13;&#10;  //    TN.Filtered := False;&#13;&#10;  //    TN.Filter := 'KPURL_SIN*100 = 0 AND KPURL_NCH*100 = 0 AND KPURL_UDR*100 = 0 AND KPURL_SOUT*100 = 0';&#13;&#10;  //    TN.Filtered := True;&#13;&#10;  //    TN.First;&#13;&#10;  //    WHILE NOT TN.EOF DO&#13;&#10;  //      begin&#13;&#10;  //        TN.Delete;&#13;&#10;  //      end;&#13;&#10;  //  end;&#13;&#10;  //TN.Filtered := False;&#13;&#10;  //// VDG 26/05/2009 }&#13;&#10;  // 12/09/11 ZVN(516120) {&#13;&#10;  if CheckBox1.Checked then&#13;&#10;   begin&#13;&#10;    strSQL :='';&#13;&#10;    strSQL := strSQL + 'select kpurlo1.kpurl_datrp'+Chr(13);&#13;&#10;    strSQL := strSQL + 'from kpurlo1              '+Chr(13);&#13;&#10;    strSQL := strSQL + 'where kpurlo1.kpu_tn=:tn  '+Chr(13);&#13;&#10;    strSQL := strSQL + 'and kpurlo1.kpurl_datup between :DT and :DT1 '+Chr(13);&#13;&#10;    if RadioButton4.Checked then&#13;&#10;      begin&#13;&#10;        strSQL := strSQL + ' AND ('+Chr(13);&#13;&#10;        if (str_vo &#60;&#62; '') then&#13;&#10;          strSQL := strSQL + ' KpuRl_CdVo IN ('+str_vo+')'+Chr(13);&#13;&#10;        if (str_vo &#60;&#62; '')and (str_groupvo &#60;&#62; '') then&#13;&#10;          strSQL := strSQL + ' or ';&#13;&#10;        if (str_groupvo &#60;&#62; '') then&#13;&#10;          strSQL := strSQL + ' KpuRl_CdVo IN ('+str_groupvo+')'+Chr(13);&#13;&#10;        strSQL := strSQL + '   )'+Chr(13);&#13;&#10;      end;&#13;&#10;    strSQL := strSQL + ' group by kpurlo1.kpurl_datrp '+Chr(13);&#13;&#10;    strSQL := strSQL + 'order by kpurlo1.kpurl_datrp  '+Chr(13);&#13;&#10;    RP.SQL.Text := strSQL;&#13;&#10;   end;&#13;&#10;  // 12/09/11 ZVN(516120) }&#13;&#10;  RP.ParamByName('DT').DataType:=ftDate;&#13;&#10;  RP.ParamByName('DT1').DataType:=ftDate;&#13;&#10;  RP.ParamByName('TN').DataType:=ftVariant;&#13;&#10;  RP.ParamByName('DT').Value:=DTUP;&#13;&#10;  RP.ParamByName('DT1').Value:=DTUP1;&#13;&#10;  RP.ParamByName('TN').Value:=1;&#13;&#10;  TN.First;&#13;&#10;  If TN.Eof then&#13;&#10;    begin&#13;&#10;      showmessage('Отчет пуст');&#13;&#10;      StopCloseReport;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      If VO.Eof then&#13;&#10;        begin&#13;&#10;          showmessage('Отчет пуст');&#13;&#10;          StopCloseReport;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Memo10.Text:=IntToStr(&#60;Line&#62;)+'.';&#13;&#10;  pTn:=&#60;Query1.&#34;KPU_TN&#34;&#62;;&#13;&#10;//   06.02.2007 СОИД 110752 Оптимизация =======================&#13;&#10;//  SLD.Close;&#13;&#10;//  SLD.ParamByName('tn').Value:=pTn;&#13;&#10;//  SLD.First;&#13;&#10;//  SLD.Filtered := False;&#13;&#10;//  SLD.Filter := 'KPU_TN='+IntToStr(&#60;Query1.&#34;KPU_TN&#34;&#62;);&#13;&#10;//  SLD.Filtered := True;&#13;&#10;//  SLD.First;&#13;&#10;//  ===========================================================&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData3OnAfterPrint(Sender: TfrxComponent);&#13;&#10;var i:integer;&#13;&#10;begin&#13;&#10;  For i:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      massm1[i]:=0;&#13;&#10;      mgrp1[i]:=0;&#13;&#10;    end;&#13;&#10;  sld_in1:=0;&#13;&#10;  sld_out1:=0;&#13;&#10;  sld_nch1:=0;&#13;&#10;  sld_udr1:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo54OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000 then&#13;&#10;    begin&#13;&#10;      If &#60;QSM.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;        begin&#13;&#10;          Memo54.Text:=FormatFloat('0.00',&#60;QSM.&#34;KPURL_SM&#34;&#62;)+' ';&#13;&#10;          massm[&#60;VO.&#34;SPR_CD&#34;&#62;]:=massm[&#60;VO.&#34;SPR_CD&#34;&#62;]+&#60;QSM.&#34;KPURL_SM&#34;&#62;;&#13;&#10;          massm1[&#60;VO.&#34;SPR_CD&#34;&#62;]:=massm1[&#60;VO.&#34;SPR_CD&#34;&#62;]+&#60;QSM.&#34;KPURL_SM&#34;&#62;;&#13;&#10;        end;&#13;&#10;      QSM.Next; // 21/01/09 17:19 CDN (290208)&#13;&#10;    end;&#13;&#10;// Признак группы&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;    begin&#13;&#10;      SMGRP.Close;&#13;&#10;      SMGRP.SQL.Text:=strsmgrp;&#13;&#10;      SMGRP.SQL.Add('and payvo1.vo_cd in ('+massiv[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+')');&#13;&#10;      SMGRP.ParamByName('tn').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SMGRP.ParamByName('DT1').DataType:=ftDate;&#13;&#10;      SMGRP.ParamByName('tn').Value:=&#60;TN.&#34;KPU_TN&#34;&#62;;&#13;&#10;      SMGRP.ParamByName('mt').Value:=ValMt;&#13;&#10;      SMGRP.ParamByName('DT').Value:=DTUP;&#13;&#10;      SMGRP.ParamByName('DT1').Value:=DTUP1;&#13;&#10;      SMGRP.Open;&#13;&#10;      If &#60;SMGRP.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;        begin&#13;&#10;          Memo54.Text:=FormatFloat('0.00',&#60;SMGRP.&#34;KPURL_SM&#34;&#62;)+' ';&#13;&#10;          mgrp[&#60;VO.&#34;SPR_CD&#34;&#62;+1]:=mgrp[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+&#60;SMGRP.&#34;KPURL_SM&#34;&#62;;&#13;&#10;          mgrp1[&#60;VO.&#34;SPR_CD&#34;&#62;+1]:=mgrp1[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+&#60;SMGRP.&#34;KPURL_SM&#34;&#62;;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  // Синхронность датасетов Query1 (работники), VO ( виды оплат )  и QSM - СУММЫ&#13;&#10;  // При разрушении синхронной навигации суммы потеряют актуальность!!!!!!!&#13;&#10;// 21/01/09 17:19 CDN (290208)  QSM.Next;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo55OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;    begin&#13;&#10;      Memo55.Text:=FormatFloat('0.00',mgrp1[&#60;VO.&#34;SPR_CD&#34;&#62;+1]);&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo53OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;    begin&#13;&#10;      Memo53.Text:=FormatFloat('0.00',mgrp[&#60;VO.&#34;SPR_CD&#34;&#62;+1]);&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo36OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If (&#60;VO.&#34;VO_NUR&#34;&#62;=0) and (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=0) then&#13;&#10;    begin&#13;&#10;      Memo36.Text:=&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else If (&#60;VO.&#34;VO_NUR&#34;&#62;=1) or (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=1) then&#13;&#10;    begin&#13;&#10;      Memo36.Text:='* '+&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Memo36.Text:=&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo56OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If CheckBox1.Checked=True then&#13;&#10;    begin&#13;&#10;      If &#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000 then&#13;&#10;        begin&#13;&#10;          If &#60;QSMRP.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;            begin&#13;&#10;              Memo56.Text:=FormatFloat('0.00',&#60;QSMRP.&#34;KPURL_SM&#34;&#62;)+' ';&#13;&#10;            end;&#13;&#10; //        showmessage(IntToStr(&#60;QSMRP.&#34;Kpu_tn&#34;&#62;)+' '+IntToStr(&#60;QSMRP.&#34;Vo_cd&#34;&#62;)+' '+VarToStr(&#60;QSMRP.&#34;Kpurl_sm&#34;&#62;)+' '+DateToStr(&#60;QSMRP.&#34;Kpurl_Datrp&#34;&#62;));&#13;&#10;          QSMRP.Next; // 21/01/09 17:19 CDN (290208)&#13;&#10;        end&#13;&#10;  // Признак группы&#13;&#10;      Else If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;        begin&#13;&#10;          SMRGRP.Close;&#13;&#10;          SMRGRP.SQL.Text:=strsmgrpr;&#13;&#10;          SMRGRP.SQL.Add('and payvo1.vo_cd in ('+massiv[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+')');&#13;&#10;          SMRGRP.ParamByName('tn').DataType:=ftInteger;&#13;&#10;          SMRGRP.ParamByName('mt').DataType:=ftInteger;&#13;&#10;          SMRGRP.ParamByName('DT').DataType:=ftDate;&#13;&#10;          SMRGRP.ParamByName('DT1').DataType:=ftDate;&#13;&#10;          SMRGRP.ParamByName('DTRP').DataType:=ftDate;&#13;&#10;          SMRGRP.ParamByName('tn').Value:=&#60;TN.&#34;KPU_TN&#34;&#62;;&#13;&#10;          SMRGRP.ParamByName('mt').Value:=ValMt;&#13;&#10;          SMRGRP.ParamByName('DT').Value:=DTUP;&#13;&#10;          SMRGRP.ParamByName('DT1').Value:=DTUP1;&#13;&#10;          SMRGRP.ParamByName('DTRP').Value:=&#60;RP.&#34;KPURL_DATRP&#34;&#62;;&#13;&#10;          SMRGRP.Open;&#13;&#10;          If &#60;SMRGRP.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;            begin&#13;&#10;             Memo56.Text:=FormatFloat('0.00',&#60;SMRGRP.&#34;KPURL_SM&#34;&#62;)+' ';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;      // Синхронная навигация по датасетам. не менять!!!!!&#13;&#10;// 21/01/09 17:19 CDN (290208)      QSMRP.Next;&#13;&#10;      // =================================================&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button11OnClick(Sender: TfrxComponent);&#13;&#10;var sql_vo:string;&#13;&#10;begin&#13;&#10;  DTUP   := EncodeDate(YearOf(IncMonth(datn,Combobox1.ItemIndex)),MonthOf(IncMonth(datn,Combobox1.ItemIndex)),1);&#13;&#10;  DTUP1  := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),1);&#13;&#10;  LDTUP  := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),DaysInMonth(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex))));&#13;&#10;    If CheckBox5.Checked Then&#13;&#10;      Begin&#13;&#10;        sql_vo := 'SELECT PayVo1.Vo_CdChr, ' + Chr(13) +&#13;&#10;                  '       PSpr.Spr_Nm, ' + Chr(13) +&#13;&#10;                  '       PSpr.Spr_Cd ' + Chr(13) +&#13;&#10;                  'FROM PayVo1 ' + Chr(13) +&#13;&#10;                  '     INNER JOIN PSpr ON PayVo1.Vo_Cd = PspR.Spr_Cd ' + Chr(13) +&#13;&#10;                  '                        AND PSpr.SprSpr_Cd = 787202 ' + Chr(13) +&#13;&#10;                  '     INNER JOIN ( SELECT DISTINCT RVo.Rl_CdVo ' + Chr(13) +&#13;&#10;                  '                  FROM ( SELECT RlVo.Rl_CdVo, ' + Chr(13) +&#13;&#10;                  '                                SUM( {fn CONVERT( Rl_Sm, SQL_DECIMAL )} ) / ( {fn POWER( 10, :mt )} ) AS Sm ' + Chr(13) +&#13;&#10;                  '                         FROM PayRlDo1 RlVo ' + Chr(13) +&#13;&#10;                  '                         WHERE RlVo.PayRld_Dat = :DT ' + Chr(13) +&#13;&#10;                  '                         GROUP BY RlVo.Rl_CdVo ' + Chr(13) +&#13;&#10;                  '                         HAVING SUM( {fn CONVERT( Rl_Sm, SQL_DECIMAL )} ) / ( {fn POWER( 10, :mt1 )} ) &#60;&#62; 0 ' + Chr(13) +&#13;&#10;                  '                       ) RVo ' + Chr(13) +&#13;&#10;                  '                ) BB ON PayVo1.Vo_Cd = BB.Rl_CdVo ' + Chr(13) +&#13;&#10;                  'ORDER BY PayVo1.Vo_Grp, ' + Chr(13) +&#13;&#10;                  '         PayVo1.Vo_CdChrS ';&#13;&#10;      SPRVO.SQL.TEXT := sql_vo;&#13;&#10;      DTUP := DateEdit1.Date;&#13;&#10;      SPRVO.ParamByName( 'DT' ).DataType  := ftDate;&#13;&#10;      SPRVO.ParamByName( 'DT' ).Value     := DTUP;&#13;&#10;      SPRVO.ParamByName( 'mt' ).DataType  := ftInteger;&#13;&#10;      SPRVO.ParamByName( 'mt1' ).DataType := ftInteger;&#13;&#10;      SPRVO.ParamByName( 'mt' ).Value     := ValMt;&#13;&#10;      SPRVO.ParamByName( 'mt1' ).Value    := ValMt;&#13;&#10;    End&#13;&#10;  Else&#13;&#10;    Begin&#13;&#10;      sql_vo := 'SELECT PayVo1.Vo_CdChr, ' + Chr(13) +&#13;&#10;                '       PSpr.Spr_Nm, ' + Chr(13) +&#13;&#10;                '       PSpr.Spr_Cd ' + Chr(13) +&#13;&#10;                'FROM PayVo1 ' + Chr(13) +&#13;&#10;                '     INNER JOIN PSpr ON PayVo1.Vo_Cd = PSpr.Spr_Cd ' + Chr(13) +&#13;&#10;                '                        AND PSpr.SprSpr_Cd = 787202 ' + Chr(13) +&#13;&#10;                '     INNER JOIN ( SELECT DISTINCT RVo.KpuRl_CdVo ' + Chr(13) +&#13;&#10;                '                  FROM ( SELECT RlVo.KpuRl_CdVo, ' + Chr(13) +&#13;&#10;                '                                SUM( {fn CONVERT( KpuRl_Sm, SQL_DECIMAL )} ) / ( {fn POWER( 10, :mt )} ) As Sm ' + Chr(13) +&#13;&#10;                '                         FROM KpuRlo1 RlVo ' + Chr(13) +&#13;&#10;                '                         WHERE RlVo.KpuRl_DatUp BETWEEN :DT AND :DT1 ' + Chr(13) +&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;                '                               and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;                '                         GROUP BY RlVo.KpuRl_CdVo ' + Chr(13) +&#13;&#10;                '                         HAVING SUM( {fn CONVERT( KpuRl_Sm, SQL_DECIMAL )} ) / ( {fn POWER( 10, :mt1 )} ) &#60;&#62; 0 ' + Chr(13) +&#13;&#10;                '                       ) RVo ' + Chr(13) +&#13;&#10;                '                ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo ' + Chr(13) +&#13;&#10;                'ORDER BY PayVo1.Vo_Grp, ' + Chr(13) +&#13;&#10;                '         PayVo1.Vo_CdChrS';&#13;&#10;      SPRVO.SQL.TEXT := sql_vo;&#13;&#10;      SPRVO.ParamByName( 'DT' ).DataType  := ftDate;&#13;&#10;      SPRVO.ParamByName( 'DT1' ).DataType := ftDate;&#13;&#10;      SPRVO.ParamByName( 'DT' ).Value     := DTUP;&#13;&#10;      SPRVO.ParamByName( 'DT1' ).Value    := DTUP1;&#13;&#10;      SPRVO.ParamByName( 'mt' ).DataType  := ftInteger;&#13;&#10;      SPRVO.ParamByName( 'mt1' ).DataType := ftInteger;&#13;&#10;      SPRVO.ParamByName( 'mt' ).Value     := ValMt;&#13;&#10;      SPRVO.ParamByName( 'mt1' ).Value    := ValMt;&#13;&#10;    end;&#13;&#10;  GRP.ShowModal;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button12OnClick(Sender: TfrxComponent);&#13;&#10;var formCRT:integer;&#13;&#10;begin&#13;&#10;  flg_crt:=0;&#13;&#10;  formCRT := TfrxDialogPage(CRT).ShowModal;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button13OnClick(Sender: TfrxComponent);&#13;&#10;var formCRT:integer;&#13;&#10;begin&#13;&#10;  flg_crt:=1;&#13;&#10;  formCRT := TfrxDialogPage(CRT).ShowModal;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button14OnClick(Sender: TfrxComponent);&#13;&#10;var f:integer;&#13;&#10;begin&#13;&#10;  TBL.First;&#13;&#10;  while not TBL.Eof do&#13;&#10;    begin&#13;&#10;      If &#60;TBL.&#34;ID&#34;&#62;=ListBox1.ItemIndex then&#13;&#10;        begin&#13;&#10;          TBL.Delete;&#13;&#10;          f:=ListBox1.ItemIndex;&#13;&#10;          ListBox1.Items.Delete(ListBox1.ItemIndex);&#13;&#10;          massiv[f+1]:='';&#13;&#10;          massividx[f+1]:='';&#13;&#10;          SetFirmUserRepParam(m[f+1], massiv[f+1]);&#13;&#10;          SetFirmUserRepParam(m1[f+1], massividx[f+1]);&#13;&#10;          SetFirmUserRepParam(mas_tbl[f+1,1],'');&#13;&#10;          SetFirmUserRepParam(mas_tbl[f+1,2],'');&#13;&#10;          SetFirmUserRepParam(mas_tbl[f+1,3],'');&#13;&#10;          SetFirmUserRepParam(mas_tbl[f+1,4],'');&#13;&#10;          break;&#13;&#10;        end;&#13;&#10;      TBL.Next;&#13;&#10;    end;&#13;&#10;  TBL.First;&#13;&#10;  while not TBL.Eof do&#13;&#10;    begin&#13;&#10;      If &#60;TBL.&#34;ID&#34;&#62;&#62;f then&#13;&#10;        begin&#13;&#10;          TBL.Edit;&#13;&#10;          TBL.FieldByName('ID').Value:=TBL.FieldByName('ID').Value-1;&#13;&#10;          break;&#13;&#10;        end;&#13;&#10;      TBL.Next;&#13;&#10;    end;&#13;&#10;  If ListBox1.Items.Count&#62;0 then&#13;&#10;    begin&#13;&#10;      Button13.Enabled:=True;&#13;&#10;      Button14.Enabled:=True;&#13;&#10;      Button17.Enabled:=True;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button13.Enabled:=False;&#13;&#10;      Button14.Enabled:=False;&#13;&#10;      Button17.Enabled:=False;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GRPOnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  TBL.First;&#13;&#10;  If TBL.Eof=True then&#13;&#10;    begin&#13;&#10;      Button13.Enabled:=False;&#13;&#10;      Button14.Enabled:=False;&#13;&#10;      Button17.Enabled:=False;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button13.Enabled:=True;&#13;&#10;      Button14.Enabled:=True;&#13;&#10;      Button17.Enabled:=True;&#13;&#10;    end;&#13;&#10;  ListBox1.Items.Clear;&#13;&#10;  while not TBL.Eof do&#13;&#10;    begin&#13;&#10;      ListBox1.Items.AddObject(&#60;TBL.&#34;CD&#34;&#62;+' '+&#60;TBL.&#34;NM&#34;&#62;,TObject(&#60;TBL.&#34;ID&#34;&#62;));&#13;&#10;      TBL.Next;&#13;&#10;    end;&#13;&#10;  TBL.First;&#13;&#10;  If TBL.Eof=False then&#13;&#10;  ListBox1.ItemIndex:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CRTOnActivate(Sender: TfrxComponent);&#13;&#10;var f:integer;&#13;&#10;begin&#13;&#10;// Создание&#13;&#10;  If flg_crt=0 then&#13;&#10;    begin&#13;&#10;      CRT.Caption:='Создание групы';&#13;&#10;      Edit1.Text:='';&#13;&#10;      Edit2.Text:='';&#13;&#10;    end&#13;&#10;  Else&#13;&#10;// Редактирование&#13;&#10;    begin&#13;&#10;      CRT.Caption:='Редактирование групы';&#13;&#10;      Edit1.Text:='';&#13;&#10;      Edit2.Text:='';&#13;&#10;      TBL.First;&#13;&#10;      while not TBL.Eof do&#13;&#10;        begin&#13;&#10;          If &#60;TBL.&#34;ID&#34;&#62;=ListBox1.ItemIndex then&#13;&#10;            begin&#13;&#10;              Edit1.Text:=&#60;TBL.&#34;CD&#34;&#62;;&#13;&#10;              Edit2.Text:=&#60;TBL.&#34;NM&#34;&#62;;&#13;&#10;              break;&#13;&#10;            end;&#13;&#10;          TBL.Next;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button15OnClick(Sender: TfrxComponent);&#13;&#10;var t,i,y:integer;&#13;&#10;begin&#13;&#10;  t:=0;&#13;&#10;  For i:=0 to ListBox1.Items.Count-1 do&#13;&#10;    begin&#13;&#10;      t:=t+1;&#13;&#10;    end;&#13;&#10;// Создание&#13;&#10;  If flg_crt=0 then&#13;&#10;    begin&#13;&#10;      ListBox1.Items.AddObject(Edit1.Text+' '+Edit2.Text,TObject(t));&#13;&#10;      ListBox1.ItemIndex:=t;&#13;&#10;      TBL.Insert;&#13;&#10;      TBL.FieldByName('ID').Value:=t;&#13;&#10;      TBL.FieldByName('NM').Value:=Edit2.Text;&#13;&#10;      TBL.FieldByName('CD').Value:=Edit1.Text;&#13;&#10;      TBL.Post;&#13;&#10;    end&#13;&#10;// Редактирование&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      LisTBox1.Items.Strings[ListBox1.ItemIndex]:=Edit1.Text+' '+Edit2.Text;&#13;&#10;      ListBox1.ItemIndex:=ListBox1.ItemIndex;&#13;&#10;      TBL.First;&#13;&#10;      while not TBL.Eof do&#13;&#10;        begin&#13;&#10;          If &#60;TBL.&#34;ID&#34;&#62;=ListBox1.ItemIndex then&#13;&#10;            begin&#13;&#10;              TBL.Edit;&#13;&#10;              TBL.FieldByName('NM').Value:=Edit2.Text;&#13;&#10;              TBL.FieldByName('CD').Value:=Edit1.Text;&#13;&#10;              TBL.Post;&#13;&#10;              break;&#13;&#10;            end;&#13;&#10;          TBL.Next;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  If ListBox1.Items.Count&#62;0 then&#13;&#10;    begin&#13;&#10;      Button13.Enabled:=True;&#13;&#10;      Button14.Enabled:=True;&#13;&#10;      Button17.Enabled:=True;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button13.Enabled:=False;&#13;&#10;      Button14.Enabled:=False;&#13;&#10;      Button17.Enabled:=False;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button9OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  TBL.First;&#13;&#10;  while not TBL.Eof do&#13;&#10;    begin&#13;&#10;      SetFirmUserRepParam(mas_tbl[&#60;TBL.&#34;ID&#34;&#62;+1,1],IntToStr(&#60;TBL.&#34;ID&#34;&#62;));&#13;&#10;      SetFirmUserRepParam(mas_tbl[&#60;TBL.&#34;ID&#34;&#62;+1,2],&#60;TBL.&#34;CD&#34;&#62;);&#13;&#10;      SetFirmUserRepParam(mas_tbl[&#60;TBL.&#34;ID&#34;&#62;+1,3],&#60;TBL.&#34;NM&#34;&#62;);&#13;&#10;      SetFirmUserRepParam(mas_tbl[&#60;TBL.&#34;ID&#34;&#62;+1,4],IntToStr(&#60;TBL.&#34;PRZ&#34;&#62;));&#13;&#10;      TBL.Next;&#13;&#10;    end;&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button18OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  str_vogrp:='';&#13;&#10;  str_vogrp:=TVO3.GetVo();&#13;&#10;  masgrp[ListBox1.ItemIndex+1] := TVO3.GetGr();&#13;&#10;  massiv[ListBox1.ItemIndex+1]:=str_vogrp;&#13;&#10;  SetFirmUserRepParam(m[ListBox1.ItemIndex+1], massiv[ListBox1.ItemIndex+1]);&#13;&#10;  SetFirmUserRepParam(m1[ListBox1.ItemIndex+1], massividx[ListBox1.ItemIndex+1]);&#13;&#10;  SetFirmUserRepParam(m2[ListBox1.ItemIndex+1],masgrp[ListBox1.ItemIndex+1]);&#13;&#10;  TBL.First;&#13;&#10;  while not TBL.Eof do&#13;&#10;    begin&#13;&#10;      If &#60;TBL.&#34;ID&#34;&#62;=ListBox1.ItemIndex then&#13;&#10;        begin&#13;&#10;          TBL.Edit;&#13;&#10;          TBL.FieldByName('PRZ').Value:=1;&#13;&#10;          TBL.Post;&#13;&#10;          break;&#13;&#10;        end;&#13;&#10;      TBL.Next;&#13;&#10;    end;&#13;&#10;  _CheckStayOK(); // 29/07/10 14:07 CDN (442368)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GRPVOOnActivate(Sender: TfrxComponent);&#13;&#10;var strv:String;&#13;&#10;begin&#13;&#10;  massiv[ListBox1.ItemIndex+1]:=GetFirmUserRepParam(m[ListBox1.ItemIndex+1]);&#13;&#10;  masgrp[ListBox1.ItemIndex+1]:=GetFirmUserRepParam(m2[ListBox1.ItemIndex+1]);&#13;&#10;  str_vogrp:=GetFirmUserRepParam(m[ListBox1.ItemIndex+1]);&#13;&#10;  strv := '';&#13;&#10;  SPRVO.First;&#13;&#10;  while not SPRVO.Eof do&#13;&#10;    begin&#13;&#10;      strv := strv + IntToStr(&#60;SPRVO.&#34;SPR_CD&#34;&#62;)+',';&#13;&#10;      SPRVO.Next;&#13;&#10;    end;&#13;&#10;  strv := Copy(strv,1,Length(strv)-1);&#13;&#10;  TVO3.SetFilterVo(strv);&#13;&#10;  TVO3.FillSpr();&#13;&#10;  TVO3.SetVo(massiv[ListBox1.ItemIndex+1]);&#13;&#10;  TVO3.SetGr(masgrp[ListBox1.ItemIndex+1]);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button17OnClick(Sender: TfrxComponent);&#13;&#10;var formGVO:integer;&#13;&#10;var sql_vo:string;&#13;&#10;begin&#13;&#10;  DTUP  := EncodeDate(YearOf(IncMonth(datn,Combobox1.ItemIndex)),MonthOf(IncMonth(datn,Combobox1.ItemIndex)),1);&#13;&#10;  DTUP1  := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),1);&#13;&#10;  LDTUP := EncodeDate(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex)),DaysInMonth(YearOf(IncMonth(datn,Combobox2.ItemIndex)),MonthOf(IncMonth(datn,Combobox2.ItemIndex))));&#13;&#10;  If CheckBox5.Checked then&#13;&#10;    begin&#13;&#10;      sql_vo:='SELECT PayVo1.Vo_CdChr,PspR.Spr_Nm,PspR.Spr_Cd'+&#13;&#10;      ' FROM PayVo1'+&#13;&#10;      ' INNER JOIN PspR ON PayVo1.Vo_Cd=PspR.Spr_Cd'+&#13;&#10;      ' AND PspR.SprSpr_Cd = 787202'+&#13;&#10;      ' INNER JOIN'+&#13;&#10;      ' ( SELECT DISTINCT RVo.Rl_CdVo'+&#13;&#10;      ' FROM ( SELECT RlVo.Rl_CdVo,SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt)}) as Sm'+&#13;&#10;      ' FROM PayRlDo1 RlVo'+&#13;&#10;      ' WHERE RlVo.PayRld_Dat = :DT'+&#13;&#10;      ' GROUP BY RlVo.Rl_CdVo'+&#13;&#10;      ' HAVING SUM({fn CONVERT(Rl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt1)})&#60;&#62;0'+&#13;&#10;      ' ) RVo ) BB ON PayVo1.Vo_Cd = BB.Rl_CdVo'+&#13;&#10;      ' ORDER BY PayVo1.Vo_Grp,PayVo1.Vo_CdChrS';&#13;&#10;      SPRVO.SQL.TEXT:=sql_vo;&#13;&#10;      DTUP:=DateEdit1.Date;&#13;&#10;      SPRVO.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SPRVO.ParamByName('DT').Value:=DTUP;&#13;&#10;      SPRVO.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt1').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt').Value:=ValMt;&#13;&#10;      SPRVO.ParamByName('mt1').Value:=ValMt;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      sql_vo:='SELECT PayVo1.Vo_CdChr,PspR.Spr_Nm,PspR.Spr_Cd'+&#13;&#10;      ' FROM PayVo1'+&#13;&#10;      ' INNER JOIN PspR ON PayVo1.Vo_Cd=PspR.Spr_Cd'+&#13;&#10;      ' AND PspR.SprSpr_Cd = 787202'+&#13;&#10;      ' INNER JOIN ('+&#13;&#10;      ' SELECT DISTINCT RVo.KpuRl_CdVo'+&#13;&#10;      ' FROM'+&#13;&#10;      ' ( SELECT RlVo.KpuRl_CdVo,SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt)}) as Sm'+&#13;&#10;      ' FROM KpuRlo1 RlVo'+&#13;&#10;      ' WHERE RlVo.KpuRl_DatUp BETWEEN :DT AND :DT1'+&#13;&#10;// 22/07/10 10:34 CDN { (438240)&#13;&#10;      ' and { fn MOD( { fn TRUNCATE( RlVo.kpurl_prz / 65536,  0 ) }, 2 ) } =  0'+&#13;&#10;// 22/07/10 10:34 CDN } (438240)&#13;&#10;      ' GROUP BY RlVo.KpuRl_CdVo'+&#13;&#10;      ' HAVING SUM({fn CONVERT(KpuRl_Sm,SQL_DECIMAL)})/({fn POWER(10,:mt1)})&#60;&#62;0'+&#13;&#10;      ' ) RVo ) BB ON PayVo1.Vo_Cd = BB.KPuRl_CdVo'+&#13;&#10;      ' ORDER BY PayVo1.Vo_Grp,PayVo1.Vo_CdChrS';&#13;&#10;      SPRVO.SQL.TEXT:=sql_vo;&#13;&#10;      SPRVO.ParamByName('DT').DataType:=ftDate;&#13;&#10;      SPRVO.ParamByName('DT1').DataType:=ftDate;&#13;&#10;      SPRVO.ParamByName('DT').Value:=DTUP;&#13;&#10;      SPRVO.ParamByName('DT1').Value:=DTUP1;&#13;&#10;      SPRVO.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt1').DataType:=ftInteger;&#13;&#10;      SPRVO.ParamByName('mt').Value:=ValMt;&#13;&#10;      SPRVO.ParamByName('mt1').Value:=ValMt;&#13;&#10;    end;&#13;&#10;  formGVO := TfrxDialogPage(GRPVO).ShowModal;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo15OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sld_nch:=sld_nch+Value;&#13;&#10;  sld_nch1:=sld_nch1+Value;&#13;&#10;  If Value=0 then&#13;&#10;  Memo15.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo16OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sld_udr:=sld_udr+Value;&#13;&#10;  sld_udr1:=sld_udr1+Value;&#13;&#10;  If Value=0 then&#13;&#10;  Memo16.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo17OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sld_out:=sld_out+Value;&#13;&#10;  sld_out1:=sld_out1+Value;&#13;&#10;  If Value=0 then&#13;&#10;  Memo17.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo18OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo18.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo23OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo23.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo20OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo20.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo24OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo24.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo21OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo21.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo25OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo25.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo22OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo22.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo31OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Value=0 then&#13;&#10;  Memo31.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CheckBox5OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If CheckBox5.Checked=True then&#13;&#10;    begin&#13;&#10;      DateEdit1.Enabled:=True;&#13;&#10;      ComboBox1.Enabled:=False;&#13;&#10;      ComboBox2.Enabled:=False;&#13;&#10;      CheckBox1.Checked:=False;&#13;&#10;      CheckBox1.Enabled:=False;&#13;&#10;      CheckBox8.Enabled:=False;&#13;&#10;      CheckBox8.Checked:=False;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      DateEdit1.Enabled:=False;&#13;&#10;      ComboBox1.Enabled:=True;&#13;&#10;      ComboBox2.Enabled:=True;&#13;&#10;      CheckBox1.Enabled:=True;&#13;&#10;      CheckBox8.Enabled:=True;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo34OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If ( RadioButton1.Checked ) AND ( CheckBox9.Checked = False ) then&#13;&#10;    begin&#13;&#10;      Memo34.Text:='По предприятию';&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      If CheckBox4.Checked=False then&#13;&#10;        begin&#13;&#10;          If CheckBox9.Checked then&#13;&#10;            begin&#13;&#10;              BPRO.F_SYSSTE_GET(  0,  &#60;TN.&#34;SPRPDR_PD&#34;&#62;, BPRO.SCBN_STR1 , BPRO.SCBN_STR2, 1);&#13;&#10;              Memo34.Text:=&#60;TN.&#34;SPRPDR_PD&#34;&#62;+' '+BPRO.SCBN_STR1.Value;&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Memo34.Text:=&#60;TN.&#34;SPRPDR_PD&#34;&#62;+' '+&#60;TN.&#34;SPRPDR_NM&#34;&#62;;&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          If CheckBox9.Checked then&#13;&#10;            begin&#13;&#10;              Memo34.Text:='По структурным единицам';&#13;&#10;            end&#13;&#10;          Else&#13;&#10;            begin&#13;&#10;              Memo34.Text:='По подразделениям';&#13;&#10;            end;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo43OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If (&#60;VO.&#34;VO_NUR&#34;&#62;=0) and (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=0) then&#13;&#10;    begin&#13;&#10;      Memo43.Text:=&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else If (&#60;VO.&#34;VO_NUR&#34;&#62;=1) or (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=1) then&#13;&#10;    begin&#13;&#10;      Memo43.Text:='* '+&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Memo43.Text:=&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo65OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000 then&#13;&#10;    begin&#13;&#10;// 06.02.2007 СОИД 110752 Оптимизация ========================&#13;&#10;//      SM.Close;&#13;&#10;//      SM.ParamByName('mt').Value:=ValMt;&#13;&#10;//      SM.ParamByName('tn').Value:=&#60;Query1.&#34;KPU_TN&#34;&#62;;&#13;&#10;//      SM.ParamByName('vo').Value:=&#60;VO.&#34;SPR_CD&#34;&#62;;&#13;&#10;//      SM.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;//      SM.Open;&#13;&#10;//      SM.Filtered := False;&#13;&#10;//      SM.Filter := 'KPU_TN ='+IntToStr(&#60;Query1.&#34;KPU_TN&#34;&#62;)+' AND VO_CD='+IntToStr(&#60;VO.&#34;SPR_CD&#34;&#62;);&#13;&#10;//      SM.Filtered := True;&#13;&#10;// ============================================================&#13;&#10;//      If &#60;SM.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;//        begin&#13;&#10;//          Memo65.Text:=FormatFloat('0.00',&#60;SM.&#34;KPURL_SM&#34;&#62;);&#13;&#10;//          massm[&#60;VO.&#34;SPR_CD&#34;&#62;]:=massm[&#60;VO.&#34;SPR_CD&#34;&#62;]+&#60;SM.&#34;KPURL_SM&#34;&#62;;&#13;&#10;//          massm1[&#60;VO.&#34;SPR_CD&#34;&#62;]:=massm1[&#60;VO.&#34;SPR_CD&#34;&#62;]+&#60;SM.&#34;KPURL_SM&#34;&#62;;&#13;&#10;//        end;&#13;&#10;        If &#60;QSM.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;          begin&#13;&#10;            Memo65.Text:=FormatFloat('0.00',&#60;QSM.&#34;KPURL_SM&#34;&#62;)+' ';&#13;&#10;            massm[&#60;VO.&#34;SPR_CD&#34;&#62;]:=massm[&#60;VO.&#34;SPR_CD&#34;&#62;]+&#60;QSM.&#34;KPURL_SM&#34;&#62;;&#13;&#10;            massm1[&#60;VO.&#34;SPR_CD&#34;&#62;]:=massm1[&#60;VO.&#34;SPR_CD&#34;&#62;]+&#60;QSM.&#34;KPURL_SM&#34;&#62;;&#13;&#10;          end;&#13;&#10;      QSM.Next;&#13;&#10;    end;&#13;&#10;// Признак группы&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;    begin&#13;&#10;      SMGRP.Close;&#13;&#10;      SMGRP.SQL.Text:=strsmgrp;&#13;&#10;      SMGRP.SQL.Add('and payvo1.vo_cd in ('+massiv[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+')');&#13;&#10;      SMGRP.ParamByName('tn').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('mt').DataType:=ftInteger;&#13;&#10;      SMGRP.ParamByName('DT').DataType:=ftDate;&#13;&#10;//      SMGRP.ParamByName('DT1').DataType:=ftDate; VDG 03/03/2008&#13;&#10;      SMGRP.ParamByName('tn').Value:=&#60;TN.&#34;KPU_TN&#34;&#62;;&#13;&#10;      SMGRP.ParamByName('mt').Value:=ValMt;&#13;&#10;      SMGRP.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;      SMGRP.Open;&#13;&#10;      If &#60;SMGRP.&#34;KPURL_SM&#34;&#62;&#60;&#62;0 then&#13;&#10;        begin&#13;&#10;          Memo65.Text:=FormatFloat('0.00',&#60;SMGRP.&#34;KPURL_SM&#34;&#62;)+' ';&#13;&#10;          mgrp[&#60;VO.&#34;SPR_CD&#34;&#62;+1]:=mgrp[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+&#60;SMGRP.&#34;KPURL_SM&#34;&#62;;&#13;&#10;          mgrp1[&#60;VO.&#34;SPR_CD&#34;&#62;+1]:=mgrp1[&#60;VO.&#34;SPR_CD&#34;&#62;+1]+&#60;SMGRP.&#34;KPURL_SM&#34;&#62;;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  // Синхронность датасетов Query1 (работники), VO ( виды оплат )  и QSM - СУММЫ&#13;&#10;  // При разрушении синхронной навигации суммы потеряют актуальность!!!!!!!&#13;&#10;  //QSM.Next;  // VDG 18/06/2009&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo71OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;    begin&#13;&#10;      Memo71.Text:=FormatFloat('0.00',mgrp1[&#60;VO.&#34;SPR_CD&#34;&#62;+1]);&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo57OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If &#60;VO.&#34;VO_MET&#34;&#62;=2000 then&#13;&#10;    begin&#13;&#10;      Memo57.Text:=FormatFloat('0.00',mgrp[&#60;VO.&#34;SPR_CD&#34;&#62;+1]);&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo67OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sld_nch:=sld_nch+Value;&#13;&#10;  sld_nch1:=sld_nch1+Value;&#13;&#10;  If Value=0 then&#13;&#10;  Memo67.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo68OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sld_udr:=sld_udr+Value;&#13;&#10;  sld_udr1:=sld_udr1+Value;&#13;&#10;  If Value=0 then&#13;&#10;  Memo68.Text:='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData4OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  nu:=0;&#13;&#10;  ud:=0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData4OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  QNCH.Close;&#13;&#10;  QNCH.ParamByName('mt').Value:=ValMt;&#13;&#10;  QNCH.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;  //QNCH.ParamByName('DTBEG').Value:=EncodeDate(YearOf(DateEdit1.Date),MonthOf(DateEdit1.Date),01);&#13;&#10;  QNCH.ParamByName('tn').Value:=&#60;TN.&#34;Kpu_Tn&#34;&#62;;&#13;&#10;  QNCH.First;&#13;&#10;  QUDR.Close;&#13;&#10;  QUDR.ParamByName('mt').Value:=ValMt;&#13;&#10;  QUDR.ParamByName('DT').Value:=DateEdit1.Date;&#13;&#10;  //QUDR.ParamByName('DTBEG').Value:=EncodeDate(YearOf(DateEdit1.Date),MonthOf(DateEdit1.Date),01);&#13;&#10;  QUDR.ParamByName('tn').Value:=&#60;TN.&#34;Kpu_Tn&#34;&#62;;&#13;&#10;  QUDR.First;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo12OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Memo12.Text:=' '+BPRO.GETSHORTFIO(&#60;TN.&#34;kpu_fio&#34;&#62;);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData2OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData6OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Trw1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Trw1.Rescan;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Trw1OnKeyDown(Sender: TfrxComponent; var Key: Word; Shift: Integer);&#13;&#10;begin&#13;&#10;  If Shift = 2 Then&#13;&#10;    Begin&#13;&#10;      Case Key Of&#13;&#10;        Ord( '+' ), VK_ADD:&#13;&#10;          Begin&#13;&#10;            Trw1.SelectAll(true);&#13;&#10;          End;&#13;&#10;        Ord( '-' ), VK_SUBTRACT:&#13;&#10;          Begin&#13;&#10;            Trw1.SelectAll(false);&#13;&#10;          End;&#13;&#10;      End;&#13;&#10;    End&#13;&#10;  Else&#13;&#10;  If Key = 32 Then&#13;&#10;    Begin&#13;&#10;      Trw1OnClick(Sender);&#13;&#10;    End;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Trw1OnKeyUp(Sender: TfrxComponent; var Key: Word; Shift: Integer);&#13;&#10;begin&#13;&#10;  // Отметка пробелом&#13;&#10;  If Key=32 then&#13;&#10;    begin&#13;&#10;      Trw1OnClick(Sender);&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CheckBox7OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If CheckBox7.Checked = True Then&#13;&#10;    Begin&#13;&#10;      Trw1.IncSub := True;&#13;&#10;    End&#13;&#10;  Else&#13;&#10;    Begin&#13;&#10;      Trw1.IncSub := False;&#13;&#10;    End;&#13;&#10;  Trw1.SetFocus;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo61OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If (&#60;VO.&#34;VO_NUR&#34;&#62;=0) and (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=0) then&#13;&#10;    begin&#13;&#10;      Memo61.Text:=&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else If (&#60;VO.&#34;VO_NUR&#34;&#62;=1) or (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=1) then&#13;&#10;    begin&#13;&#10;      Memo61.Text:='* '+&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Memo61.Text:=&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo78OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If (&#60;VO.&#34;VO_NUR&#34;&#62;=0) and (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=0) then&#13;&#10;    begin&#13;&#10;      Memo78.Text:=&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else If (&#60;VO.&#34;VO_NUR&#34;&#62;=1) or (NVL(&#60;VO.&#34;VO_MET&#34;&#62;)=1) then&#13;&#10;    begin&#13;&#10;      Memo78.Text:='* '+&#60;VO.&#34;VO_CDCHR&#34;&#62;+' '+&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Memo78.Text:=&#60;VO.&#34;SPR_NM&#34;&#62;;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  TN.First;&#13;&#10;  If TN.Eof then&#13;&#10;    begin&#13;&#10;      showmessage('Отчет пуст');&#13;&#10;      StopCloseReport;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      If VO.Eof then&#13;&#10;        begin&#13;&#10;          showmessage('Отчет пуст');&#13;&#10;          StopCloseReport;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If ComboBox1.ItemIndex &#62; ComboBox2.ItemIndex then&#13;&#10;    begin&#13;&#10;      ComboBox1.ItemIndex := ComboBox2.ItemIndex;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox2OnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If ComboBox1.ItemIndex &#62; ComboBox2.ItemIndex then&#13;&#10;    begin&#13;&#10;      ComboBox1.ItemIndex := ComboBox2.ItemIndex;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button20OnClick(Sender: TfrxComponent);&#13;&#10;var str_Se,SteCdS,str_Sel :String;&#13;&#10;var k:integer;&#13;&#10;begin&#13;&#10;  Str_Se := '';&#13;&#10;  SteCdS := '';&#13;&#10;  Str_Sel:= '';&#13;&#10;  Str_Se := Str_Se+'SELECT PayAccSE.PayAcc_SE'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'FROM PayAccSE'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'WHERE PayAccSE.PayAcc_Role = 0'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'AND PayAccSE.PayAcc_Usr = '+IntToStr(BPRO.USER_RCD.Value)+Chr(13);&#13;&#10;  Str_Se := Str_Se+'AND PayAccSE.PayAcc_IsKdr=0'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'UNION ALL'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'SELECT PayAccSE.PayAcc_SE'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'FROM PayAccSE'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'WHERE PayAccSE.PayAcc_Role = 1'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'AND PayAcc_IsKdr=0'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'AND PayAccSE.PayAcc_Usr'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'IN ('+Chr(13);&#13;&#10;  Str_Se := Str_Se+'     SELECT UserRole_Rcd'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'     FROM UserToRole'+Chr(13);&#13;&#10;  Str_Se := Str_Se+'     WHERE User_Rcd = '+IntToStr(BPRO.USER_RCD.Value)+Chr(13);&#13;&#10;  Str_Se := Str_Se+      'AND UserRole_Firm = '+IntToStr(GetCargoVal( 'BPI_CDFIRM' ))+Chr(13);&#13;&#10;  Str_Se := Str_Se+'   )'+Chr(13);&#13;&#10;&#13;&#10;  Str_Sel := Str_Sel+'SELECT {fn LTRIM({fn RTRIM(PayRepC_Nm)})} PayRepC_Nm'+Chr(13);&#13;&#10;  Str_Sel := Str_Sel+'FROM PayRepC'+Chr(13);&#13;&#10;  Str_Sel := Str_Sel+'WHERE PayRepC_CdTbl  = 181'+Chr(13);&#13;&#10;  Str_Sel := Str_Sel+'AND PayRepC_IdRep = 0'+Chr(13);&#13;&#10;  Str_Sel := Str_Sel+'AND PayRepC_CdUsr = '+IntToStr(GetStationCd())+Chr(13);&#13;&#10;&#13;&#10;  SteCd := BPRO.F_STEDLG_FLT('PayAcc_SE',Str_Se,1,'PayRepC_Nm',Str_Sel);&#13;&#10;  k := 0;&#13;&#10;  qDelSte.Close;&#13;&#10;  qDelSte.ExecSQL;&#13;&#10;  If SteCd&#60;&#62;'' then&#13;&#10;    begin&#13;&#10;      SYSSTE.Close;&#13;&#10;      SYSSTE.SQL.TEXT := strsqlSe;&#13;&#10;      SYSSTE.SQL.Add('WHERE SysSte_Cd IN ('+SteCd+')');&#13;&#10;      SYSSTE.First;&#13;&#10;      WHILE NOT SYSSTE.EOF do&#13;&#10;        begin&#13;&#10;          k := k + 1;&#13;&#10;          qInsSte.Close;&#13;&#10;          qInsSte.ParamByName('cdusr').Value := GetStationCd();&#13;&#10;          qInsSte.ParamByName('p1').Value := k;&#13;&#10;          qInsSte.ParamByName('p2').Value := k;&#13;&#10;          qInsSte.ParamByName('p3').Value := k;&#13;&#10;          qInsSte.ParamByName('cdpd').Value := &#60;SYSSTE.&#34;SYSSTE_CD&#34;&#62;;&#13;&#10;          qInsSte.ExecSQL;&#13;&#10;          SYSSTE.Next;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  If SteCd = '' then&#13;&#10;    begin&#13;&#10;      Button1.Enabled:=False;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button1.Enabled:=True;&#13;&#10;    end;&#13;&#10;  SetFirmUserRepParam('SE',SteCd);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CheckBox9OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If CheckBox9.Checked then&#13;&#10;    begin&#13;&#10;      Button20.Enabled := True;&#13;&#10;      RadioButton1.Enabled := False;&#13;&#10;      RadioButton1.Checked :=True;&#13;&#10;      RadioButton2.Enabled := False;&#13;&#10;      Button3.Enabled := False;&#13;&#10;      CheckBox4.Enabled := True;&#13;&#10;      CheckBox4.Caption := 'Формировать один отчет на выбранные структурные единицы';&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      Button20.Enabled := False;&#13;&#10;      RadioButton1.Enabled := True;&#13;&#10;      RadioButton2.Enabled := True;&#13;&#10;      Button3.Enabled := False;&#13;&#10;      If RadioButton1.Checked=True then&#13;&#10;        begin&#13;&#10;          Button3.Enabled:=False;&#13;&#10;          CheckBox4.Enabled:=False;&#13;&#10;        end&#13;&#10;      Else&#13;&#10;        begin&#13;&#10;          Button3.Enabled:=True;&#13;&#10;          CheckBox4.Enabled:=True;&#13;&#10;        end;&#13;&#10;      CheckBox4.Caption := 'Формировать один отчет на выбранные подразделения';&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Header3.Visible := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupHeader2OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Header4.Visible := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupFooter2OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Header4.Visible := False;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  LIC:=YearOf(Date())-1950;&#13;&#10;  LIC1:=YearOf(BPRO.CUR_UP().Value)-1950;&#13;&#10;  MT.First;&#13;&#10;  If MT.Eof=False then&#13;&#10;&#13;&#10;    begin&#13;&#10;      ValMt:=&#60;MT.&#34;SVL_ACC&#34;&#62;;&#13;&#10;    end&#13;&#10;  Else&#13;&#10;    begin&#13;&#10;      ValMt:=1;&#13;&#10;    end;&#13;&#10;  t_rec1:=1;&#13;&#10;  t_rec2:=1;&#13;&#10;  y:=0;&#13;&#10;  For z:=1 to 256 do&#13;&#10;    begin&#13;&#10;      y:=y+1;&#13;&#10;      ss:='w'+IntToStr(y);&#13;&#10;      mas_save[z]:=ss;&#13;&#10;    end;&#13;&#10;  y:=0;&#13;&#10;  For z:=1 to 256 do&#13;&#10;    begin&#13;&#10;      y:=y+1;&#13;&#10;      ss1:='ww'+IntToStr(y);&#13;&#10;      mas_save1[z]:=ss1;&#13;&#10;    end;&#13;&#10;  y:=0;&#13;&#10;  For z:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      y:=y+1;&#13;&#10;      hh:='DFG'+IntToStr(y);&#13;&#10;      m[z]:=hh;&#13;&#10;    end;&#13;&#10;  y:=0;&#13;&#10;  For z:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      y:=y+1;&#13;&#10;      hh1:='GFD'+IntToStr(y);&#13;&#10;      m1[z]:=hh1;&#13;&#10;    end;&#13;&#10;  y:=0;&#13;&#10;  For z:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      y:=y+1;&#13;&#10;      hh1:='MFD'+IntToStr(y);&#13;&#10;      m2[z]:=hh1;&#13;&#10;    end;&#13;&#10;  For z:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      For i:=1 to 4 do&#13;&#10;        begin&#13;&#10;          y:=y+1;&#13;&#10;          xxx:='RFR'+IntToStr(y);&#13;&#10;          mas_tbl[z,i]:=xxx;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  str_sqlvo:='';&#13;&#10;  strsmgrp:=SMGRP.SQL.TEXT;&#13;&#10;  strsmgrpr:=SMRGRP.SQL.TEXT;&#13;&#10;  TBL.AddField('ID','INT',0);        // СА группы&#13;&#10;  TBL.AddField('NM','STRING',150);   // Наименование&#13;&#10;  TBL.AddField('CD','STRING',150);   // Код&#13;&#10;  TBL.AddField('PRZ','INT',0);       // Признак : 0 - пустая группа, 1 - вкллючены виды оплат&#13;&#10;  TBL.CreateDataSet;&#13;&#10;  For i:=1 to 1024 do&#13;&#10;    begin&#13;&#10;      If GetFirmUserRepParam(mas_tbl[i,1])&#60;&#62;'' then&#13;&#10;        begin&#13;&#10;          TBL.Insert;&#13;&#10;          TBL.FieldByName('ID').Value:=StrToInt(GetFirmUserRepParam(mas_tbl[i,1]));&#13;&#10;          TBL.FieldByName('CD').Value:=GetFirmUserRepParam(mas_tbl[i,2]);&#13;&#10;          TBL.FieldByName('NM').Value:=GetFirmUserRepParam(mas_tbl[i,3]);;&#13;&#10;          TBL.FieldByName('PRZ').Value:=StrToInt(GetFirmUserRepParam(mas_tbl[i,4]));&#13;&#10;          TBL.Post;&#13;&#10;          // 29.08.2007 wolf ================================================================================&#13;&#10;          // Не зачитывалась настройка групп ВО&#13;&#10;          massiv[TBL.FieldByName('ID').Value+1] := GetFirmUserRepParam(m[TBL.FieldByName('ID').Value+1]);&#13;&#10;          // ================================================================================================&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  str_vo:=GetFirmUserRepParam('VO');&#13;&#10;  str_gr:=GetFirmUserRepParam('GR');&#13;&#10;  str_pd:=GetFirmUserRepParam('PD');&#13;&#10;  inc_pd:=GetFirmUserRepParam('INC_PD');&#13;&#10;  flg_act:=0;&#13;&#10;  StrPdrSql:='select podr.sprpdr_rcd,podr.sprpdr_pd,podr.sprpdr_nmfull,podr.sprpdr_dt'+&#13;&#10;  ' from sprpdr podr'+&#13;&#10;  ' where podr.sprpdr_dt=(select max(p.sprpdr_dt)'+&#13;&#10;  ' from sprpdr p where p.sprpdr_dt&#60;= :DT )'+&#13;&#10;  ' and podr.sprpdr_flg=0';&#13;&#10;  TN.AddField('KPU_TN','LARGEINT',0);&#13;&#10;  TN.AddField('KPU_FIO','STRING',50);&#13;&#10;  TN.AddField('KPU_FIOSRT','STRING',25);&#13;&#10;  TN.AddField('SPRPDR_POS','STRING',50);&#13;&#10;  TN.AddField('SPRPDR_PD','STRING',50);&#13;&#10;  TN.AddField('SPRPDR_NM','STRING',250);&#13;&#10;  TN.AddField('KPURL_SIN','FLOAT',12);&#13;&#10;  TN.AddField('KPURL_NCH','FLOAT',12);&#13;&#10;  TN.AddField('KPURL_UDR','FLOAT',12);&#13;&#10;  TN.AddField('KPURL_SOUT','FLOAT',12);&#13;&#10;  TN.AddStringField('MVZ',10);&#13;&#10;  TN.AddStringField('CEH',20);&#13;&#10;  TN.CreateDataSet;&#13;&#10;  TN.AddIndex('INDEX1','KPU_FIOSRT+STR(KPU_TN,10)');&#13;&#10;  TN.AddIndex('INDEX2','SPRPDR_POS+KPU_FIOSRT+STR(KPU_TN,10)');&#13;&#10;  TN.AddIndex('INDEX3','SPRPDR_POS+STR(KPU_TN,10)');&#13;&#10;  TN.AddIndex('INDEX4','STR(KPU_TN,10)');&#13;&#10;  str_Query1 := '';&#13;&#10;  BPRO.SET_LANGUAGE('RU');&#13;&#10;  strsqlSe := SYSSTE.SQL.TEXT;&#13;&#10;  SteCd := GetFirmUserRepParam('SE');&#13;&#10;end.">
  <Datasets>
    <item DataSet="MT" DataSetName="MT"/>
    <item DataSet="SPRVO" DataSetName="SPRVO"/>
    <item DataSet="PDR" DataSetName="PDR"/>
    <item DataSet="Query1" DataSetName="Query1"/>
    <item DataSet="VO" DataSetName="VO"/>
    <item DataSet="QSM" DataSetName="QSM"/>
    <item DataSet="VAL" DataSetName="VAL"/>
    <item DataSet="RP" DataSetName="RP"/>
    <item DataSet="QSMRP" DataSetName="QSMRP"/>
    <item DataSet="QNCH" DataSetName="QNCH"/>
    <item DataSet="QUDR" DataSetName="QUDR"/>
    <item DataSet="TBL" DataSetName="TBL"/>
    <item DataSet="SMGRP" DataSetName="SMGRP"/>
    <item DataSet="SMRGRP" DataSetName="SMRGRP"/>
    <item DataSet="PDRACC" DataSetName="PDRACC"/>
    <item DataSet="TNACC" DataSetName="TNACC"/>
    <item DataSet="TN" DataSetName="TN"/>
    <item DataSet="TBL1" DataSetName="TBL1"/>
    <item DataSet="T" DataSetName="T"/>
    <item DataSet="qDat" DataSetName="qDat"/>
    <item DataSet="qInsSte" DataSetName="qInsSte"/>
    <item DataSet="qDelSte" DataSetName="qDelSte"/>
    <item DataSet="SYSSTE" DataSetName="SYSSTE"/>
    <item DataSet="MVZ_CEH" DataSetName="MVZ_CEH"/>
  </Datasets>
  <Variables>
    <item Name=" Бест-Звит" Value="True"/>
    <item Name="ZvitPeriodType" Value="0"/>
    <item Name="ZvitCharCode" Value="0"/>
    <item Name="ZvitPeriodDate" Value="0"/>
  </Variables>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="3000">
    <TfrxODBCQuery Name="MT" UserName="MT" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text=" --Точность валюты для KPURL&#13;&#10;select svl_acc&#13;&#10;from crtfrm2&#13;&#10;inner join svl on crtfrm_val=svl_rcd" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674023C0470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="SPRVO" UserName="SPRVO" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674027C0470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="PDR" UserName="PDR" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC000470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="Query1" UserName="Query1" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403FC000470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="VO" UserName="VO" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674033C010470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="QSM" UserName="QSM" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674037C010470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="VAL" UserName="VAL" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select svl_rcd,svl_cd&#13;&#10;from svl&#13;&#10;where svl_rcd=(select crtfrm_val from crtfrm2)" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC010470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="RP" UserName="RP" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select kpurlo1.kpurl_datrp&#13;&#10;from kpurlo1&#13;&#10;where kpurlo1.kpu_tn=:tn&#13;&#10;and kpurlo1.kpurl_datup between :DT and :DT1&#13;&#10;--and kpurlo1.kpurl_sm&#60;&#62;0&#13;&#10;group by kpurlo1.kpurl_datrp&#13;&#10;order by kpurlo1.kpurl_datrp" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403FC010470546F7002140A506172616D657465727301010C61000000204E616D653D22746E222044617461547970653D2266744C61726765696E742220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D22262336303B544E2E262333343B6B70755F746E262333343B262336323B2200010C44000000204E616D653D224454222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D22445455502200010C46000000204E616D653D22445431222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D224454555031220000"/>
    <TfrxODBCQuery Name="QSMRP" UserName="QSMRP" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select sum({fn convert(kpurlo1.kpurl_Sm,SQL_DECIMAL)})/({fn Power(10,:mt)}) as kpurl_Sm,kpu_tn,kpurl_cdvo as vo_cd,&#13;&#10;kpurl_datrp&#13;&#10;from kpurlo1&#13;&#10;where kpurlo1.kpurl_datup between :DT and :DT1&#13;&#10;and { fn MOD( { fn TRUNCATE( kpurlo1.kpurl_prz / 65536,  0 ) }, 2 ) }=0&#13;&#10;group by kpu_tn,kpurl_cdvo,kpurl_datrp" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674023C0470546F700398000A506172616D657465727301010C48000000204E616D653D226D74222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D2256616C4D742200010C44000000204E616D653D224454222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D22445455502200010C45000000204E616D653D22445431222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D2244545550220000"/>
    <TfrxODBCQuery Name="QNCH" UserName="QNCH" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674027C0470546F700398000A506172616D65746572730100"/>
    <TfrxODBCQuery Name="QUDR" UserName="QUDR" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC000470546F700398000A506172616D65746572730100"/>
    <TfrxDBFTable Name="TBL" UserName="TBL" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" Storage="stoMemory" OpenMode="omTemporary" TableLevel="dbfxBaseIV" PropData="05704C656674023C0470546F700254"/>
    <TfrxODBCQuery Name="SMGRP" UserName="SMGRP" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674027C0470546F7002540A506172616D65746572730100"/>
    <TfrxODBCQuery Name="SMRGRP" UserName="SMRGRP" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select sum({fn convert(kpurlo1.kpurl_Sm,SQL_DECIMAL)})/({fn Power(10,:mt)}) as kpurl_Sm&#13;&#10;from kpurlo1&#13;&#10;inner join payvo1 on kpurlo1.kpurl_cdvo=payvo1.vo_cd&#13;&#10;where kpurlo1.kpu_tn=:tn&#13;&#10;and kpurlo1.kpurl_datup between :DT and :DT1&#13;&#10;and kpurlo1.kpurl_datrp=:DTRP&#13;&#10;and { fn MOD( { fn TRUNCATE( kpurlo1.kpurl_prz / 65536,  0 ) }, 2 ) }=0" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC000470546F7002540A506172616D657465727301010C35000000204E616D653D226D74222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C36000000204E616D653D22746E222044617461547970653D2266744C61726765696E742220506172616D547970653D227074556E6B6E6F776E2200010C32000000204E616D653D224454222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E2200010C33000000204E616D653D22445431222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E2200010C34000000204E616D653D2244545250222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E220000"/>
    <TfrxODBCQuery Name="PDRACC" UserName="PDRACC" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select PayAcc_Pdr&#13;&#10;from PayAccP&#13;&#10;where PayAcc_Role = 0&#13;&#10;and PayAcc_Usr = :PayAcc_Usr&#13;&#10;and PayAcc_IsKdr=0&#13;&#10;union all&#13;&#10;select PayAcc_Pdr&#13;&#10;from PayAccP&#13;&#10;where PayAcc_Role = 1&#13;&#10;and PayAcc_IsKdr=0&#13;&#10;and PayAcc_Usr&#13;&#10;in (&#13;&#10;     select userrole_rcd&#13;&#10;     from usertorole&#13;&#10;     where user_rcd = :PayAcc_Usr1&#13;&#10;     and userrole_firm = :CdFirm&#13;&#10;   )" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403FC000470546F7002540A506172616D657465727301010C5E000000204E616D653D225061794163635F557372222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D224250524F2E555345525F5243442E56616C75652200010C5F000000204E616D653D225061794163635F55737231222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D224250524F2E555345525F5243442E56616C75652200010C4C000000204E616D653D2243644669726D222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D22436446726D220000"/>
    <TfrxODBCQuery Name="TNACC" UserName="TNACC" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="SELECT PayAcc_TnOt,PayAcc_TnDo&#13;&#10;FROM PayAccT&#13;&#10;WHERE PayAcc_Role = 0&#13;&#10;AND PayAcc_IsKdr=0&#13;&#10;AND PayAcc_Usr = :PayAcc_Usr&#13;&#10;UNION ALL&#13;&#10;SELECT PayAcc_TnOt,PayAcc_TnDo&#13;&#10;FROM PayAccT&#13;&#10;WHERE PayAcc_Role = 1&#13;&#10;AND PayAcc_IsKdr=0&#13;&#10;AND PayAcc_Usr&#13;&#10;IN (&#13;&#10;     SELECT userrole_rcd&#13;&#10;     FROM  usertorole&#13;&#10;     WHERE user_rcd = :PayAcc_Usr1&#13;&#10;     AND userrole_firm = :CdFirm&#13;&#10;   )" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674033C010470546F7002540A506172616D657465727301010C5E000000204E616D653D225061794163635F557372222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D224250524F2E555345525F5243442E56616C75652200010C5F000000204E616D653D225061794163635F55737231222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D224250524F2E555345525F5243442E56616C75652200010C4C000000204E616D653D2243644669726D222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D22436446726D220000"/>
    <TfrxDBFTable Name="TN" UserName="TN" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" Storage="stoMemory" OpenMode="omTemporary" TableLevel="dbfxBaseVII" PropData="05704C656674037C010470546F700254"/>
    <TfrxDBFTable Name="TBL1" UserName="TBL1" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" Storage="stoMemory" OpenMode="omTemporary" TableLevel="dbfxBaseIV" PropData="05704C65667403BC010470546F700254"/>
    <TfrxDBFTable Name="T" UserName="T" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" Storage="stoMemory" OpenMode="omTemporary" TableLevel="dbfxBaseIV" PropData="05704C65667403FC010470546F700254"/>
    <TfrxODBCQuery Name="qDat" UserName="qDat" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="SELECT MIN(KpuRl_DatUp) DatN&#13;&#10;FROM KpuRlo1" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403FC000470546F700398000A506172616D65746572730100"/>
    <TfrxODBCQuery Name="qInsSte" UserName="qInsSte" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="INSERT INTO PayRepC &#13;&#10;(PayRepC_CdTbl,PayRepC_IdRep,PayRepC_CdUsr,PayRepC_CdPrm,PayRepC_Cd,PayRepC_CdPar,PayRepC_Nm)&#13;&#10;VALUES(181,0,:cdusr,:p1,:p2,:p3,:cdpd)  " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674023C0470546F7003DC000A506172616D657465727301010C38000000204E616D653D226364757372222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C35000000204E616D653D227031222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C35000000204E616D653D227032222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C35000000204E616D653D227033222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C36000000204E616D653D2263647064222044617461547970653D226674537472696E672220506172616D547970653D227074556E6B6E6F776E220000"/>
    <TfrxODBCQuery Name="qDelSte" UserName="qDelSte" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="DELETE FROM PayRepC&#13;&#10;WHERE PayRepC_CdTbl  = 181                  &#13;&#10;AND PayRepC_IdRep = 0   &#13;&#10;AND PayRepC_CdUsr = :cdusr  " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674027C0470546F7003DC000A506172616D657465727301010C54000000204E616D653D226364757372222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E222045787072657373696F6E3D2247657453746174696F6E43642829220000"/>
    <TfrxODBCQuery Name="SYSSTE" UserName="SYSSTE" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="SELECT SysSte_Cd,SysSte_Nm,SysSte_Rcd,SysSte_EDR          &#13;&#10;FROM SysSte  " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC000470546F7003DC000A506172616D65746572730100"/>
    <TfrxODBCQuery Name="MVZ_CEH" UserName="MVZ_CEH" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="Select KpuPrk1.KpuPrkz_Pd as ceh,                   &#13;&#10;(select SysSprZtt_KrCd from SYSSPRZTT  where kpuprk1.KpuPrkz_MVZ = SYSSPRZTT.SysSprZtt_Rcd) mvz&#13;&#10;  &#13;&#10;from kpuprk1 &#13;&#10;where kpuprk1.bookmark = ( select max(p1.bookmark) &#13;&#10;       from kpuprk1 p1&#13;&#10;       where p1.kpu_rcd =(select top 1 kpu_rcd from kpux where kpu_tn=:kpu_tn)  &#13;&#10;       and p1.kpuprkz_dtv = (select max(p2.kpuprkz_dtv)&#13;&#10;                       from kpuprk1 p2 &#13;&#10;                       where p2.kpu_rcd = (select top 1 kpu_rcd from kpux where kpu_tn=:kpu_tn)  &#13;&#10;                        and p2.kpuprkz_dtv &#60;= :LDT ))    " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674033C010470546F700398000A506172616D657465727301010C39000000204E616D653D226B70755F746E222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D226B70755F746E222044617461547970653D226674496E74656765722220506172616D547970653D227074556E6B6E6F776E2200010C33000000204E616D653D224C4454222044617461547970653D226674446174652220506172616D547970653D227074556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="5" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" EndlessWidth="true" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="200,31509" Left="0" Top="18,89765" Width="1065,82746" OnAfterPrint="GroupHeader1OnAfterPrint" OnBeforePrint="GroupHeader1OnBeforePrint" Condition="TN.&#34;sprpdr_pd&#34;" StartNewPage="true" Stretched="true">
      <TfrxMemoView Name="Memo1" Left="7,55906" Top="3,77953" Width="332,59864" Height="41,57483" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="2" ParentFont="false" Text="[BPRO.PRED_CM_NMF.Value]"/>
      <TfrxMemoView Name="Memo2" Align="baCenter" Left="338,267935" Top="45,35436" Width="389,29159" Height="18,89765" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-15" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р РђРЎР§Р•РўРќРђРЇ Р’Р•Р”РћРњРћРЎРўР¬ Р—РђР РђР‘РћРўРќРћР™ РџР›РђРўР«"/>
      <TfrxMemoView Name="Memo3" Left="3,77953" Top="60,47248" Width="506,45702" Height="30,23624" OnAfterData="Memo3OnAfterData" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo4" Left="3,77953" Top="94,48825" Width="268,34663" Height="18,89765" OnAfterData="Memo4OnAfterData" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo42" Left="0" Top="147,40167" Width="37,7953" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="в„– Рї/Рї"/>
      <TfrxMemoView Name="Memo44" Left="37,7953" Top="147,40167" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РўР°Р±. в„–"/>
      <TfrxMemoView Name="Memo52" Left="170,07885" Top="147,40167" Width="136,06308" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¤.Р.Рћ."/>
      <TfrxMemoView Name="Memo58" Left="306,14193" Top="147,40167" Width="75,5906" Height="52,91338583" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЎР°Р»СЊРґРѕ РЅР° РЅР°С‡Р°Р»Рѕ"/>
      <TfrxMemoView Name="Memo61" Left="600,94527" Top="147,40167" Width="68,03148874" Height="52,91342" OnAfterData="Memo61OnAfterData" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo66" Left="529,1342" Top="147,40167" Width="71,81107" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЎР°Р»СЊРґРѕ РЅР° РєРѕРЅРµС†"/>
      <TfrxMemoView Name="Memo69" Left="381,73253" Top="147,40167" Width="71,81107" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РќР°С‡РёСЃР»РµРЅРѕ"/>
      <TfrxMemoView Name="Memo72" Left="453,5436" Top="147,40167" Width="75,5906" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЈРґРµСЂР¶Р°РЅРѕ"/>
      <TfrxMemoView Name="Memo81" Left="3,77953" Top="124,72449" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" VAlign="vaCenter" Text="[Date]      Р›РёСЃС‚ [Page#]"/>
      <TfrxMemoView Name="Memo85" Left="90,70872" Top="147,40167" Width="26,45671" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¦РµС…"/>
      <TfrxMemoView Name="Memo86" Left="117,16543" Top="147,40167" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РњР’Р—"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="98,2677678" Left="0" Top="457,32313" Width="1065,82746" OnAfterPrint="GroupFooter1OnAfterPrint">
      <TfrxMemoView Name="Memo19" Left="0" Top="0" Width="306,14193" Height="15,87401575" DataSet="Query1" DataSetName="Query1" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=" Р’РЎР•Р“Рћ РџРћ Р’Р•Р”РћРњРћРЎРўР:"/>
      <TfrxMemoView Name="Memo26" Left="7,55906" Top="41,57483" Width="332,59864" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RK_DOL.Value]"/>
      <TfrxMemoView Name="Memo27" Left="7,55906" Top="75,5906" Width="332,59864" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RF_DOL.Value]"/>
      <TfrxMemoView Name="Memo28" Left="343,93723" Top="41,57483" Width="173,85838" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RK_FIO.Value]"/>
      <TfrxMemoView Name="Memo29" Left="343,93723" Top="75,5906" Width="173,85838" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RF_FIO.Value]"/>
      <TfrxMemoView Name="Memo53" Left="600,94527" Top="0" Width="68,03148874" Height="15,87401575" OnAfterData="Memo53OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[IIF((&#60;VO.&#34;SPR_CD&#34;&#62;&#60;=1024) and (&#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000),massm[&#60;VO.&#34;SPR_CD&#34;&#62;],'')] "/>
      <TfrxMemoView Name="Memo23" Left="306,14193" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo23OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_in] "/>
      <TfrxMemoView Name="Memo24" Left="381,73253" Top="0" Width="71,81107" Height="15,87401575" OnAfterData="Memo24OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_nch] "/>
      <TfrxMemoView Name="Memo25" Left="453,5436" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo25OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_udr] "/>
      <TfrxMemoView Name="Memo31" Left="529,1342" Top="0" Width="71,81107" Height="15,87401575" OnAfterData="Memo31OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_out] "/>
    </TfrxGroupFooter>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="15,87401575" Left="0" Top="343,93723" Width="1065,82746" OnAfterPrint="MasterData1OnAfterPrint" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="TN" DataSetName="TN" PrintChildIfInvisible="true" PrintIfDetailEmpty="true" RowCount="0">
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="37,7953" Height="15,87401575" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo11" Left="37,7953" Top="0" Width="52,91342" Height="15,87401575" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;kpu_tn&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="170,07885" Top="0" Width="136,06308" Height="15,87401575" OnAfterData="Memo12OnAfterData" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo54" Left="600,94527" Top="0" Width="68,03148874" Height="15,87401575" OnAfterData="Memo54OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo14" Left="306,14193" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo14OnAfterData" DataSet="Query1" DataSetName="Query1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;KpuRl_Sin&#34;] "/>
      <TfrxMemoView Name="Memo15" Left="381,73253" Top="0" Width="71,81107" Height="15,87401575" OnAfterData="Memo15OnAfterData" DataSet="Query1" DataSetName="Query1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;KpuRl_Nch&#34;] "/>
      <TfrxMemoView Name="Memo16" Left="453,5436" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo16OnAfterData" DataSet="Query1" DataSetName="Query1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;KpuRl_Udr&#34;] "/>
      <TfrxMemoView Name="Memo17" Left="529,1342" Top="0" Width="71,81107" Height="15,87401575" OnAfterData="Memo17OnAfterData" DataSet="Query1" DataSetName="Query1" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;KpuRl_Sout&#34;] "/>
      <TfrxMemoView Name="Memo89" Left="90,70872" Top="0" Width="26,45671" Height="15,87401575" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;CEH&#34;]"/>
      <TfrxMemoView Name="Memo90" Left="117,16543" Top="0" Width="52,91342" Height="15,87401575" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;MVZ&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="718,1107" Left="0" Top="0" Vertical="true" Width="600,94527"/>
    <TfrxMasterData Name="MasterData3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="15,87401575" Left="0" Top="419,52783" Visible="false" Width="1065,82746" OnAfterPrint="MasterData3OnAfterPrint" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo30" Left="0" Top="0" Width="306,14193" Height="15,87401575" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=" Р’РЎР•Р“Рћ РџРћ Р›РРЎРўРЈ:"/>
      <TfrxMemoView Name="Memo55" Left="600,94527" Top="0" Width="68,03148874" Height="15,87401575" OnAfterData="Memo55OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[IIF((&#60;VO.&#34;SPR_CD&#34;&#62;&#60;=1024) and (&#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000),massm1[&#60;VO.&#34;SPR_CD&#34;&#62;],'')] "/>
      <TfrxMemoView Name="Memo18" Left="306,14193" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo18OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_in1] "/>
      <TfrxMemoView Name="Memo20" Left="381,73253" Top="0" Width="71,81107" Height="15,87401575" OnAfterData="Memo20OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_nch1] "/>
      <TfrxMemoView Name="Memo21" Left="453,5436" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo21OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_udr1] "/>
      <TfrxMemoView Name="Memo22" Left="529,1342" Top="0" Width="71,81107" Height="15,87401575" OnAfterData="Memo22OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_out1] "/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="15,87401575" Left="0" Top="381,73253" Width="1065,82746" ColumnWidth="0" ColumnGap="0" DataSet="RP" DataSetName="RP" PrintChildIfInvisible="true" PrintIfDetailEmpty="true" RowCount="0">
      <TfrxMemoView Name="Memo35" Left="0" Top="0" Width="600,94527" Height="15,87401575" StretchMode="smMaxHeight" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text="     -  [MY(&#60;RP.&#34;KPURL_DATRP&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo56" Left="600,94527" Top="0" Width="68,03148874" Height="15,87401575" OnAfterData="Memo56OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text=""/>
    </TfrxDetailData>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="718,1107" Left="600,94527" Top="0" Vertical="true" Width="68,03154" OnAfterPrint="MasterData2OnAfterPrint" OnBeforePrint="MasterData2OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="VO" DataSetName="VO" PrintChildIfInvisible="true" PrintIfDetailEmpty="true" RowCount="0"/>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="718,1107" Left="668,97681" Top="0" Vertical="true" Width="0"/>
    <TfrxHeader Name="Header3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="79,37013" Left="0" Top="241,88992" Visible="false" Width="1065,82746" OnBeforePrint="Header3OnBeforePrint" ReprintOnNewPage="true" Stretched="true">
      <TfrxMemoView Name="Memo5" Left="0" Top="26,45671" Width="37,7953" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="в„– Рї/Рї"/>
      <TfrxMemoView Name="Memo6" Left="37,7953" Top="26,45671" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РўР°Р±. в„–"/>
      <TfrxMemoView Name="Memo7" Left="170,07885" Top="26,45671" Width="136,06308" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¤.Р.Рћ."/>
      <TfrxMemoView Name="Memo8" Left="306,14193" Top="26,45671" Width="75,5906" Height="52,91338583" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЎР°Р»СЊРґРѕ РЅР° РЅР°С‡Р°Р»Рѕ"/>
      <TfrxMemoView Name="Memo36" Left="600,94527" Top="26,45671" Width="68,03148874" Height="52,91342" OnAfterData="Memo36OnAfterData" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo37" Left="529,1342" Top="26,45671" Width="71,81107" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЎР°Р»СЊРґРѕ РЅР° РєРѕРЅРµС†"/>
      <TfrxMemoView Name="Memo9" Left="381,73253" Top="26,45671" Width="71,81107" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РќР°С‡РёСЃР»РµРЅРѕ"/>
      <TfrxMemoView Name="Memo13" Left="453,5436" Top="26,45671" Width="75,5906" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЈРґРµСЂР¶Р°РЅРѕ"/>
      <TfrxMemoView Name="Memo82" Left="3,77953" Top="3,77952999999999" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" VAlign="vaCenter" Text="[Date]      Р›РёСЃС‚ [Page#]"/>
      <TfrxMemoView Name="Memo87" Left="90,70872" Top="26,45671" Width="26,45671" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¦РµС…"/>
      <TfrxMemoView Name="Memo88" Left="117,16543" Top="26,45671" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РњР’Р—"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="Page2" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Microsoft Sans Serif" Font.Style="0" BorderStyle="bsDialog" Caption="Расчетно-платежная ведомость на дату" Height="533" ClientHeight="494" Left="381" Top="134" Width="539" ClientWidth="523" OnActivate="Page2OnActivate" OnCloseQuery="Page2OnCloseQuery">
    <TfrxButtonControl Name="Button1" Left="376" Top="476" Width="75" Height="23" ShowHint="true" Caption="ОК" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="456" Top="476" Width="75" Height="23" ShowHint="true" Caption="Отмена" ModalResult="2" OnClick="Button2OnClick"/>
    <TfrxBevelControl Name="Bevel1" Left="8" Top="36" Width="522" Height="2" ShowHint="true"/>
    <TfrxRadioButtonControl Name="RadioButton1" Left="8" Top="44" Width="113" Height="19" ShowHint="true" Caption="По предприятию" TabStop="false" Color="15461355" OnClick="RadioButton1OnClick"/>
    <TfrxRadioButtonControl Name="RadioButton2" Left="8" Top="72" Width="129" Height="19" ShowHint="true" Caption="По подразделениям" TabStop="false" Color="15461355" OnClick="RadioButton2OnClick"/>
    <TfrxButtonControl Name="Button3" Left="380" Top="68" Width="151" Height="23" ShowHint="true" Caption="Выбор подразделений..." OnClick="Button3OnClick"/>
    <TfrxLabelControl Name="Label2" Left="8" Top="172" Width="132" Height="16" ShowHint="true" AutoSize="false" Caption="Включать виды оплат:" Color="-2147483633"/>
    <TfrxPanelControl Name="Panel1" Left="8" Top="188" Width="129" Height="57" ShowHint="true" BevelOuter="bvNone" Color="-2147483633">
      <TfrxRadioButtonControl Name="RadioButton3" Left="0" Top="4" Width="53" Height="19" ShowHint="true" Caption="Все" TabStop="false" Color="15461355" OnClick="RadioButton3OnClick"/>
      <TfrxRadioButtonControl Name="RadioButton4" Left="0" Top="32" Width="85" Height="19" ShowHint="true" Caption="Выборочно" TabStop="false" Color="15461355" OnClick="RadioButton4OnClick"/>
    </TfrxPanelControl>
    <TfrxButtonControl Name="Button4" Left="260" Top="220" Width="135" Height="23" ShowHint="true" Caption="Виды оплат..." OnClick="Button4OnClick"/>
    <TfrxBevelControl Name="Bevel3" Left="8" Top="248" Width="522" Height="2" ShowHint="true"/>
    <TfrxCheckBoxControl Name="CheckBox1" Left="8" Top="256" Width="377" Height="19" ShowHint="true" Caption="Виды оплат выводятся в разрезе периодов, за которые расчитаны" Color="15461355"/>
    <TfrxCheckBoxControl Name="CheckBox2" Left="8" Top="280" Width="393" Height="19" ShowHint="true" Caption="Отображать записи, которые не входят в сумму Начислено/Удержано" Color="15461355"/>
    <TfrxCheckBoxControl Name="CheckBox3" Left="8" Top="304" Width="281" Height="19" ShowHint="true" Caption="Учитывать поле № п/п в платежной ведомости" Color="15461355"/>
    <TfrxBevelControl Name="Bevel4" Left="8" Top="388" Width="522" Height="2" ShowHint="true"/>
    <TfrxLabelControl Name="Label3" Left="8" Top="396" Width="100" Height="16" ShowHint="true" AutoSize="false" Caption="Сортировать по:" Color="-2147483633"/>
    <TfrxPanelControl Name="Panel2" Left="8" Top="412" Width="113" Height="49" ShowHint="true" BevelOuter="bvNone" Color="-2147483633">
      <TfrxRadioButtonControl Name="RadioButton5" Left="0" Top="4" Width="105" Height="19" ShowHint="true" Caption="Фамилии, И. О." TabStop="false" Color="15461355"/>
      <TfrxRadioButtonControl Name="RadioButton6" Left="0" Top="28" Width="101" Height="19" ShowHint="true" Caption="Таб. номеру" TabStop="false" Color="15461355"/>
    </TfrxPanelControl>
    <TfrxBevelControl Name="Bevel5" Left="8" Top="464" Width="522" Height="2" ShowHint="true"/>
    <TfrxCheckBoxControl Name="CheckBox4" Left="8" Top="104" Width="517" Height="19" ShowHint="true" Caption="Формировать один отчет на все подразделения" Color="15461355"/>
    <TfrxButtonControl Name="Button11" Left="400" Top="220" Width="131" Height="23" ShowHint="true" Caption="Группы..." OnClick="Button11OnClick"/>
    <TfrxCheckBoxControl Name="CheckBox5" Left="344" Top="8" Width="65" Height="19" ShowHint="true" Caption="На дату:" Color="15461355" OnClick="CheckBox5OnClick"/>
    <TfrxDateEditControl Name="DateEdit1" Left="412" Top="8" Width="117" Height="21" ShowHint="true" DateFormat="dfShort" Date="38994" Time="38994,588650081" Color="-2147483643"/>
    <TfrxBevelControl Name="Bevel11" Left="8" Top="128" Width="522" Height="2" ShowHint="true"/>
    <TfrxCheckBoxControl Name="CheckBox6" Left="8" Top="328" Width="325" Height="19" ShowHint="true" Caption="Отображать работников только с &#34;ненулевыми&#34; суммами" Color="15461355"/>
    <TfrxCheckBoxControl Name="CheckBox8" Left="8" Top="352" Width="417" Height="13" ShowHint="true" Caption="Включать работников, у которых отсутствует движение по РЛ," Color="15461355"/>
    <TfrxLabelControl Name="Label6" Left="24" Top="368" Width="304" Height="13" ShowHint="true" AutoSize="false" Caption="но присутствует сальдо" Color="-16777201"/>
    <TfrxBevelControl Name="Bevel13" Left="8" Top="164" Width="522" Height="2" ShowHint="true"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="8" Top="8" Width="145" Height="21" ShowHint="true" Color="-16777211" Items.Text="" Style="csDropDownList" ItemIndex="-1" OnChange="ComboBox1OnChange"/>
    <TfrxLabelControl Name="Label1" Left="158" Top="12" Width="8" Height="13" ShowHint="true" AutoSize="false" Caption="-" Color="-16777201"/>
    <TfrxComboBoxControl Name="ComboBox2" Left="172" Top="8" Width="145" Height="21" ShowHint="true" Color="-16777211" Items.Text="" Style="csDropDownList" ItemIndex="-1" OnChange="ComboBox2OnChange"/>
    <TfrxCheckBoxControl Name="CheckBox9" Left="8" Top="136" Width="169" Height="19" ShowHint="true" Caption="По структурным единицам" Color="15461355" OnClick="CheckBox9OnClick"/>
    <TfrxButtonControl Name="Button20" Left="380" Top="136" Width="151" Height="23" ShowHint="true" Caption="Структурные единицы..." OnClick="Button20OnClick"/>
    <TfrxBevelControl Name="Bevel2" Left="8" Top="96" Width="522" Height="2" ShowHint="true"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="FPD" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Microsoft Sans Serif" Font.Style="0" Caption="Структурные подразделения" Height="289" ClientHeight="250" Left="385" Top="123" Width="362" ClientWidth="346" OnActivate="FPDOnActivate" OnResize="FPDOnResize">
    <TfrxBevelControl Name="Bevel6" Left="8" Top="164" Width="330" Height="2" ShowHint="true"/>
    <TfrxButtonControl Name="Button5" Left="184" Top="212" Width="75" Height="23" ShowHint="true" Caption="ОК" ModalResult="1" OnClick="Button5OnClick"/>
    <TfrxButtonControl Name="Button6" Left="264" Top="212" Width="75" Height="23" ShowHint="true" Caption="Отмена" ModalResult="2"/>
    <TfrxCheckBoxControl Name="CheckBox7" Left="8" Top="176" Width="269" Height="17" ShowHint="true" Caption="Включать подчиненные подразделения" Color="15461355" OnClick="CheckBox7OnClick"/>
    <TfrxBevelControl Name="Bevel12" Left="8" Top="200" Width="330" Height="2" ShowHint="true"/>
    <TfrIntPdr Name="Trw1" Anchors="15" Left="8" Top="8" Width="329" Height="145" ShowHint="true" IncSub="false" CdFirm="0" CdUser="0" UseAccess="false" IsKdr="false" IsOsn="false" OnClick="Trw1OnClick" OnKeyDown="Trw1OnKeyDown" OnKeyUp="Trw1OnKeyUp" Color="-16777211"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="FVO" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Microsoft Sans Serif" Font.Style="0" Caption="Виды оплат" Height="251" ClientHeight="212" Left="343" Top="151" Width="363" ClientWidth="347" OnActivate="FVOOnActivate">
    <TfrxBevelControl Name="Bevel7" Anchors="13" Left="8" Top="168" Width="330" Height="2" ShowHint="true"/>
    <TfrxButtonControl Name="Button7" Anchors="12" Left="184" Top="176" Width="75" Height="23" ShowHint="true" Caption="ОК" ModalResult="1" OnClick="Button7OnClick"/>
    <TfrxButtonControl Name="Button8" Anchors="12" Left="264" Top="176" Width="75" Height="23" ShowHint="true" Caption="Отмена" ModalResult="2"/>
    <TfrIntVo Name="TVo1" Anchors="15" Left="8" Top="8" Width="329" Height="153" ShowHint="true" Color="-16777211"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="GRP" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Microsoft Sans Serif" Font.Style="0" BorderStyle="bsDialog" Caption="Группы" Height="238" ClientHeight="199" Left="313" Top="152" Width="403" ClientWidth="387" OnActivate="GRPOnActivate">
    <TfrxBevelControl Name="Bevel8" Left="8" Top="160" Width="370" Height="2" ShowHint="true"/>
    <TfrxButtonControl Name="Button9" Left="224" Top="168" Width="75" Height="23" ShowHint="true" Caption="ОК" ModalResult="1" OnClick="Button9OnClick"/>
    <TfrxButtonControl Name="Button10" Left="304" Top="168" Width="75" Height="23" ShowHint="true" Caption="Отмена" ModalResult="2"/>
    <TfrxButtonControl Name="Button12" Left="276" Top="8" Width="103" Height="23" ShowHint="true" Caption="Создать..." OnClick="Button12OnClick"/>
    <TfrxButtonControl Name="Button13" Left="276" Top="40" Width="103" Height="23" ShowHint="true" Caption="Редактировать..." OnClick="Button13OnClick"/>
    <TfrxButtonControl Name="Button14" Left="276" Top="72" Width="103" Height="23" ShowHint="true" Caption="Удалить..." OnClick="Button14OnClick"/>
    <TfrxListBoxControl Name="ListBox1" Left="8" Top="4" Width="261" Height="145" ShowHint="true" Color="-2147483643" Items.Text=""/>
    <TfrxButtonControl Name="Button17" Left="276" Top="104" Width="103" Height="23" ShowHint="true" Caption="Выбор ВО..." OnClick="Button17OnClick"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="CRT" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Microsoft Sans Serif" Font.Style="0" BorderStyle="bsDialog" Height="166" ClientHeight="127" Left="312" Top="142" Width="317" ClientWidth="301" OnActivate="CRTOnActivate">
    <TfrxEditControl Name="Edit1" Left="40" Top="4" Width="89" Height="21" ShowHint="true" Color="-2147483643" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label4" Left="8" Top="32" Width="124" Height="16" ShowHint="true" AutoSize="false" Caption="Наименование группы:" Color="-2147483633"/>
    <TfrxLabelControl Name="Label5" Left="8" Top="8" Width="32" Height="16" ShowHint="true" AutoSize="false" Caption="Код:" Color="-2147483633"/>
    <TfrxEditControl Name="Edit2" Left="8" Top="52" Width="281" Height="21" ShowHint="true" Color="-2147483643" MaxLength="0" PasswordChar="0"/>
    <TfrxBevelControl Name="Bevel9" Left="8" Top="80" Width="282" Height="2" ShowHint="true"/>
    <TfrxButtonControl Name="Button15" Left="136" Top="92" Width="75" Height="23" ShowHint="true" Caption="ОК" ModalResult="1" OnClick="Button15OnClick"/>
    <TfrxButtonControl Name="Button16" Left="216" Top="92" Width="75" Height="23" ShowHint="true" Caption="Отмена" ModalResult="2"/>
  </TfrxDialogPage>
  <TfrxDialogPage Name="GRPVO" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Выбор видов оплат" Height="252" ClientHeight="213" Left="300" Top="142" Width="364" ClientWidth="348" OnActivate="GRPVOOnActivate">
    <TfrxBevelControl Name="Bevel10" Anchors="13" Left="8" Top="168" Width="330" Height="2" ShowHint="true"/>
    <TfrxButtonControl Name="Button18" Anchors="12" Left="184" Top="180" Width="75" Height="23" ShowHint="true" Caption="ОК" ModalResult="1" OnClick="Button18OnClick"/>
    <TfrxButtonControl Name="Button19" Anchors="12" Left="264" Top="180" Width="75" Height="23" ShowHint="true" Caption="Отмена" ModalResult="2"/>
    <TfrIntVo Name="TVO3" Anchors="15" Left="8" Top="8" Width="329" Height="153" ShowHint="true" Color="-16777211"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page3" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="1" TopMargin="10" BottomMargin="3" ColumnWidth="0" ColumnPositions.Text="" EndlessWidth="true" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page3OnBeforePrint">
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="204,09462" Left="0" Top="18,89765" Width="1080,94558" OnAfterPrint="GroupHeader2OnAfterPrint" OnBeforePrint="GroupHeader1OnBeforePrint" Condition="Query1.&#34;sprpdr_pd&#34;" StartNewPage="true" Stretched="true">
      <TfrxMemoView Name="Memo32" Left="7,55906" Top="3,77953" Width="332,59864" Height="41,57483" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="2" ParentFont="false" Text="[BPRO.PRED_CM_NMF.Value]"/>
      <TfrxMemoView Name="Memo33" Left="15,11812" Top="49,13389" Width="430,86642" Height="18,89765" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="false" Text="Р РђРЎР§Р•РўРќРђРЇ Р’Р•Р”РћРњРћРЎРўР¬ Р—РђР РђР‘РћРўРќРћР™ РџР›РђРўР«"/>
      <TfrxMemoView Name="Memo34" Left="3,77953" Top="75,5906" Width="442,20501" Height="30,23624" OnAfterData="Memo34OnAfterData" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="false" Text=""/>
      <TfrxMemoView Name="Memo38" Left="3,77953" Top="113,3859" Width="442,20501" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="false" Text="[DT_STR(DateEdit1.Date)]"/>
      <TfrxMemoView Name="Memo39" Left="0" Top="151,1812" Width="41,57483" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="в„– Рї/Рї"/>
      <TfrxMemoView Name="Memo40" Left="41,57483" Top="151,1812" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РўР°Р±. в„–"/>
      <TfrxMemoView Name="Memo41" Left="173,85838" Top="151,1812" Width="196,53556" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¤.Р.Рћ."/>
      <TfrxMemoView Name="Memo43" Left="529,1342" Top="151,1812" Width="86,92919" Height="52,91342" OnAfterData="Memo43OnAfterData" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo45" Left="370,39394" Top="151,1812" Width="75,5906" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РќР°С‡РёСЃР»РµРЅРѕ"/>
      <TfrxMemoView Name="Memo46" Left="445,98454" Top="151,1812" Width="83,14966" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЈРґРµСЂР¶Р°РЅРѕ"/>
      <TfrxMemoView Name="Memo83" Left="3,77953" Top="132,28355" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" VAlign="vaCenter" Text="[Date]      Р›РёСЃС‚ [Page#]"/>
      <TfrxMemoView Name="Memo91" Left="94,48825" Top="151,1812" Width="26,45671" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¦РµС…"/>
      <TfrxMemoView Name="Memo92" Left="120,94496" Top="151,1812" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РњР’Р—"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="98,2677678" Left="0" Top="423,30736" Width="1080,94558" OnAfterPrint="GroupFooter2OnAfterPrint">
      <TfrxMemoView Name="Memo47" Left="0" Top="0" Width="370,39394" Height="15,87401575" DataSet="Query1" DataSetName="Query1" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=" Р’РЎР•Р“Рћ РџРћ Р’Р•Р”РћРњРћРЎРўР:"/>
      <TfrxMemoView Name="Memo48" Left="7,55906" Top="37,7953" Width="332,59864" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RK_DOL.Value]"/>
      <TfrxMemoView Name="Memo49" Left="7,55906" Top="71,81107" Width="332,59864" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RF_DOL.Value]"/>
      <TfrxMemoView Name="Memo50" Left="619,84292" Top="37,7953" Width="166,29932" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RK_FIO.Value]"/>
      <TfrxMemoView Name="Memo51" Left="619,84292" Top="71,81107" Width="166,29932" Height="18,89765" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" Text="[BPRO.PRED_RF_FIO.Value]"/>
      <TfrxMemoView Name="Memo57" Left="529,1342" Top="0" Width="86,92919" Height="15,87401575" OnAfterData="Memo57OnAfterData" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[IIF((&#60;VO.&#34;SPR_CD&#34;&#62;&#60;=1024) and (&#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000),massm[&#60;VO.&#34;SPR_CD&#34;&#62;],'')] "/>
      <TfrxMemoView Name="Memo59" Left="370,39394" Top="0" Width="75,5906" Height="15,87401575" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_nch] "/>
      <TfrxMemoView Name="Memo60" Left="445,98454" Top="0" Width="83,14966" Height="15,87401575" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_udr] "/>
    </TfrxGroupFooter>
    <TfrxMasterData Name="MasterData4" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="15,87401575" Left="0" Top="347,71676" Width="1080,94558" OnAfterPrint="MasterData4OnAfterPrint" OnBeforePrint="MasterData4OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="TN" DataSetName="TN" RowCount="0" Stretched="true">
      <TfrxMemoView Name="Memo62" Left="0" Top="0" Width="41,57483" Height="15,87401575" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Line#]."/>
      <TfrxMemoView Name="Memo63" Left="41,57483" Top="0" Width="52,91342" Height="15,87401575" StretchMode="smMaxHeight" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;kpu_tn&#34;]"/>
      <TfrxMemoView Name="Memo64" Left="94,48825" Top="0" Width="275,90569" Height="15,87401575" StretchMode="smMaxHeight" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=" [TN.&#34;kpu_fio&#34;]"/>
      <TfrxMemoView Name="Memo65" Left="529,1342" Top="0" Width="86,92919" Height="15,87401575" OnAfterData="Memo65OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo67" Left="370,39394" Top="0" Width="75,5906" Height="15,87401575" OnAfterData="Memo67OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[QNCH.&#34;NCH&#34;] "/>
      <TfrxMemoView Name="Memo68" Left="445,98454" Top="0" Width="83,14966" Height="15,87401575" OnAfterData="Memo68OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[QUDR.&#34;UDR&#34;] "/>
      <TfrxMemoView Name="Memo93" Left="94,48825" Top="0" Width="26,45671" Height="15,87401575" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;CEH&#34;]"/>
      <TfrxMemoView Name="Memo94" Left="120,94496" Top="0" Width="52,91342" Height="15,87401575" DataSet="Query1" DataSetName="Query1" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[TN.&#34;MVZ&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="744,56741" Left="0" Top="0" Vertical="true" Width="529,1342"/>
    <TfrxMasterData Name="MasterData5" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="15,87401575" Left="0" Top="385,51206" Visible="false" Width="1080,94558" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo70" Left="0" Top="0" Width="370,39394" Height="15,87401575" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=" Р’РЎР•Р“Рћ РџРћ Р›РРЎРўРЈ:"/>
      <TfrxMemoView Name="Memo71" Left="529,1342" Top="0" Width="86,92919" Height="15,87401575" OnAfterData="Memo71OnAfterData" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[IIF((&#60;VO.&#34;SPR_CD&#34;&#62;&#60;=1024) and (&#60;VO.&#34;VO_MET&#34;&#62;&#60;&#62;2000),massm1[&#60;VO.&#34;SPR_CD&#34;&#62;],'')] "/>
      <TfrxMemoView Name="Memo73" Left="370,39394" Top="0" Width="75,5906" Height="15,87401575" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_nch1] "/>
      <TfrxMemoView Name="Memo74" Left="445,98454" Top="0" Width="83,14966" Height="15,87401575" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sld_udr1] "/>
    </TfrxMasterData>
    <TfrxMasterData Name="MasterData6" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="744,56741" Left="529,1342" Top="0" Vertical="true" Width="86,92919" OnAfterPrint="MasterData6OnAfterPrint" ColumnWidth="0" ColumnGap="0" DataSet="VO" DataSetName="VO" RowCount="0"/>
    <TfrxFooter Name="Footer2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="744,56741" Left="616,06339" Top="0" Vertical="true" Width="173,85838"/>
    <TfrxHeader Name="Header4" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="79,37013" Left="0" Top="245,66945" Visible="false" Width="1080,94558" OnBeforePrint="Header4OnBeforePrint" Stretched="true">
      <TfrxMemoView Name="Memo75" Left="0" Top="26,45671" Width="41,57483" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="в„– Рї/Рї"/>
      <TfrxMemoView Name="Memo76" Left="41,57483" Top="26,45671" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РўР°Р±. в„–"/>
      <TfrxMemoView Name="Memo77" Left="173,85838" Top="26,45671" Width="196,53556" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¤.Р.Рћ."/>
      <TfrxMemoView Name="Memo78" Left="529,1342" Top="26,45671" Width="86,92919" Height="52,91342" OnAfterData="Memo78OnAfterData" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo79" Left="370,39394" Top="26,45671" Width="75,5906" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РќР°С‡РёСЃР»РµРЅРѕ"/>
      <TfrxMemoView Name="Memo80" Left="445,98454" Top="26,45671" Width="83,14966" Height="52,91342" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РЈРґРµСЂР¶Р°РЅРѕ"/>
      <TfrxMemoView Name="Memo84" Left="3,77953" Top="3,77953" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" ParentFont="false" VAlign="vaCenter" Text="[Date]      Р›РёСЃС‚ [Page#]"/>
      <TfrxMemoView Name="Memo95" Left="94,48825" Top="26,45671" Width="26,45671" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="Р¦РµС…"/>
      <TfrxMemoView Name="Memo96" Left="120,94496" Top="26,45671" Width="52,91342" Height="52,91342" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-2147483640" Font.Height="-12" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="РњР’Р—"/>
    </TfrxHeader>
  </TfrxReportPage>
</TfrxReport>
