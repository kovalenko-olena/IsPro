<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.4.3" DotMatrixReport="false" IniFile="\Software\Fast Reports" OldStyleProgress="true" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="37883.4385134491" ReportOptions.Description.Text="" ReportOptions.Name="FR ÞÃÎÊ Òåõ. îò÷åò ïî äàòàì ñäà÷è ñ ðàñøèôðîâêîé 12.2022" ReportOptions.LastChange="44903.7005411574" ReportOptions.DirectExportType="deRtf" ReportOptions.DirectExportMode="dmOpen" ReportOptions.DirectExportPages="depSingleSheet" ReportOptions.DirectExportChunkSize="0" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  //AGaiNmr: array[0..100] of integer;&#13;&#10;  y,j,k,flag: integer;&#13;&#10;  Time1,Time2,TimeStr1,TimeStr2,digit,strrcd, plst: string;&#13;&#10;  L_Time1,L_Time2,GSMSAVED,GSMBURNED: integer;&#13;&#10;  TimeR1,TimeR2,TimeR: real;&#13;&#10;  PLst_Spdm: string;&#13;&#10;  countListBox,IndexListBox: integer;&#13;&#10;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  y: integer;&#13;&#10;  plstminmax: string;&#13;&#10;begin&#13;&#10;  Page1.Visible:=false;&#13;&#10;&#13;&#10;  if CheckBox2.Checked then&#13;&#10;  begin&#13;&#10;    SetUserRepParam( 'parammrk' , '1' );&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    SetUserRepParam( 'parammrk' , '0' );&#13;&#10;  end;&#13;&#10;&#13;&#10;  if CheckBox1.Checked then&#13;&#10;  begin&#13;&#10;    SetUserRepParam( 'paramshort' , '1' );&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    SetUserRepParam( 'paramshort' , '0' );&#13;&#10;  end;&#13;&#10;&#13;&#10;&#13;&#10;  strrcd:='';&#13;&#10;  dsMark.first;&#13;&#10;  while not dsMark.eof do&#13;&#10;  begin&#13;&#10;   strrcd:=strrcd+(vartostr(&#60;dsMark.&#34;CODE&#34;&#62;)+',');&#13;&#10;   dsMark.next;&#13;&#10;  end;&#13;&#10;  strrcd:=strrcd+vartostr(&#60;dsMark.&#34;CODE&#34;&#62;);&#13;&#10;&#13;&#10;  PLstQuery.sql.text:='';&#13;&#10;&#13;&#10;  plst:='';&#13;&#10;plst:=plst+'SELECT '+ Chr(13);&#13;&#10;plst:=plst+'  CASE WHEN RIGHT(DB1.CdZakaz,1)='+''''+'*'+''''+' THEN '+ Chr(13);&#13;&#10;plst:=plst+'    CAST(LEFT(DB1.CdZakaz,LEN(DB1.CdZakaz)-1) AS NUMERIC) '+ Chr(13);&#13;&#10;plst:=plst+'  ELSE '+ Chr(13);&#13;&#10;plst:=plst+'    CAST(DB1.CdZakaz AS numeric) '+ Chr(13);&#13;&#10;plst:=plst+'  END AS CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'  DB1.Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'  DB1.CdZakaz AS cd, '+ Chr(13);&#13;&#10;plst:=plst+'  KOL1 AS '''+'ÊÎËÎÍÍÀ1 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10;plst:=plst+'  KOL2 AS '''+'ÊÎËÎÍÍÀ2 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10;plst:=plst+'  KOL3 AS '''+'ÊÎËÎÍÍÀ3 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10;plst:=plst+'  KOL4 AS '''+'ÊÎËÎÍÍÀ4 ÌÎÒÎ×ÀÑÛ'+''' '+ Chr(13);&#13;&#10;plst:=plst+'FROM '+ Chr(13);&#13;&#10;plst:=plst+'  /*ÒÐÀÍÑÏÎÍÈÐÎÂÀÍÈÅ*/ '+ Chr(13);&#13;&#10;plst:=plst+'  (SELECT '+ Chr(13);&#13;&#10;plst:=plst+'     CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'     Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'     SUM([êîëîíà ¹1]) AS KOL1, '+ Chr(13);&#13;&#10;plst:=plst+'     SUM([êîëîíà ¹2]) AS KOL2, '+ Chr(13);&#13;&#10;plst:=plst+'     SUM([êîëîíà ¹3]) AS KOL3, '+ Chr(13);&#13;&#10;plst:=plst+'     SUM([êîëîíà ¹4]) AS KOL4, '+ Chr(13);&#13;&#10;plst:=plst+'     SUM(tkm) AS tkm'+ Chr(13);&#13;&#10;plst:=plst+'   FROM '+ Chr(13);&#13;&#10;plst:=plst+'     (SELECT '+ Chr(13);&#13;&#10;plst:=plst+'        CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'        Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'        Kolonna, '+ Chr(13);&#13;&#10;plst:=plst+'        timmth, '+ Chr(13);&#13;&#10;plst:=plst+'        tkm '+ Chr(13);&#13;&#10;plst:=plst+'      FROM '+ Chr(13);&#13;&#10;plst:=plst+'        (SELECT '+ Chr(13);&#13;&#10;plst:=plst+'           CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'           CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'           PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10;plst:=plst+'           /*çàòðåáîâàííîå âðåìÿ ðàáîòû*/ '+ Chr(13);&#13;&#10;plst:=plst+'           PlPrb_TimWrk AS timmth, '+ Chr(13);&#13;&#10;plst:=plst+'           plst_tkm AS tkm '+ Chr(13);&#13;&#10;plst:=plst+'         FROM PLST '+ Chr(13);&#13;&#10;plst:=plst+'         INNER JOIN UFPRV   ON PLst_Rcd=UF_TblRcd '+ Chr(13);&#13;&#10;plst:=plst+'         INNER JOIN UFRKV   ON UFRKV.UFR_DbRcd=ufprv.UF_TblId and UFRKV.UFR_RkRcd=ufprv.UF_RkRcd '+ Chr(13);&#13;&#10;plst:=plst+'         LEFT JOIN PTNRK    ON ufprv.UF_RkValS = PTNRK.Ptn_CdSrt and UFR_SysSpr=1 '+ Chr(13);&#13;&#10;plst:=plst+'         LEFT JOIN ATPPLPRB ON ATPPLPRB.PlPrb_PLRcd=PLST.PLst_Rcd '+ Chr(13);&#13;&#10;plst:=plst+'         --ïîëå çàêàç÷èê '+ Chr(13);&#13;&#10;plst:=plst+'         WHERE UFRKV.UFR_RkRcd=78 '+ Chr(13);&#13;&#10;plst:=plst+'           and plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10;plst:=plst+'         ) BDZak    /*áàçà çàïîëíåííîãî ïîëÿ çàêàç÷èê*/ '+ Chr(13);&#13;&#10;plst:=plst+''+ Chr(13);&#13;&#10;plst:=plst+'      UNION ALL '+ Chr(13);&#13;&#10;plst:=plst+'      SELECT '+ Chr(13);&#13;&#10;plst:=plst+'        CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'        Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'        Kolonna, '+ Chr(13);&#13;&#10;plst:=plst+'        timmth, '+ Chr(13);&#13;&#10;plst:=plst+'        tkm '+ Chr(13);&#13;&#10;plst:=plst+'      FROM '+ Chr(13);&#13;&#10;plst:=plst+'        (SELECT '+ Chr(13);&#13;&#10;plst:=plst+'           CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'           CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'           PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10;plst:=plst+'           AtpZvs_TimeSF AS timmth, '+ Chr(13);&#13;&#10;plst:=plst+'           0 AS tkm '+ Chr(13);&#13;&#10;plst:=plst+'         FROM ATPZVS '+ Chr(13);&#13;&#10;plst:=plst+'         INNER JOIN PLST ON AtpZvs_PLstRcd=PLst_Rcd '+ Chr(13);&#13;&#10;plst:=plst+'         INNER JOIN PTNRK ON AtpZvs_Ptn=PTNRK.Ptn_Rcd '+ Chr(13);&#13;&#10;plst:=plst+'         WHERE plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10;plst:=plst+'         ) BDZad   /*áàçà ñòðîê çàäàíèé*/ '+ Chr(13);&#13;&#10;plst:=plst+''+ Chr(13);&#13;&#10;plst:=plst+'      UNION ALL '+ Chr(13);&#13;&#10;plst:=plst+'      SELECT '+ Chr(13);&#13;&#10;plst:=plst+'        CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10;plst:=plst+'        CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10;plst:=plst+'	       PLst_ClnNm AS Kolonna,'+ Chr(13);&#13;&#10;plst:=plst+'       	SUM(BDmoto.UF_RkValN) AS timmth,'+ Chr(13);&#13;&#10;plst:=plst+'       	SUM(BDtkm.UF_RkValN) AS tkm'+ Chr(13);&#13;&#10;plst:=plst+'      FROM '+ Chr(13);&#13;&#10;plst:=plst+'        (SELECT U2.UFR_Rcd,UF_TblRcd '+ Chr(13);&#13;&#10;plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10;plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10;plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10;plst:=plst+'         GROUP BY U2.UFR_Rcd,UF_TblRcd)BDrcd /*áàçà áåç ïîâòîðîâ, Rcd ïóòåâûõ ëèñòîâ è Rcd çàïèñåé*/ '+ Chr(13);&#13;&#10;plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10;plst:=plst+'        (SELECT  U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd,UF_RkRcd,UF_RkValS '+ Chr(13);&#13;&#10;plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10;plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10;plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10;plst:=plst+'         ) BDzak     /*áàçà ñòðîêîâûõ çíà÷åíèé, çàêàç÷èê*/ '+ Chr(13);&#13;&#10;plst:=plst+'         ON BDzak.UFR_Rcd=BDrcd.UFR_Rcd and BDzak.UF_TblRcd=BDrcd.UF_TblRcd and UF_RkValS&#60;&#62;'''+''' and BDzak.UF_RkRcd=3 '+ Chr(13);&#13;&#10;plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10;plst:=plst+'        (SELECT   U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN '+ Chr(13);&#13;&#10;plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10;plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10;plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10;plst:=plst+'         ) BDmoto    /*áàçà ÷èñëîâûõ çíà÷åíèé, Rcd=1 ìîòî÷àñû*/ '+ Chr(13);&#13;&#10;plst:=plst+'         ON BDmoto.UFR_Rcd=BDzak.UFR_Rcd and BDmoto.UF_TblRcd=BDzak.UF_TblRcd and BDmoto.UF_RkValN&#60;&#62;0 and BDmoto.UF_RkRcd=1 '+ Chr(13);&#13;&#10;plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10;plst:=plst+'        (SELECT U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN '+ Chr(13);&#13;&#10;plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10;plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10;plst:=plst+''+ Chr(13);&#13;&#10;plst:=plst+'         ) BDtkm   /*áàçà ÷èñëîâûõ çíà÷åíèé,  Rcd=2 òêì*/ '+ Chr(13);&#13;&#10;plst:=plst+'         ON BDtkm.UFR_Rcd=BDzak.UFR_Rcd and BDtkm.UF_TblRcd=BDzak.UF_TblRcd and BDtkm.UF_RkValN &#60;&#62;0 and BDtkm.UF_RkRcd=2 '+ Chr(13);&#13;&#10;plst:=plst+'      INNER JOIN PLST ON BDrcd.UF_TblRcd=PLst_Rcd '+ Chr(13);&#13;&#10;plst:=plst+'      INNER JOIN PTNRK ON UF_RkValS=PTNRK.Ptn_cd '+ Chr(13);&#13;&#10;plst:=plst+'      GROUP BY BDrcd.UF_TblRcd, BDzak.UF_RkValS, '+ Chr(13);&#13;&#10;plst:=plst+'        CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd end, '+ Chr(13);&#13;&#10;plst:=plst+'        CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm end, '+ Chr(13);&#13;&#10;plst:=plst+'        PLst_ClnNm '+ Chr(13);&#13;&#10;plst:=plst+'      )DBreestr /*ñãðóïïèðîâàííàÿ áàçà èç ðååñòðà ïîëüçîâàòåëÿ*/ '+ Chr(13);&#13;&#10;plst:=plst+'         '+ Chr(13);&#13;&#10;plst:=plst+'     PIVOT (SUM(timmth) FOR Kolonna IN '+ Chr(13);&#13;&#10;plst:=plst+'     ([ÊÎËÎÍÀ ¹1],[ÊÎËÎÍÀ ¹2],[ÊÎËÎÍÀ ¹3],[ÊÎËÎÍÀ ¹4])) pvt '+ Chr(13);&#13;&#10;plst:=plst+'     GROUP BY CdZakaz, Zakaz '+ Chr(13);&#13;&#10;plst:=plst+' '+ Chr(13);&#13;&#10;plst:=plst+' )DB1 '+ Chr(13);&#13;&#10;plst:=plst+''+ Chr(13);&#13;&#10;plst:=plst+' ORDER BY '+ Chr(13);&#13;&#10;plst:=plst+'   CASE WHEN RIGHT(DB1.CdZakaz,1)='''+'*'+''' THEN '+ Chr(13);&#13;&#10;plst:=plst+'     CAST(LEFT(DB1.CdZakaz,len(DB1.CdZakaz)-1) AS numeric) '+ Chr(13);&#13;&#10;plst:=plst+'   ELSE '+ Chr(13);&#13;&#10;plst:=plst+'     CAST(DB1.CdZakaz AS numeric) '+ Chr(13);&#13;&#10;plst:=plst+'   END '+ Chr(13);&#13;&#10;  PLstQuery.sql.text:=plst;&#13;&#10;  PLstQuery.close;&#13;&#10;  PLstQuery.open;&#13;&#10;  PLstQuery.First;&#13;&#10;&#13;&#10;  PLstQuery1.sql.text:='';&#13;&#10;&#13;&#10;  plstminmax:='SELECT min(UF_RkValD) AS dmin, max(UF_RkValD) AS dmax'+ Chr(13);&#13;&#10;  plstminmax:=plstminmax+'  FROM PLST '+ Chr(13);&#13;&#10;  plstminmax:=plstminmax+'  INNER JOIN UFPRV   ON PLst_Rcd=UF_TblRcd'+ Chr(13);&#13;&#10;  plstminmax:=plstminmax+'  INNER JOIN UFRKV   ON UFRKV.UFR_DbRcd=ufprv.UF_TblId and UFRKV.UFR_RkRcd=ufprv.UF_RkRcd '+ Chr(13);&#13;&#10;  plstminmax:=plstminmax+'  WHERE UFRKV.UFR_RkRcd=80  '+ Chr(13);&#13;&#10;  plstminmax:=plstminmax+'  AND plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10;  dmindmax.sql.text:=plstminmax;&#13;&#10;  dmindmax.close;&#13;&#10;  dmindmax.open;&#13;&#10;  dmindmax.First;&#13;&#10;&#13;&#10;  if checkbox1.checked=true then&#13;&#10;  begin&#13;&#10;    GroupFooter2.visible:=false;&#13;&#10;    Memo31.visible:=false;&#13;&#10;    Memo34.visible:=false;&#13;&#10;    Memo35.visible:=false;&#13;&#10;    Memo36.visible:=false;&#13;&#10;    Memo5.visible:=false;&#13;&#10;    Memo6.visible:=false;&#13;&#10;    Memo10.visible:=false;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    GroupFooter2.visible:=true;&#13;&#10;    Memo31.visible:=true;&#13;&#10;    Memo34.visible:=true;&#13;&#10;    Memo35.visible:=true;&#13;&#10;    Memo36.visible:=true;&#13;&#10;    Memo5.visible:=true;&#13;&#10;    Memo6.visible:=true;&#13;&#10;    Memo10.visible:=true;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure Page1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Qmindat.open;&#13;&#10;  Qmindat.close;&#13;&#10;&#13;&#10;  if GetUserRepParam( 'parammark')='1' then&#13;&#10;  begin&#13;&#10;    CheckBox2.Checked:=true;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    CheckBox2.Checked:=false;&#13;&#10;  end;&#13;&#10;&#13;&#10;  if GetUserRepParam( 'paramshort')='1' then&#13;&#10;  begin&#13;&#10;    CheckBox1.Checked:=true;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    CheckBox1.Checked:=false;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  StopCloseReport ;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band2OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; if CheckBox2.Checked = False then&#13;&#10; begin&#13;&#10; PLstQuery1.sql.text:='';&#13;&#10;&#13;&#10; plst:='';&#13;&#10;&#13;&#10; plst:=plst+'SELECT '+ Chr(13);&#13;&#10; plst:=plst+'  CASE WHEN RIGHT(DB1.CdZakaz,1)='''+'*'+''' THEN '+ Chr(13);&#13;&#10; plst:=plst+'    CAST(LEFT(DB1.CdZakaz,LEN(DB1.CdZakaz)-1) AS NUMERIC) '+ Chr(13);&#13;&#10; plst:=plst+'  ELSE '+ Chr(13);&#13;&#10; plst:=plst+'    CAST(DB1.CdZakaz AS numeric) '+ Chr(13);&#13;&#10; plst:=plst+'  END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'  DB1.Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'  DB1.CdZakaz AS cd, '+ Chr(13);&#13;&#10; plst:=plst+'  KOL1 AS '''+'ÊÎËÎÍÍÀ1 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10; plst:=plst+'  KOL2 AS '''+'ÊÎËÎÍÍÀ2 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10; plst:=plst+'  KOL3 AS '''+'ÊÎËÎÍÍÀ3 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10; plst:=plst+'  KOL4 AS '''+'ÊÎËÎÍÍÀ4 ÌÎÒÎ×ÀÑÛ'+''','+ Chr(13);&#13;&#10; plst:=plst+'  DB1.UF_TblRcd,'+ Chr(13);&#13;&#10; plst:=plst+'  PLst_Nmr,'+ Chr(13);&#13;&#10; plst:=plst+'  PLst_GNmr,'+ Chr(13);&#13;&#10; plst:=plst+'  PLst_Dat,'+ Chr(13);&#13;&#10; plst:=plst+'  UF_RkValD,'+ Chr(13);&#13;&#10; plst:=plst+'  SG_NM,'+ Chr(13);&#13;&#10; plst:=plst+'  SG_TYPE,'+ Chr(13);&#13;&#10; plst:=plst+'  SPR_NM,'+ Chr(13);&#13;&#10; plst:=plst+'  AVT_GARNMR'+ Chr(13);&#13;&#10; plst:=plst+'FROM '+ Chr(13);&#13;&#10; plst:=plst+'  /*ÒÐÀÍÑÏÎÍÈÐÎÂÀÍÈÅ*/ '+ Chr(13);&#13;&#10; plst:=plst+'  (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'     CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'     Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹1]) AS KOL1, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹2]) AS KOL2, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹3]) AS KOL3, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹4]) AS KOL4, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM(tkm) AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'     UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'   FROM '+ Chr(13);&#13;&#10; plst:=plst+'     (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'        CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'        timmth, '+ Chr(13);&#13;&#10; plst:=plst+'        tkm,'+ Chr(13);&#13;&#10; plst:=plst+'        UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'      FROM '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'           /*çàòðåáîâàííîå âðåìÿ ðàáîòû*/ '+ Chr(13);&#13;&#10; plst:=plst+'           PlPrb_TimWrk AS timmth, '+ Chr(13);&#13;&#10; plst:=plst+'           plst_tkm AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'           UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'         FROM PLST '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN UFPRV   ON PLst_Rcd=UF_TblRcd '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN UFRKV   ON UFRKV.UFR_DbRcd=ufprv.UF_TblId and UFRKV.UFR_RkRcd=ufprv.UF_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN PTNRK    ON ufprv.UF_RkValS = PTNRK.Ptn_CdSrt and UFR_SysSpr=1 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN ATPPLPRB ON ATPPLPRB.PlPrb_PLRcd=PLST.PLst_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'         --ïîëå çàêàç÷èê '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE UFRKV.UFR_RkRcd=78 '+ Chr(13);&#13;&#10; plst:=plst+'           and plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDZak    /*áàçà çàïîëíåííîãî ïîëÿ çàêàç÷èê*/ '+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'      UNION ALL '+ Chr(13);&#13;&#10; plst:=plst+'      SELECT '+ Chr(13);&#13;&#10; plst:=plst+'        CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'        timmth, '+ Chr(13);&#13;&#10; plst:=plst+'        tkm,'+ Chr(13);&#13;&#10; plst:=plst+'        plst_rcd'+ Chr(13);&#13;&#10; plst:=plst+'      FROM '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'           AtpZvs_TimeSF AS timmth, '+ Chr(13);&#13;&#10; plst:=plst+'           0 AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'           plst_rcd'+ Chr(13);&#13;&#10; plst:=plst+'         FROM ATPZVS '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN PLST ON AtpZvs_PLstRcd=PLst_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN PTNRK ON AtpZvs_Ptn=PTNRK.Ptn_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDZad   /*áàçà ñòðîê çàäàíèé*/ '+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'      UNION ALL '+ Chr(13);&#13;&#10; plst:=plst+'      SELECT '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        PLst_ClnNm AS Kolonna,'+ Chr(13);&#13;&#10; plst:=plst+'        SUM(BDmoto.UF_RkValN) AS timmth,'+ Chr(13);&#13;&#10; plst:=plst+'        SUM(BDtkm.UF_RkValN) AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'        BDrcd.UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'      FROM '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT U2.UFR_Rcd,UF_TblRcd '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         GROUP BY U2.UFR_Rcd,UF_TblRcd)BDrcd /*áàçà áåç ïîâòîðîâ, Rcd ïóòåâûõ ëèñòîâ è Rcd çàïèñåé*/ '+ Chr(13);&#13;&#10; plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT  U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd,UF_RkRcd,UF_RkValS '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDzak     /*áàçà ñòðîêîâûõ çíà÷åíèé, çàêàç÷èê*/ '+ Chr(13);&#13;&#10; plst:=plst+'         ON BDzak.UFR_Rcd=BDrcd.UFR_Rcd and BDzak.UF_TblRcd=BDrcd.UF_TblRcd and UF_RkValS&#60;&#62;'''+''' and BDzak.UF_RkRcd=3 '+ Chr(13);&#13;&#10; plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT   U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDmoto    /*áàçà ÷èñëîâûõ çíà÷åíèé, Rcd=1 ìîòî÷àñû*/ '+ Chr(13);&#13;&#10; plst:=plst+'         ON BDmoto.UFR_Rcd=BDzak.UFR_Rcd and BDmoto.UF_TblRcd=BDzak.UF_TblRcd and BDmoto.UF_RkValN&#60;&#62;0 and BDmoto.UF_RkRcd=1 '+ Chr(13);&#13;&#10; plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'         ) BDtkm   /*áàçà ÷èñëîâûõ çíà÷åíèé,  Rcd=2 òêì*/ '+ Chr(13);&#13;&#10; plst:=plst+'         ON BDtkm.UFR_Rcd=BDzak.UFR_Rcd and BDtkm.UF_TblRcd=BDzak.UF_TblRcd and BDtkm.UF_RkValN &#60;&#62;0 and BDtkm.UF_RkRcd=2 '+ Chr(13);&#13;&#10; plst:=plst+'      INNER JOIN PLST ON BDrcd.UF_TblRcd=PLst_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'      INNER JOIN PTNRK ON UF_RkValS=PTNRK.Ptn_cd '+ Chr(13);&#13;&#10; plst:=plst+'      GROUP BY BDrcd.UF_TblRcd, BDzak.UF_RkValS, '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd end, '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm end, '+ Chr(13);&#13;&#10; plst:=plst+'        PLst_ClnNm '+ Chr(13);&#13;&#10; plst:=plst+'      )DBreestr /*ñãðóïïèðîâàííàÿ áàçà èç ðååñòðà ïîëüçîâàòåëÿ*/ '+ Chr(13);&#13;&#10; plst:=plst+'         '+ Chr(13);&#13;&#10; plst:=plst+'     PIVOT (SUM(timmth) FOR Kolonna IN '+ Chr(13);&#13;&#10; plst:=plst+'     ([ÊÎËÎÍÀ ¹1],[ÊÎËÎÍÀ ¹2],[ÊÎËÎÍÀ ¹3],[ÊÎËÎÍÀ ¹4])) pvt '+ Chr(13);&#13;&#10; plst:=plst+'     GROUP BY CdZakaz, Zakaz,'+ Chr(13);&#13;&#10; plst:=plst+'       UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+' '+ Chr(13);&#13;&#10; plst:=plst+' )DB1 '+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN PLST ON DB1.UF_TblRcd=PLst_Rcd'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN SATAVTN ON SATAVTN.AVT_GAINMR=plst.PLst_GNmr'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN SATGRPN ON (SatAvtN.Avt_MrkRcd = SatGrpN.SG_Rcd)'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN PSPR ON (SatGrpN.SG_Type = PSpr.Spr_Cd) AND (PSpr.SprSpr_Cd=517)'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'   (SELECT UF_TblRcd, UF_RkValD'+ Chr(13);&#13;&#10; plst:=plst+'    FROM PLST'+ Chr(13);&#13;&#10; plst:=plst+'    INNER JOIN UFPRV   ON PLst_Rcd=UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'    INNER JOIN UFRKV   ON UFRKV.UFR_DbRcd=ufprv.UF_TblId and UFRKV.UFR_RkRcd=ufprv.UF_RkRcd'+ Chr(13);&#13;&#10; plst:=plst+'    WHERE UFRKV.UFR_RkRcd=80'+ Chr(13);&#13;&#10; plst:=plst+'      and plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'   ) datsdach  ON DB1.UF_TblRcd=datsdach.UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'WHERE DB1.CdZakaz = '+''''+&#60;plstquery.&#34;Cd&#34;&#62;+''''+ Chr(13);&#13;&#10; plst:=plst+' ORDER BY '+ Chr(13);&#13;&#10; plst:=plst+'   CASE WHEN RIGHT(DB1.CdZakaz,1)='''+'*'+''' THEN '+ Chr(13);&#13;&#10; plst:=plst+'     CAST(LEFT(DB1.CdZakaz,len(DB1.CdZakaz)-1) AS numeric) '+ Chr(13);&#13;&#10; plst:=plst+'   ELSE '+ Chr(13);&#13;&#10; plst:=plst+'     CAST(DB1.CdZakaz AS numeric) '+ Chr(13);&#13;&#10; plst:=plst+'   END, '+ Chr(13);&#13;&#10; plst:=plst+'   PLst_GNmr,'+ Chr(13);&#13;&#10; plst:=plst+'   PLst_Nmr,'+ Chr(13);&#13;&#10; plst:=plst+'   UF_RkValD,'+ Chr(13);&#13;&#10; plst:=plst+'   SG_NM,'+ Chr(13);&#13;&#10; plst:=plst+'   SG_TYPE,'+ Chr(13);&#13;&#10; plst:=plst+'   SPR_NM,'+ Chr(13);&#13;&#10; plst:=plst+'   AVT_GARNMR'+ Chr(13);&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;plstquery1.sql.text:=plst;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//plstquery1.close;&#13;&#10;//plstquery1.parambyname('mmm').datatype := ftString;&#13;&#10;//plstquery1.ParamByName('mmm').Value :=&#60;plstquery.&#34;Cd&#34;&#62;;&#13;&#10;//plstquery1.open;&#13;&#10;//PLstQuery1.First;&#13;&#10;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10; plstquery1.sql.text:='';&#13;&#10;&#13;&#10; plst:='';&#13;&#10;&#13;&#10; plst:=plst+' SELECT '+''''+''''+' AS PLst_Nmr, '+''''+''''+' AS PLst_Dat, '+''''+''''+' AS PLst_GNmr, '+''''+''''+' AS AVT_GARNMR, '+''''+''''+' AS UF_RkValD, '+ Chr(13);&#13;&#10; plst:=plst+'  CASE WHEN RIGHT(DB1.CdZakaz,1)='''+'*'+''' THEN '+ Chr(13);&#13;&#10; plst:=plst+'    CAST(LEFT(DB1.CdZakaz,LEN(DB1.CdZakaz)-1) AS NUMERIC) '+ Chr(13);&#13;&#10; plst:=plst+'  ELSE '+ Chr(13);&#13;&#10; plst:=plst+'    CAST(DB1.CdZakaz AS numeric) '+ Chr(13);&#13;&#10; plst:=plst+'  END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'  DB1.Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'  DB1.CdZakaz AS cd, '+ Chr(13);&#13;&#10; plst:=plst+'  SUM(KOL1) AS '''+'ÊÎËÎÍÍÀ1 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10; plst:=plst+'  SUM(KOL2) AS '''+'ÊÎËÎÍÍÀ2 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10; plst:=plst+'  SUM(KOL3) AS '''+'ÊÎËÎÍÍÀ3 ÌÎÒÎ×ÀÑÛ'+''', '+ Chr(13);&#13;&#10; plst:=plst+'  SUM(KOL4) AS '''+'ÊÎËÎÍÍÀ4 ÌÎÒÎ×ÀÑÛ'+''','+ Chr(13);&#13;&#10; plst:=plst+'  '+ Chr(13);&#13;&#10; plst:=plst+'  SG_NM,'+ Chr(13);&#13;&#10; plst:=plst+'  SG_TYPE,'+ Chr(13);&#13;&#10; plst:=plst+'  SPR_NM'+ Chr(13);&#13;&#10; plst:=plst+'  '+ Chr(13);&#13;&#10; plst:=plst+'FROM '+ Chr(13);&#13;&#10; plst:=plst+'  /*ÒÐÀÍÑÏÎÍÈÐÎÂÀÍÈÅ*/ '+ Chr(13);&#13;&#10; plst:=plst+'  (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'     CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'     Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹1]) AS KOL1, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹2]) AS KOL2, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹3]) AS KOL3, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM([êîëîíà ¹4]) AS KOL4, '+ Chr(13);&#13;&#10; plst:=plst+'     SUM(tkm) AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'     UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'   FROM '+ Chr(13);&#13;&#10; plst:=plst+'     (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'        CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'        timmth, '+ Chr(13);&#13;&#10; plst:=plst+'        tkm,'+ Chr(13);&#13;&#10; plst:=plst+'        UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'      FROM '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'           /*çàòðåáîâàííîå âðåìÿ ðàáîòû*/ '+ Chr(13);&#13;&#10; plst:=plst+'           PlPrb_TimWrk AS timmth, '+ Chr(13);&#13;&#10; plst:=plst+'           plst_tkm AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'           UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'         FROM PLST '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN UFPRV   ON PLst_Rcd=UF_TblRcd '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN UFRKV   ON UFRKV.UFR_DbRcd=ufprv.UF_TblId and UFRKV.UFR_RkRcd=ufprv.UF_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN PTNRK    ON ufprv.UF_RkValS = PTNRK.Ptn_CdSrt and UFR_SysSpr=1 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN ATPPLPRB ON ATPPLPRB.PlPrb_PLRcd=PLST.PLst_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'         --ïîëå çàêàç÷èê '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE UFRKV.UFR_RkRcd=78 '+ Chr(13);&#13;&#10; plst:=plst+'           and plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDZak    /*áàçà çàïîëíåííîãî ïîëÿ çàêàç÷èê*/ '+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'      UNION ALL '+ Chr(13);&#13;&#10; plst:=plst+'      SELECT '+ Chr(13);&#13;&#10; plst:=plst+'        CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'        timmth, '+ Chr(13);&#13;&#10; plst:=plst+'        tkm,'+ Chr(13);&#13;&#10; plst:=plst+'        plst_rcd'+ Chr(13);&#13;&#10; plst:=plst+'      FROM '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'           PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'           AtpZvs_TimeSF AS timmth, '+ Chr(13);&#13;&#10; plst:=plst+'           0 AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'           plst_rcd '+ Chr(13);&#13;&#10; plst:=plst+'         FROM ATPZVS '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN PLST ON AtpZvs_PLstRcd=PLst_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'         INNER JOIN PTNRK ON AtpZvs_Ptn=PTNRK.Ptn_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDZad   /*áàçà ñòðîê çàäàíèé*/ '+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'      UNION ALL '+ Chr(13);&#13;&#10; plst:=plst+'      SELECT '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd END AS CdZakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm END AS Zakaz, '+ Chr(13);&#13;&#10; plst:=plst+'        PLst_ClnNm AS Kolonna, '+ Chr(13);&#13;&#10; plst:=plst+'        SUM(BDmoto.UF_RkValN) AS timmth, '+ Chr(13);&#13;&#10; plst:=plst+'        SUM(BDtkm.UF_RkValN) AS tkm,'+ Chr(13);&#13;&#10; plst:=plst+'        BDrcd.UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'      FROM '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT U2.UFR_Rcd,UF_TblRcd '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         GROUP BY U2.UFR_Rcd,UF_TblRcd)BDrcd /*áàçà áåç ïîâòîðîâ, Rcd ïóòåâûõ ëèñòîâ è Rcd çàïèñåé*/ '+ Chr(13);&#13;&#10; plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT  U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd,UF_RkRcd,UF_RkValS '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDzak     /*áàçà ñòðîêîâûõ çíà÷åíèé, çàêàç÷èê*/ '+ Chr(13);&#13;&#10; plst:=plst+'         ON BDzak.UFR_Rcd=BDrcd.UFR_Rcd and BDzak.UF_TblRcd=BDrcd.UF_TblRcd and UF_RkValS&#60;&#62;'''+''' and BDzak.UF_RkRcd=3 '+ Chr(13);&#13;&#10; plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT   U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'         WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDmoto    /*áàçà ÷èñëîâûõ çíà÷åíèé, Rcd=1 ìîòî÷àñû*/ '+ Chr(13);&#13;&#10; plst:=plst+'         ON BDmoto.UFR_Rcd=BDzak.UFR_Rcd and BDmoto.UF_TblRcd=BDzak.UF_TblRcd and BDmoto.UF_RkValN&#60;&#62;0 and BDmoto.UF_RkRcd=1 '+ Chr(13);&#13;&#10; plst:=plst+'      LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'        (SELECT U2.UFR_Rcd AS UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN '+ Chr(13);&#13;&#10; plst:=plst+'         FROM UFRstVal U2 '+ Chr(13);&#13;&#10; plst:=plst+'         LEFT JOIN  UFRSTNST U10 ON U2.UF_RkRcd=U10.UFR_RkRcd '+ Chr(13);&#13;&#10; plst:=plst+'      WHERE U2.UF_TblRcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'         ) BDtkm   /*áàçà ÷èñëîâûõ çíà÷åíèé,  Rcd=2 òêì*/ '+ Chr(13);&#13;&#10; plst:=plst+'         ON BDtkm.UFR_Rcd=BDzak.UFR_Rcd and BDtkm.UF_TblRcd=BDzak.UF_TblRcd and BDtkm.UF_RkValN &#60;&#62;0 and BDtkm.UF_RkRcd=2 '+ Chr(13);&#13;&#10; plst:=plst+'      INNER JOIN PLST ON BDrcd.UF_TblRcd=PLst_Rcd '+ Chr(13);&#13;&#10; plst:=plst+'      INNER JOIN PTNRK ON UF_RkValS=PTNRK.Ptn_cd '+ Chr(13);&#13;&#10; plst:=plst+'      GROUP BY BDrcd.UF_TblRcd, BDzak.UF_RkValS, '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Cd is null THEN '''+'0'+''' ELSE Ptn_Cd end, '+ Chr(13);&#13;&#10; plst:=plst+'        CASE WHEN Ptn_Nm is null THEN '''+'çàêàç÷èê íå îïðåäåëåí'+''' ELSE Ptn_Nm end, '+ Chr(13);&#13;&#10; plst:=plst+'        PLst_ClnNm '+ Chr(13);&#13;&#10; plst:=plst+'      )DBreestr /*ñãðóïïèðîâàííàÿ áàçà èç ðååñòðà ïîëüçîâàòåëÿ*/ '+ Chr(13);&#13;&#10; plst:=plst+'         '+ Chr(13);&#13;&#10; plst:=plst+'     PIVOT (SUM(timmth) FOR Kolonna IN '+ Chr(13);&#13;&#10; plst:=plst+'     ([ÊÎËÎÍÀ ¹1],[ÊÎËÎÍÀ ¹2],[ÊÎËÎÍÀ ¹3],[ÊÎËÎÍÀ ¹4])) pvt '+ Chr(13);&#13;&#10; plst:=plst+'     GROUP BY CdZakaz, Zakaz,'+ Chr(13);&#13;&#10; plst:=plst+'       UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+' '+ Chr(13);&#13;&#10; plst:=plst+' )DB1 '+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN PLST ON DB1.UF_TblRcd=PLst_Rcd'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN SATAVTN ON SATAVTN.AVT_GAINMR=plst.PLst_GNmr'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN SATGRPN ON (SatAvtN.Avt_MrkRcd = SatGrpN.SG_Rcd)'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN PSPR ON (SatGrpN.SG_Type = PSpr.Spr_Cd) AND (PSpr.SprSpr_Cd=517)'+ Chr(13);&#13;&#10; plst:=plst+' LEFT JOIN '+ Chr(13);&#13;&#10; plst:=plst+'   (SELECT UF_TblRcd, UF_RkValD'+ Chr(13);&#13;&#10; plst:=plst+'    FROM PLST'+ Chr(13);&#13;&#10; plst:=plst+'    INNER JOIN UFPRV   ON PLst_Rcd=UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+'    INNER JOIN UFRKV   ON UFRKV.UFR_DbRcd=ufprv.UF_TblId and UFRKV.UFR_RkRcd=ufprv.UF_RkRcd'+ Chr(13);&#13;&#10; plst:=plst+'    WHERE UFRKV.UFR_RkRcd=80'+ Chr(13);&#13;&#10; plst:=plst+'      and plst_rcd in ('+strrcd+')'+ Chr(13);&#13;&#10; plst:=plst+'   ) datsdach  ON DB1.UF_TblRcd=datsdach.UF_TblRcd'+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+'WHERE DB1.CdZakaz = '+''''+&#60;plstquery.&#34;Cd&#34;&#62;+''''+ Chr(13);&#13;&#10; plst:=plst+'GROUP BY'+ Chr(13);&#13;&#10; plst:=plst+'  DB1.CdZakaz,'+ Chr(13);&#13;&#10; plst:=plst+'  DB1.Zakaz,'+ Chr(13);&#13;&#10; plst:=plst+'  SG_NM,'+ Chr(13);&#13;&#10; plst:=plst+'  SG_TYPE,'+ Chr(13);&#13;&#10; plst:=plst+'  SPR_NM'+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plst:=plst+' ORDER BY '+ Chr(13);&#13;&#10; plst:=plst+'   CASE WHEN RIGHT(DB1.CdZakaz,1)='''+'*'+''' THEN '+ Chr(13);&#13;&#10; plst:=plst+'     CAST(LEFT(DB1.CdZakaz,len(DB1.CdZakaz)-1) AS numeric) '+ Chr(13);&#13;&#10; plst:=plst+'   ELSE '+ Chr(13);&#13;&#10; plst:=plst+'     CAST(DB1.CdZakaz AS numeric) '+ Chr(13);&#13;&#10; plst:=plst+'   END, '+ Chr(13);&#13;&#10; plst:=plst+'   '+ Chr(13);&#13;&#10; plst:=plst+'   SG_NM,'+ Chr(13);&#13;&#10; plst:=plst+'   SG_TYPE,'+ Chr(13);&#13;&#10; plst:=plst+'   SPR_NM'+ Chr(13);&#13;&#10; plst:=plst+''+ Chr(13);&#13;&#10; plstquery1.sql.text:=plst;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo17OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;nm.close;&#13;&#10;nm.ParamByName('cd').Value := inttostr(&#60;PLstQuery.&#34;CdZakaz&#34;&#62;)+'*';&#13;&#10;nm.open;&#13;&#10;nm.First;&#13;&#10;memo17.text:=&#60;nm.&#34;Ptn_NmSh&#34;&#62;;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.">
  <Datasets>
    <item DataSet="PLstQuery" DataSetName="PLstQuery"/>
    <item DataSet="CrtFrmQuery" DataSetName="CrtFrmQuery"/>
    <item DataSet="dsBaseInfo" DataSetName="dsBaseInfo"/>
    <item DataSet="dsMark" DataSetName="dsMark"/>
    <item DataSet="Qmindat" DataSetName="Qmindat"/>
    <item DataSet="PLSTQuery1" DataSetName="PLSTQuery1"/>
    <item DataSet="dmindmax" DataSetName="dmindmax"/>
    <item DataSet="nm" DataSetName="nm"/>
  </Datasets>
  <Variables>
    <item Name=" Áåñò-Çâèò" Value="True"/>
    <item Name="ZvitPeriodType" Value="0"/>
    <item Name="ZvitCharCode" Value="0"/>
    <item Name="ZvitPeriodDate" Value="0"/>
  </Variables>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxODBCQuery Name="PLstQuery" UserName="PLstQuery" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select&#13;&#10;case when right(BAZA1.Cdzakaz,1)='*' then&#13;&#10;CAST(left(BAZA1.Cdzakaz,len(BAZA1.Cdzakaz)-1) as numeric)&#13;&#10;else&#13;&#10;CAST(BAZA1.Cdzakaz as numeric)&#13;&#10;end as Cdzakaz,  &#13;&#10;BAZA1.zakaz,&#13;&#10;KOL1 AS 'ÊÎËÎÍÍÀ1 ÌÎÒÎ×ÀÑÛ',&#13;&#10;KOL2 AS 'ÊÎËÎÍÍÀ2 ÌÎÒÎ×ÀÑÛ',&#13;&#10;KOL3 AS 'ÊÎËÎÍÍÀ3 ÌÎÒÎ×ÀÑÛ',&#13;&#10;KOL4 AS 'ÊÎËÎÍÍÀ4 ÌÎÒÎ×ÀÑÛ',&#13;&#10;KOLONNA1 AS 'ÊÎËÎÍÍÀ1 ÒÊÌ',&#13;&#10;KOLONNA2 AS 'ÊÎËÎÍÍÀ2 ÒÊÌ',  &#13;&#10;KOLONNA3 AS 'ÊÎËÎÍÍÀ3 ÒÊÌ',  &#13;&#10;KOLONNA4 AS 'ÊÎËÎÍÍÀ4 ÒÊÌ'  &#13;&#10;&#13;&#10;FROM&#13;&#10;&#13;&#10;        /*BAZA1 - ÑÁÎÐ ÌÎÒÎ×ÀÑÎÂ È ÒÐÀÍÑÏÎÍÈÐÎÂÀÍÈÅ ÒÀÁËÈÖÛ*/        &#13;&#10;      /*ÒÐÀÍÑÏÎÍÈÐÎÂÀÍÈÅ*/        &#13;&#10;     (select&#13;&#10;      Cdzakaz, &#13;&#10;      zakaz, &#13;&#10;      sum([ÊÎËÎÍÀ ¹1]) as KOL1,&#13;&#10;      sum(tkm) as 'tkm',&#13;&#10;      sum([êîëîíà ¹2]) as KOL2,&#13;&#10;      sum([êîëîíà ¹3]) as KOL3,&#13;&#10;      sum([êîëîíà ¹4]) as KOL4&#13;&#10;      &#13;&#10;      from&#13;&#10;         /*ÃÐÓÏÏÈÐÎÂÊÀ ÏÅÐÅÄ ÒÐÀÍÑÏÎÍÈÐÎÂÀÍÈÅÌ, ÏÎËÅÇÍÀ ÄËß ÅÄÈÍÎÃÎ ÇÀÏÐÎÑÀ ÒÊÌ È Ì×*/                &#13;&#10;        (select&#13;&#10;         Cdzakaz,&#13;&#10;         zakaz,&#13;&#10;         kolonna,&#13;&#10;         sum(timmth) as timmth,&#13;&#10;         sum(tkm) as tkm              &#13;&#10;         from&#13;&#10;  &#13;&#10;            (&#13;&#10;              select&#13;&#10;              Cdzakaz,&#13;&#10;              zakaz,&#13;&#10;              kolonna,&#13;&#10;              timmth,&#13;&#10;              tkm&#13;&#10;            &#13;&#10;                from&#13;&#10;&#13;&#10;                   (select &#13;&#10;                    case when Ptn_Cd is null then '' else Ptn_Cd end as Cdzakaz,&#13;&#10;                    case when Ptn_Nm is null then 'çàêàç÷èê íå îïðåäåëåí' else Ptn_Nm end as zakaz,&#13;&#10;                    PLst_ClnNm as kolonna,&#13;&#10;                    /*&#13;&#10;                    ìîòî÷àñû&#13;&#10;                    plprb_timmth as timmth,&#13;&#10;                    */&#13;&#10;                    /*çàòðåáîâàííîå âðåìÿ ðàáîòû*/                              &#13;&#10;                    PlPrb_TimWrk as timmth,            &#13;&#10;                    plst_tkm as tkm&#13;&#10;&#13;&#10;                    from PLsT&#13;&#10;                    inner join UFPRV   on PLst_Rcd=UF_TblRcd&#13;&#10;                    inner join ufrkv   on ufrkv.UFR_DbRcd=ufprv.UF_TblId and ufrkv.UFR_RkRcd=ufprv.UF_RkRcd&#13;&#10;                    left join uflstspr on ufrkv.UFR_cdspr=uflstspr.UFS_rcd&#13;&#10;                    left join ufspr    on ufspr.UFS_Rcd=uflstspr.UFS_Rcd and ufspr.UFS_CdN=ufprv.UF_RkValN&#13;&#10;                    left join ptnrk    on ufprv.UF_RkValS = ptnrk.Ptn_CdSrt and UFR_SysSpr=1&#13;&#10;                    left join SpVdN    on SpVd_VdCd=Plst_vodCd&#13;&#10;                    left join atpzvd   on atpzvd.atpzvd_rcd=plst.plst_zvdrcd&#13;&#10;                    left join ATPPLPRB on ATPPLPRB.PlPrb_PLRcd=PLsT.PLst_Rcd&#13;&#10;                    --ïîëå çàêàç÷èê&#13;&#10;                    where ufrkv.UFR_RkRcd=78&#13;&#10;                    and (PLst_Dat BETWEEN  :DatBeg and :DatEnd)    &#13;&#10;                   ) bb1    /*ÁÀÇÀ ÇÀÏÎËÍÅÍÍÎÃÎ ÏÎËß ÏÎËÜÇÎÂÀÒÅËß ÇÀÊÀÇ×ÈÊ*/                          &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  &#13;&#10;           union all&#13;&#10;              select&#13;&#10;              Cdzakaz,&#13;&#10;              zakaz,       &#13;&#10;              kolonna,&#13;&#10;              timmth,&#13;&#10;              tkm&#13;&#10;               &#13;&#10;               from&#13;&#10;               &#13;&#10;                   (select&#13;&#10;                    case when Ptn_Cd is null then '' else Ptn_Cd end as Cdzakaz,&#13;&#10;                    case when Ptn_Nm is null then 'çàêàç÷èê íå îïðåäåëåí' else Ptn_Nm end as zakaz,&#13;&#10;                    PLst_ClnNm as kolonna,&#13;&#10;                    (AtpZvs_TimeSF) as timmth,&#13;&#10;                    0 as tkm&#13;&#10;                    &#13;&#10;                    from ATPZVS&#13;&#10;                    inner join plst  on AtpZvs_PLstRcd=PLst_Rcd&#13;&#10;                    inner join ptnrk on AtpZvs_Ptn=ptnrk.Ptn_Rcd&#13;&#10;                    where (PLst_Dat BETWEEN  :DatBeg and :DatEnd)&#13;&#10;                   ) bb2   /*ÁÀÇÀ ÑÒÐÎÊ ÇÀÄÀÍÈÉ*/                    &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;           union all&#13;&#10;              select&#13;&#10;              Cdzakaz,&#13;&#10;              zakaz,&#13;&#10;              kolonna,&#13;&#10;              timmth,&#13;&#10;              tkm&#13;&#10;                &#13;&#10;                from&#13;&#10;                &#13;&#10;                   (&#13;&#10;                   select baza.UF_TblRcd, baza.UF_RkValS, sum(baza.UF_RkValN1) as timmth, sum(baza.UF_RkValN2) as tkm,&#13;&#10;                   case when Ptn_Cd is null then '' else Ptn_Cd end as Cdzakaz,&#13;&#10;                   case when Ptn_Nm is null then 'çàêàç÷èê íå îïðåäåëåí' else Ptn_Nm end as zakaz,&#13;&#10;                   PLst_ClnNm as kolonna&#13;&#10;                   from&#13;&#10;                   &#13;&#10;                   (&#13;&#10;                    select pp.UF_TblRcd, mm.UF_RkValS, nn.UF_RkValN as UF_RkValN1, oo.UF_RkValN as UF_RkValN2&#13;&#10;                    from&#13;&#10;                         (SELECT U2.UFR_Rcd,UF_TblRcd&#13;&#10;                          FROM&#13;&#10;                          UFRstVal U2&#13;&#10;                          left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                          group by U2.UFR_Rcd,UF_TblRcd)pp /*ÁÀÇÀ ÁÅÇ ÏÎÂÒÎÐÎÂ, Rcd ÏÓÒÅÂÛÕ È Rcd ÇÀÏÈÑÅÉ*/           &#13;&#10;&#13;&#10;&#13;&#10;                        &#13;&#10;                          left join&#13;&#10;                          (SELECT  U2.UFR_Rcd as UFR_Rcd,UF_TblRcd,UF_RkRcd,UF_RkValS&#13;&#10;                           FROM&#13;&#10;                           UFRstVal U2&#13;&#10;                           left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                           ) mm     /*ÁÀÇÀ ÑÒÐÎÊÎÂÛÕ ÇÍÀ×ÅÍÈÉ, ÇÀÊÀÇ×ÈÊ*/         &#13;&#10;                          on mm.UFR_Rcd=pp.UFR_Rcd and mm.UF_TblRcd=pp.UF_TblRcd and UF_RkValS &#60;&#62;'' and mm.UF_RkRcd=3&#13;&#10;                          &#13;&#10;                          &#13;&#10;                          &#13;&#10;                          left join&#13;&#10;                          (SELECT   U2.UFR_Rcd as UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN&#13;&#10;                           FROM&#13;&#10;                           UFRstVal U2&#13;&#10;                           left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                           ) nn    /*ÁÀÇÀ ×ÈÑËÎÂÛÕ ÇÍÀ×ÅÍÈÉ, Rcd=1 ÌÎÒÎ×ÀÑÛ*/         &#13;&#10;                           on nn.UFR_Rcd=mm.UFR_Rcd and nn.UF_TblRcd=mm.UF_TblRcd and nn.UF_RkValN &#60;&#62;0 and nn.UF_RkRcd=1&#13;&#10;                           &#13;&#10;                           &#13;&#10;                          &#13;&#10;                          left join&#13;&#10;                          (SELECT U2.UFR_Rcd as UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN&#13;&#10;                           FROM&#13;&#10;                           UFRstVal U2&#13;&#10;                           left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                           ) oo   /*ÁÀÇÀ ×ÈÑËÎÂÛÕ ÇÍÀ×ÅÍÈÉ,  Rcd=2 ÒÊÌ*/         &#13;&#10;                           on oo.UFR_Rcd=mm.UFR_Rcd and oo.UF_TblRcd=mm.UF_TblRcd and oo.UF_RkValN &#60;&#62;0 and oo.UF_RkRcd=2&#13;&#10;                  ) baza /*ÁÀÇÀ ÈÇ ÐÅÅÑÒÐÀ ÏÎËÜÇÎÂÀÒÅËß*/           &#13;&#10;          &#13;&#10;                 inner join plst&#13;&#10;                 on UF_TblRcd=PLst_Rcd&#13;&#10;                 inner join ptnrk&#13;&#10;                 on UF_RkValS=ptnrk.Ptn_cd&#13;&#10;                 &#13;&#10;                 where (PLst_Dat BETWEEN  :DatBeg and :DatEnd)&#13;&#10;                 group by&#13;&#10;                 baza.UF_TblRcd, baza.UF_RkValS,&#13;&#10;                 case when Ptn_Cd is null then '' else Ptn_Cd end,&#13;&#10;                 case when Ptn_Nm is null then 'çàêàç÷èê íå îïðåäåëåí' else Ptn_Nm end,&#13;&#10;                 PLst_ClnNm&#13;&#10;                 &#13;&#10;                 )bb3 /*ÑÃÐÓÏÏÈÐÎÂÀÍÍÀß ÁÀÇÀ ÈÇ ÐÅÅÑÒÐÀ ÏÎËÜÇÎÂÀÒÅËß*/           &#13;&#10;  &#13;&#10;             ) pretex  /*ÁÀÇÀ Ê ÎÑÒÀËÜÍÛÌ BB*/        &#13;&#10;               &#13;&#10;         group by Cdzakaz,zakaz,kolonna&#13;&#10;  &#13;&#10;         ) tex&#13;&#10;         pivot (sum(timmth) for kolonna in&#13;&#10;         ([ÊÎËÎÍÀ ¹1],[ÊÎËÎÍÀ ¹2],[ÊÎËÎÍÀ ¹3],[ÊÎËÎÍÀ ¹4])) pvt &#13;&#10;         group by Cdzakaz, zakaz &#13;&#10;&#13;&#10;)BAZA1            &#13;&#10;&#13;&#10;&#13;&#10; LEFT JOIN &#13;&#10; &#13;&#10; &#13;&#10;        /*ÔÎÐÌÈÐÎÂÀÍÈÅ òîííî-êì*/         &#13;&#10;   &#13;&#10;   (select &#13;&#10;    Cdzakaz,&#13;&#10;    zakaz,&#13;&#10;    SUM(kolonna1) as kolonna1,&#13;&#10;    SUM(kolonna2) as kolonna2,&#13;&#10;    SUM(kolonna3) as kolonna3,&#13;&#10;    SUM(kolonna4) as kolonna4&#13;&#10;    FROM&#13;&#10;   &#13;&#10;       (select &#13;&#10;       Cdzakaz,&#13;&#10;       zakaz,&#13;&#10;       kolonna1,&#13;&#10;       kolonna2,&#13;&#10;       kolonna3,&#13;&#10;       kolonna4&#13;&#10;        FROM(&#13;&#10;        select &#13;&#10;        case when Ptn_Cd is null then '' else Ptn_Cd end as Cdzakaz,&#13;&#10;        case when Ptn_Nm is null then 'çç' else Ptn_Nm end as zakaz,&#13;&#10;        case when PLst_ClnNm = 'ÊÎËÎÍÀ ¹1' THEN SUM(plst_tkm) END as kolonna1,&#13;&#10;        case when PLst_ClnNm = 'ÊÎËÎÍÀ ¹2' THEN SUM(plst_tkm) END as kolonna2,&#13;&#10;        case when PLst_ClnNm = 'ÊÎËÎÍÀ ¹3' THEN SUM(plst_tkm) END as kolonna3,&#13;&#10;        case when PLst_ClnNm = 'ÊÎËÎÍÀ ¹4' THEN SUM(plst_tkm) END as kolonna4&#13;&#10;      &#13;&#10;          &#13;&#10;        from PLsT&#13;&#10;        inner join UFPRV   on PLst_Rcd=UF_TblRcd&#13;&#10;        inner join ufrkv   on ufrkv.UFR_DbRcd=ufprv.UF_TblId and ufrkv.UFR_RkRcd=ufprv.UF_RkRcd&#13;&#10;        left join uflstspr on ufrkv.UFR_cdspr=uflstspr.UFS_rcd&#13;&#10;        left join ufspr    on ufspr.UFS_Rcd=uflstspr.UFS_Rcd and ufspr.UFS_CdN=ufprv.UF_RkValN&#13;&#10;        left join ptnrk    on ufprv.UF_RkValS = ptnrk.Ptn_CdSrt and UFR_SysSpr=1&#13;&#10;        left join SpVdN    on SpVd_VdCd=Plst_vodCd&#13;&#10;        left join atpzvd   on atpzvd.atpzvd_rcd=plst.plst_zvdrcd&#13;&#10;        INNER join&#13;&#10;           (select sum(plprb_tim) as plprb_timmth, &#13;&#10;            sum(plprb_timwrk) as plprb_timwrk,&#13;&#10;             PlPrb_PLRcd&#13;&#10;             from ATPPLPRB group by PlPrb_PLRcd) tm&#13;&#10;             on Tm.PlPrb_PLRcd=PLsT.PLst_Rcd&#13;&#10;        where ufrkv.UFR_RkRcd=78&#13;&#10;             AND (PLst_Dat BETWEEN  :DatBeg and :DatEnd)  &#13;&#10;&#13;&#10;       GROUP BY case when Ptn_Cd is null then '' else Ptn_Cd end,&#13;&#10;       case when Ptn_Nm is null then 'çç' else Ptn_Nm end,&#13;&#10;       PLst_ClnNm&#13;&#10;      )BBB&#13;&#10;&#13;&#10;    &#13;&#10;     UNION ALL&#13;&#10;              &#13;&#10;             select&#13;&#10;             Cdzakaz,&#13;&#10;             zakaz,&#13;&#10;             case when KOLONNA = 'ÊÎËÎÍÀ ¹1' THEN SUM(tkm) END as kolonna1,&#13;&#10;             case when KOLONNA = 'ÊÎËÎÍÀ ¹2' THEN SUM(tkm) END as kolonna2,&#13;&#10;             case when KOLONNA = 'ÊÎËÎÍÀ ¹3' THEN SUM(tkm) END as kolonna3,&#13;&#10;             case when KOLONNA = 'ÊÎËÎÍÀ ¹4' THEN SUM(tkm) END as kolonna4&#13;&#10;             &#13;&#10;                &#13;&#10;               from&#13;&#10;                &#13;&#10;                  (&#13;&#10;                  select baza.UF_TblRcd, baza.UF_RkValS, sum(baza.UF_RkValN2) as tkm,&#13;&#10;                  case when Ptn_Cd is null then '' else Ptn_Cd end as Cdzakaz,&#13;&#10;                  case when Ptn_Nm is null then 'çàêàç÷èê íå îïðåäåëåí' else Ptn_Nm end as zakaz,&#13;&#10;                  PLst_ClnNm as kolonna&#13;&#10;                  from&#13;&#10;                   &#13;&#10;                  (&#13;&#10;                   select pp.UF_TblRcd, mm.UF_RkValS, oo.UF_RkValN as UF_RkValN2&#13;&#10;                   from&#13;&#10;                        (SELECT U2.UFR_Rcd,UF_TblRcd&#13;&#10;                         FROM&#13;&#10;                         UFRstVal U2&#13;&#10;                         left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                         group by U2.UFR_Rcd,UF_TblRcd)pp /*ÁÀÇÀ ÁÅÇ ÏÎÂÒÎÐÎÂ, Rcd ÏÓÒÅÂÛÕ È Rcd ÇÀÏÈÑÅÉ*/           &#13;&#10;&#13;&#10;&#13;&#10;                        &#13;&#10;                         left join&#13;&#10;                         (SELECT  U2.UFR_Rcd as UFR_Rcd,UF_TblRcd,UF_RkRcd,UF_RkValS&#13;&#10;                          FROM&#13;&#10;                          UFRstVal U2&#13;&#10;                          left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                          ) mm     /*ÁÀÇÀ ÑÒÐÎÊÎÂÛÕ ÇÍÀ×ÅÍÈÉ, ÇÀÊÀÇ×ÈÊ*/         &#13;&#10;                         on mm.UFR_Rcd=pp.UFR_Rcd and mm.UF_TblRcd=pp.UF_TblRcd and UF_RkValS &#60;&#62;'' and mm.UF_RkRcd=3&#13;&#10;    &#13;&#10;    &#13;&#10;                         left join&#13;&#10;                         (SELECT U2.UFR_Rcd as UFR_Rcd,UF_TblRcd, UF_RkRcd, UF_RkValN&#13;&#10;                          FROM&#13;&#10;                          UFRstVal U2&#13;&#10;                          left join  UFRSTNST U10 on U2.UF_RkRcd=U10.UFR_RkRcd&#13;&#10;                          ) oo   /*ÁÀÇÀ ×ÈÑËÎÂÛÕ ÇÍÀ×ÅÍÈÉ,  Rcd=2 ÒÊÌ*/         &#13;&#10;                          on oo.UFR_Rcd=mm.UFR_Rcd and oo.UF_TblRcd=mm.UF_TblRcd and oo.UF_RkValN &#60;&#62;0 and oo.UF_RkRcd=2&#13;&#10;                 ) baza /*ÁÀÇÀ ÈÇ ÐÅÅÑÒÐÀ ÏÎËÜÇÎÂÀÒÅËß*/           &#13;&#10;          &#13;&#10;                inner join plst&#13;&#10;                on UF_TblRcd=PLst_Rcd&#13;&#10;                inner join ptnrk&#13;&#10;                on UF_RkValS=ptnrk.Ptn_cd&#13;&#10;                where (PLst_Dat BETWEEN  :DatBeg and :DatEnd)                   &#13;&#10;                 &#13;&#10;                group by&#13;&#10;                baza.UF_TblRcd, baza.UF_RkValS,&#13;&#10;                case when Ptn_Cd is null then '' else Ptn_Cd end,&#13;&#10;                case when Ptn_Nm is null then 'çàêàç÷èê íå îïðåäåëåí' else Ptn_Nm end,&#13;&#10;                PLst_ClnNm&#13;&#10;                 &#13;&#10;             )bb4 /*ÑÃÐÓÏÏÈÐÎÂÀÍÍÀß ÁÀÇÀ ÈÇ ÐÅÅÑÒÐÀ ÏÎËÜÇÎÂÀÒÅËß*/ &#13;&#10;&#13;&#10;          GROUP BY&#13;&#10;          Cdzakaz, zakaz, KOLONNA &#13;&#10;                 &#13;&#10;          )BB6&#13;&#10;&#13;&#10;&#13;&#10;     GROUP BY  Cdzakaz,zakaz&#13;&#10;&#13;&#10; ) BAZA2 &#13;&#10; &#13;&#10; ON BAZA1.Cdzakaz=BAZA2.Cdzakaz AND BAZA1.zakaz=BAZA2.zakaz &#13;&#10; &#13;&#10; order by &#13;&#10;&#13;&#10; case when right(BAZA1.Cdzakaz,1)='*' then &#13;&#10; CAST(left(BAZA1.Cdzakaz,len(BAZA1.Cdzakaz)-1) as numeric)&#13;&#10; else&#13;&#10; CAST(BAZA1.Cdzakaz as numeric)&#13;&#10; end                                                 " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674022C0470546F7002140A506172616D657465727301010C39000000204E616D653D22446174426567222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174456E64222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174426567222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174456E64222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174426567222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174456E64222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174426567222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174456E64222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174426567222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E2200010C39000000204E616D653D22446174456E64222044617461547970653D226674556E6B6E6F776E2220506172616D547970653D227074556E6B6E6F776E220000"/>
    <TfrxODBCQuery Name="CrtFrmQuery" UserName="CrtFrmQuery" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="SELECT CRTFRM_LNNM&#13;&#10;FROM CRTFRM1    " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC000470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="Qmindat" UserName="Qmindat" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select min(Plst_dat) dmin from Plst    " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403FC000470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="PLSTQuery1" UserName="PLSTQuery1" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="                                               " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674022C0470546F7002540A506172616D65746572730100"/>
    <TfrxODBCQuery Name="dmindmax" UserName="dmindmax" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="                                               " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C656674036C010470546F7002140A506172616D65746572730100"/>
    <TfrxODBCQuery Name="nm" UserName="nm" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="select&#13;&#10;Ptn_NmSh&#13;&#10;from ptnrk&#13;&#10;where Ptn_Cd=:cd          &#13;&#10;                 " PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C65667403BC010470546F7002140A506172616D657465727301010C34000000204E616D653D226364222044617461547970653D226674537472696E672220506172616D547970653D227074556E6B6E6F776E220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="5" BottomMargin="5" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="Band2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="26.45671" Left="0" Top="302.3624" Width="1009.13451" OnAfterPrint="Band2OnAfterPrint" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="PLstQuery" DataSetName="PLstQuery" RowCount="0" Stretched="true">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="60.47248" Height="26.45671" OnAfterPrint="Memo2OnAfterPrint" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[PLstQuery.&#34;Cdzakaz&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="230.55133" Top="0" Width="506.45702" Height="26.45671" DataField="zakaz" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text="[PLstQuery.&#34;zakaz&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="805.03989" Top="0" Width="68.03149606" Height="26.45671" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" VAlign="vaCenter" Text="[&#60;PLstQuery.&#34;ÐÐÐÐÐÐÐ2 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo12" Left="737.00835" Top="0" Width="68.03149606" Height="26.45671" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" VAlign="vaCenter" Text="[&#60;PLstQuery.&#34;ÐÐÐÐÐÐÐ1 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo13" Left="873.07117126" Top="0" Width="68.03149606" Height="26.45671" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" VAlign="vaCenter" Text="[&#60;PLstQuery.&#34;ÐÐÐÐÐÐÐ3 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo14" Left="941.10266732" Top="0" Width="68.03149606" Height="26.45671" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" VAlign="vaCenter" Text="[&#60;PLstQuery.&#34;ÐÐÐÐÐÐÐ4 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo17" Left="60.47248" Top="0" Width="170.07885" Height="26.45671" OnBeforePrint="Memo17OnBeforePrint" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="false" VAlign="vaCenter" Text=""/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="41.57483" Left="0" Top="215.43321" Width="1009.13451" OnBeforePrint="GroupHeader1OnBeforePrint" Condition="1" Stretched="true">
      <TfrxMemoView Name="Memo1" ShiftMode="smDontShift" Left="0" Top="0" Width="60.47248" Height="41.57483" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ»Ð¸ÐµÐ½Ñ"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smDontShift" Left="60.47248" Top="0" Width="676.53587" Height="22.67718" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="7" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½ÑÐ°"/>
      <TfrxMemoView Name="Memo11" ShiftMode="smDontShift" Left="737.00835" Top="0" Width="68.03149606" Height="41.57481535" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ¾Ð»Ð¾Ð½Ð½Ð° â1&#13;&#10;Ð¼/Ñ"/>
      <TfrxMemoView Name="Memo19" ShiftMode="smDontShift" Left="941.10266732" Top="0" Width="68.03149606" Height="41.57481535" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ¾Ð»Ð¾Ð½Ð½Ð° â4&#13;&#10;Ð¼/Ñ"/>
      <TfrxMemoView Name="Memo29" ShiftMode="smDontShift" Left="805.03989" Top="0" Width="68.03149606" Height="41.57483" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ¾Ð»Ð¾Ð½Ð½Ð° â2&#13;&#10;Ð¼/Ñ"/>
      <TfrxMemoView Name="Memo15" ShiftMode="smDontShift" Left="873.07117126" Top="0" Width="68.03149606" Height="41.57483" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ¾Ð»Ð¾Ð½Ð½Ð° â3&#13;&#10;Ð¼/Ñ"/>
      <TfrxMemoView Name="Memo31" Left="60.47248" Top="22.67718" Width="94.48825" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="Ð½Ð¾Ð¼ÐµÑ ÐÐ"/>
      <TfrxMemoView Name="Memo34" Left="154.96073" Top="22.67718" Width="75.5906" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="Ð´Ð°ÑÐ° ÐÐ"/>
      <TfrxMemoView Name="Memo35" Left="230.55133" Top="22.67718" Width="98.26778" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="Ð³Ð¾Ñ.Ð½Ð¾Ð¼ÐµÑ"/>
      <TfrxMemoView Name="Memo36" Left="657.63822" Top="22.67718" Width="79.37013" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="Ð´Ð°ÑÐ° ÑÐ´Ð°ÑÐ¸"/>
      <TfrxMemoView Name="Memo5" Left="328.81911" Top="22.67718" Width="94.48825" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="Ð³Ð°ÑÐ°Ð¶Ð½ÑÐ¹ Ð½Ð¾Ð¼ÐµÑ"/>
      <TfrxMemoView Name="Memo6" Left="423.30736" Top="22.67718" Width="98.26778" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="ÑÐ¸Ð¿"/>
      <TfrxMemoView Name="Memo10" Left="521.57514" Top="22.67718" Width="136.06308" Height="18.89765" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="Ð¼Ð°ÑÐºÐ°"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="30.23624" Left="0" Top="393.07112" Width="1009.13451" OnAfterPrint="GroupFooter1OnAfterPrint" Stretched="true">
      <TfrxMemoView Name="Memo27" ShiftMode="smDontShift" Left="0" Top="0" Width="737.00835" Height="26.45671" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777215" ParentFont="false" VAlign="vaCenter" Text="ÐÐ¢ÐÐÐ:"/>
      <TfrxMemoView Name="Memo21" ShiftMode="smDontShift" Left="805.03989" Top="0" Width="68.03154" Height="26.45671" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777215" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sum(Memo8.value,band2)]"/>
      <TfrxMemoView Name="Memo22" ShiftMode="smDontShift" Left="737.00835" Top="0" Width="68.03154" Height="26.45671" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777215" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sum(Memo12.value,band2)]"/>
      <TfrxMemoView Name="Memo32" ShiftMode="smDontShift" Left="873.07117126" Top="0" Width="68.03154" Height="26.45671" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777215" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sum(Memo13.value,band2)]"/>
      <TfrxMemoView Name="Memo33" ShiftMode="smDontShift" Left="941.10266732" Top="0" Width="68.03154" Height="26.45671" StretchMode="smMaxHeight" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="16777215" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text="[sum(Memo14.value,band2)]"/>
    </TfrxGroupFooter>
    <TfrxGroupHeader Name="GroupHeader2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="0" Left="0" Top="279.68522" Width="1009.13451" Condition="&#60;PLstQuery.&#34;Cd&#34;&#62;"/>
    <TfrxGroupFooter Name="GroupFooter2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18.89765" Left="0" Top="351.49629" Width="1009.13451" OnBeforePrint="GroupFooter2OnBeforePrint">
      <TfrxSubreport Name="Subreport1" Left="0" Top="0" Width="1009.13451" Height="18.89765" Page="Page3"/>
    </TfrxGroupFooter>
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="90.70872" Left="0" Top="18.89765" Width="1009.13451">
      <TfrxMemoView Name="Memo7" Align="baCenter" ShiftMode="smDontShift" Left="164.409750275" Top="41.57483" Width="680.31500945" Height="41.57483" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="false" Text="Ð¢ÐµÑÐ½Ð¸ÑÐµÑÐºÐ¸Ð¹ Ð¾ÑÑÐµÑ&#13;&#10;ÐÐ²ÑÐ¾ÑÑÐ°Ð½ÑÐ¿Ð¾ÑÑÐ½ÑÐ¹ ÑÐµÑ Ð·Ð° Ð¿ÐµÑÐ¸Ð¾Ð´ ÑÐ´Ð°ÑÐ¸ ÐÐ Ñ [&#60;dmindmax.&#34;dmin&#34;&#62;] Ð³. Ð¿Ð¾ [&#60;dmindmax.&#34;dmax&#34;&#62;] Ð³.              "/>
      <TfrxMemoView Name="Memo4" ShiftMode="smDontShift" Left="0" Top="1" Width="680.31496063" Height="17" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="false" VAlign="vaCenter" Text="ÐÑÐµÐ´Ð¿ÑÐ¸ÑÑÐ¸Ðµ: [CrtFrmQuery.&#34;CrtFrm_LNNm&#34;]"/>
    </TfrxReportTitle>
    <TfrxPageHeader Name="PageHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22.67718" Left="0" Top="132.28355" Visible="false" Width="1009.13451">
      <TfrxMemoView Name="Memo42" ShiftMode="smDontShift" Left="230.62956" Top="0.866109999999992" Width="177.63782213" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Fill.BackColor="16777215" HAlign="haCenter" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="ÐÐ°ÑÐ°: [DATE]"/>
      <TfrxMemoView Name="Memo43" ShiftMode="smDontShift" Left="407.99969" Top="0.866109999999992" Width="136.06299213" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Fill.BackColor="16777215" HAlign="haRight" ParentFont="false" WordBreak="true" VAlign="vaCenter" Text="Ð¡ÑÑÐ°Ð½Ð¸ÑÐ° [PAGE#]"/>
    </TfrxPageHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Äàííûå äëÿ ðàñ÷åòà" Height="185" ClientHeight="146" Left="279" Top="212" Width="369" ClientWidth="353" OnActivate="Page1OnBeforePrint" OnShow="Page1OnShow">
    <TfrxButtonControl Name="Button1" Left="147" Top="115" Width="75" Height="25" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="false" ShowHint="true" Caption="ÎÊ" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="233" Top="115" Width="75" Height="25" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="false" ShowHint="true" Caption="Îòìåíà" ModalResult="2" OnClick="Button2OnClick"/>
    <TfrxLabelControl Name="Label5" Left="36" Top="12" Width="297" Height="60" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Tahoma" Font.Style="0" ParentFont="false" ShowHint="true" AutoSize="false" Caption="Ïåðå÷åíü ïóòåâûõ ëèñòîâ, ïî êîòîðûì ôîðìèðóåòñÿ îò÷åò, îòìå÷àåòñÿ ïåðåä ôîðìèðîâàíèåì îò÷åòà â ðååñòðå ïóòåâûõ ëèñòîâ" Color="-16777201" WordWrap="true"/>
    <TfrxCheckBoxControl Name="CheckBox1" Left="12" Top="84" Width="141" Height="17" ShowHint="true" Caption="Êðàòêèé îò÷åò" Color="15461355"/>
    <TfrxCheckBoxControl Name="CheckBox2" Left="172" Top="84" Width="161" Height="17" ShowHint="true" Caption="Ñ ãðóïïèðîâêîé ïî ìàðêàì" Checked="true" State="cbChecked" Color="15461355"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page3" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="5" BottomMargin="5" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18.89765" Left="0" Top="16" Width="1009.13451" ColumnWidth="0" ColumnGap="0" DataSet="PLSTQuery1" DataSetName="PLSTQuery1" RowCount="0" Stretched="true">
      <TfrxMemoView Name="Memo16" Left="0" Top="0" Width="60.47248" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haCenter" ParentFont="false" Text="[PLstQuery1.&#34;Cdzakaz&#34;]"/>
      <TfrxMemoView Name="Memo18" Left="60.47248" Top="0" Width="94.48825" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;PLst_Nmr&#34;]"/>
      <TfrxMemoView Name="Memo20" Left="805.03989" Top="0" Width="68.03149606" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" Text="[&#60;PLstQuery1.&#34;ÐÐÐÐÐÐÐ2 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo23" Left="737.00835" Top="0" Width="68.03149606" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" Text="[&#60;PLstQuery1.&#34;ÐÐÐÐÐÐÐ1 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo24" Left="873.07117126" Top="0" Width="68.03149606" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" Text="[&#60;PLstQuery1.&#34;ÐÐÐÐÐÐÐ3 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo25" Left="941.10266732" Top="0" Width="68.03149606" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" HAlign="haRight" HideZeros="true" ParentFont="false" Text="[&#60;PLstQuery1.&#34;ÐÐÐÐÐÐÐ4 ÐÐÐ¢ÐÐ§ÐÐ¡Ð«&#34;&#62;]"/>
      <TfrxMemoView Name="Memo26" Left="154.96073" Top="0" Width="75.5906" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;PLst_Dat&#34;]"/>
      <TfrxMemoView Name="Memo28" Left="230.55133" Top="0" Width="98.26778" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;PLst_GNmr&#34;]"/>
      <TfrxMemoView Name="Memo30" Left="657.63822" Top="0" Width="79.37013" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;UF_RkValD&#34;]"/>
      <TfrxMemoView Name="Memo45" Left="521.57514" Top="0" Width="136.06308" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;SG_NM&#34;]"/>
      <TfrxMemoView Name="Memo46" Left="328.81911" Top="0" Width="94.48825" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;AVT_GARNMR&#34;]"/>
      <TfrxMemoView Name="Memo47" Left="423.30736" Top="0" Width="98.26778" Height="18.89765" StretchMode="smMaxHeight" DataSet="PLstQuery" DataSetName="PLstQuery" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="15" ParentFont="false" Text="[PLstQuery1.&#34;SPR_NM&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
