<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="5.4.3" DotMatrixReport="false" IniFile="\Software\Fast Reports" OldStyleProgress="true" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38072,5793798495" ReportOptions.Description.Text="" ReportOptions.Name="FR Импорт данных Ядро Категория" ReportOptions.LastChange="45007,4750197801" ReportOptions.DirectExportType="deRtf" ReportOptions.DirectExportMode="dmOpen" ReportOptions.DirectExportPages="depSingleSheet" ReportOptions.DirectExportChunkSize="0" ScriptLanguage="PascalScript" ScriptText.Text="var rcd:integer;&#13;&#10;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;var StrCeh, StrDol, StrYadro, StrKat, StrRaz, StrKvk, StrTk:string;&#13;&#10;begin&#13;&#10;  //участок&#13;&#10;  StrCeh := Memo38.Lines.Text;&#13;&#10;  //dol&#13;&#10;  StrDol := Memo4.Lines.Text;&#13;&#10;  //raz&#13;&#10;  StrRaz := Memo5.Lines.Text;&#13;&#10;  //kvk&#13;&#10;  StrKvk := Memo6.Lines.Text;&#13;&#10;  //tk&#13;&#10;  StrTk := Memo7.Lines.Text;&#13;&#10;  //yadro&#13;&#10;  StrYadro := Memo48.Lines.Text;&#13;&#10;  //yadro&#13;&#10;  StrKat := Memo58.Lines.Text;&#13;&#10;&#13;&#10;  if StrCeh &#60;&#62; '' then&#13;&#10;    begin&#13;&#10;      while Pos( Chr(13), StrCeh )&#60;&#62;0 do&#13;&#10;        begin&#13;&#10;          Baza.Insert;&#13;&#10;          Baza.FieldByName('Ceh').Value :=Copy( StrCeh, 1, Pos( Chr(13), StrCeh )-1 );&#13;&#10;          Baza.FieldByName('Dol').Value :=Copy( StrDol, 1, Pos( Chr(13), StrDol )-1 );&#13;&#10;          Baza.FieldByName('Raz').Value :=Copy( StrRaz, 1, Pos( Chr(13), StrRaz )-1 );&#13;&#10;          Baza.FieldByName('Kvk').Value :=Copy( StrKvk, 1, Pos( Chr(13), StrKvk )-1 );&#13;&#10;          Baza.FieldByName('Tk').Value :=Copy( StrTk, 1, Pos( Chr(13), StrTk )-1 );&#13;&#10;          Baza.FieldByName('Yadro').Value :=Copy( StrYadro, 1, Pos( Chr(13), StrYadro )-1 );&#13;&#10;          Baza.FieldByName('Kat').Value :=Copy( StrKat, 1, Pos( Chr(13), StrKat )-1 );&#13;&#10;          Baza.Post;&#13;&#10;&#13;&#10;          DeleteStr(StrCeh, 1, Pos(Chr(13),StrCeh)+1 );&#13;&#10;          DeleteStr(StrDol, 1, Pos(Chr(13),StrDol)+1 );&#13;&#10;          DeleteStr(StrRaz, 1, Pos(Chr(13),StrRaz)+1 );&#13;&#10;          DeleteStr(StrKvk, 1, Pos(Chr(13),StrKvk)+1 );&#13;&#10;          DeleteStr(StrTk, 1, Pos(Chr(13),StrTk)+1 );&#13;&#10;          DeleteStr(StrYadro, 1, Pos(Chr(13),StrYadro)+1 );&#13;&#10;          DeleteStr(StrKat, 1, Pos(Chr(13),StrKat)+1 );&#13;&#10;        end;&#13;&#10;&#13;&#10;      if ((Pos( Chr(13), StrCeh )=0) and (StrCeh&#60;&#62;'')) then&#13;&#10;        begin&#13;&#10;          Baza.Insert;&#13;&#10;          Baza.FieldByName('Ceh').Value :=StrCeh;&#13;&#10;          Baza.FieldByName('Dol').Value :=StrDol;&#13;&#10;          Baza.FieldByName('Raz').Value :=StrRaz;&#13;&#10;          Baza.FieldByName('Kvk').Value :=StrKvk;&#13;&#10;          Baza.FieldByName('Tk').Value :=StrTk;&#13;&#10;          Baza.FieldByName('Yadro').Value :=StrYadro;&#13;&#10;          Baza.FieldByName('Kat').Value :=StrKat;&#13;&#10;          Baza.Post;&#13;&#10;        end;&#13;&#10;    end;&#13;&#10;  Baza.Close;&#13;&#10;  Baza.First;&#13;&#10;  // защита от дурака. Если пользователь не равен мне, то ему сообщение без записи в базу&#13;&#10; // if vartostr(BPRO.USER_RCD)='309' then    // Елена Коваленко&#13;&#10;  if vartostr(BPRO.USER_RCD)='309' then&#13;&#10;    begin&#13;&#10;      WHILE NOT Baza.EOF DO&#13;&#10;        begin&#13;&#10;          if (&#60;Baza.&#34;Ceh&#34;&#62; &#60;&#62; '') and (&#60;Baza.&#34;Dol&#34;&#62; &#60;&#62; '') and (&#60;Baza.&#34;Yadro&#34;&#62; &#60;&#62; '') and (&#60;Baza.&#34;Kat&#34;&#62; &#60;&#62; '') and (rcd &#60;&#62; null) then&#13;&#10;            begin&#13;&#10;               {INSERT INTO table_name (column1, column2, column3, ...)&#13;&#10;               VALUES (value1, value2, value3, ...); }&#13;&#10;&#13;&#10;              {INSVAL.SQL.Text := '';&#13;&#10;              INSVAL.SQL.Text := 'INSERT INTO UFPRV(UF_TblId, UF_TblRcd, UF_RkRcd, UF_RkValS)'+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' VALUES ('+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '2043, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' (select KdrSRSP_Rcd '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   from KdrSRSp '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   where '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   KdrSRSP_CtRcd='+IntToStr(rcd)+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_PdCd='''+&#60;Baza.&#34;Ceh&#34;&#62;+''''+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and (KdrSRSP_Prf='''+&#60;Baza.&#34;Dol&#34;&#62;+''' or KdrSRSP_Dol='''+&#60;Baza.&#34;Dol&#34;&#62;+''')), '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '109, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ''+&#60;Baza.&#34;Yadro&#34;&#62;+')'+CHR(13); }&#13;&#10;&#13;&#10;              INSVAL.SQL.Text := '';&#13;&#10;              INSVAL.SQL.Text := 'INSERT INTO UFPRV(UF_TblId, UF_TblRcd, UF_RkRcd, UF_RkValN)'+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' SELECT  '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' 2043 as UF_TblId, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' KdrSRSP_Rcd as UF_TblRcd, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' 111 as UF_RkRcd, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ''+&#60;Baza.&#34;Yadro&#34;&#62;+' as UF_RkValN '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' FROM KdrSRSp  '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' WHERE '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   KdrSRSP_CtRcd='+IntToStr(rcd)+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_PdCd='''+&#60;Baza.&#34;Ceh&#34;&#62;+''''+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_Raz='+&#60;Baza.&#34;Raz&#34;&#62;+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_KvK='+&#60;Baza.&#34;Kvk&#34;&#62;+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_STKCd='+&#60;Baza.&#34;Tk&#34;&#62;+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and (KdrSRSP_Prf='''+&#60;Baza.&#34;Dol&#34;&#62;+''' or KdrSRSP_Dol='''+&#60;Baza.&#34;Dol&#34;&#62;+''') '+CHR(13);&#13;&#10;&#13;&#10;              INSVAL.ExecSQL();&#13;&#10;&#13;&#10;&#13;&#10;              INSVAL.SQL.Text := '';&#13;&#10;              INSVAL.SQL.Text := 'INSERT INTO UFPRV(UF_TblId, UF_TblRcd, UF_RkRcd, UF_RkValN)'+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' SELECT  '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' 2043 as UF_TblId, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' KdrSRSP_Rcd as UF_TblRcd, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' 112 as UF_RkRcd, '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ''+&#60;Baza.&#34;Kat&#34;&#62;+' as UF_RkValN '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' FROM KdrSRSp  '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + ' WHERE '+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   KdrSRSP_CtRcd='+IntToStr(rcd)+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_PdCd='''+&#60;Baza.&#34;Ceh&#34;&#62;+''''+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_Raz='+&#60;Baza.&#34;Raz&#34;&#62;+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_KvK='+&#60;Baza.&#34;Kvk&#34;&#62;+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and KdrSRSP_STKCd='+&#60;Baza.&#34;Tk&#34;&#62;+CHR(13);&#13;&#10;              INSVAL.SQL.Text := INSVAL.SQL.Text + '   and (KdrSRSP_Prf='''+&#60;Baza.&#34;Dol&#34;&#62;+''' or KdrSRSP_Dol='''+&#60;Baza.&#34;Dol&#34;&#62;+''') '+CHR(13);&#13;&#10;&#13;&#10;              INSVAL.ExecSQL();&#13;&#10;            end;&#13;&#10;          Baza.Next;&#13;&#10;        end;&#13;&#10;      showmessage('Записано!');&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      showmessage('Вам не дозволено вносить изменения!');&#13;&#10;    end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;  Baza.AddStringField('Ceh',20);&#13;&#10;  Baza.AddStringField('Dol',50);&#13;&#10;  Baza.AddStringField('Yadro',20);&#13;&#10;  Baza.AddStringField('Kat',20);&#13;&#10;  Baza.AddStringField('Raz',20);&#13;&#10;  Baza.AddStringField('Kvk',20);&#13;&#10;  Baza.AddStringField('Tk',20);&#13;&#10;  Baza.CreateDataSet;&#13;&#10;&#13;&#10;  dsBaseInfo.Locate( 'NAME', 'KDRSRCT', loCaseInsensitive );&#13;&#10;  rcd:=&#60;dsBaseInfo.&#34;RCD&#34;&#62;;&#13;&#10;end.">
  <Datasets>
    <item DataSet="dsBaseInfo" DataSetName="dsBaseInfo"/>
    <item DataSet="dsMark" DataSetName="dsMark"/>
    <item DataSet="insval" DataSetName="insval"/>
    <item DataSet="Baza" DataSetName="Baza"/>
  </Datasets>
  <Variables>
    <item Name=" Бест-Звит" Value="True"/>
    <item Name="ZvitPeriodType" Value="0"/>
    <item Name="ZvitCharCode" Value="0"/>
    <item Name="ZvitPeriodDate" Value="0"/>
  </Variables>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxODBCQuery Name="insval" UserName="insval" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" IgnoreDupParams="false" SQL.Text="" PreprocessSQLText="true" SQLZeroCols="false" PropData="05704C6566740390000470546F7002180A506172616D65746572730100"/>
    <TfrxDBFTable Name="Baza" UserName="Baza" CloseDataSource="true" FieldAliases.Text="" BCDToCurrency="false" TableName="Baza.DBF" Storage="stoMemory" OpenMode="omTemporary" FilePath="d:\ZVIT\" TableLevel="dbfxBaseIV" PropData="05704C65667402440470546F700218"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Page2" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Height="432" ClientHeight="393" Left="220" Top="120" Width="746" ClientWidth="730">
    <TfrxButtonControl Name="Button1" Left="304" Top="316" Width="75" Height="25" Font.Charset="1" Font.Color="255" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="false" ShowHint="true" Caption="запись" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="388" Top="356" Width="75" Height="25" ShowHint="true" Caption="отмена" ModalResult="2"/>
    <TfrxMemoControl Name="Memo38" Left="12" Top="44" Width="125" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0"/>
    <TfrxMemoControl Name="Memo48" Left="484" Top="44" Width="105" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0"/>
    <TfrxMemoControl Name="Memo58" Left="596" Top="44" Width="121" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0"/>
    <TfrxButtonControl Name="Button3" Left="304" Top="356" Width="75" Height="25" ShowHint="true" Caption="OK" ModalResult="1"/>
    <TfrxLabelControl Name="Label1" Left="528" Top="24" Width="25" Height="13" ShowHint="true" Caption="ядро" Color="-16777201" OnClick="Label1OnClick"/>
    <TfrxLabelControl Name="Label2" Left="628" Top="24" Width="53" Height="13" ShowHint="true" Caption="категория" Color="15461355"/>
    <TfrxMemoControl Name="Memo4" Left="144" Top="44" Width="125" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0" OnClick="Memo4OnClick"/>
    <TfrxLabelControl Name="Label3" Left="40" Top="24" Width="41" Height="13" ShowHint="true" Caption="участок" Color="15461355"/>
    <TfrxLabelControl Name="Label4" Left="168" Top="24" Width="78" Height="13" ShowHint="true" Caption="код должности" Color="15461355"/>
    <TfrxMemoControl Name="Memo5" Left="276" Top="44" Width="73" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0" OnClick="Memo4OnClick"/>
    <TfrxLabelControl Name="Label5" Left="280" Top="24" Width="36" Height="13" ShowHint="true" Caption="разряд" Color="15461355" OnClick="Label5OnClick"/>
    <TfrxMemoControl Name="Memo6" Left="356" Top="44" Width="53" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0"/>
    <TfrxMemoControl Name="Memo7" Left="416" Top="44" Width="61" Height="261" ShowHint="true" Color="-16777211" Lines.Text="" MaxLength="0"/>
    <TfrxLabelControl Name="Label6" Left="356" Top="4" Width="55" Height="30" ShowHint="true" AutoSize="false" Caption="Кваліфікаційна категорія" Color="15461355" WordWrap="true"/>
    <TfrxLabelControl Name="Label7" Left="424" Top="4" Width="55" Height="38" ShowHint="true" AutoSize="false" Caption="Рядок довідника ТК - код" Color="15461355" WordWrap="true"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22,67718" Left="0" Top="16" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Baza" DataSetName="Baza" RowCount="0">
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="false" Text="[Baza.&#34;Tbn&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="94,48825" Top="0" Width="245,66945" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="false" Text="[Baza.&#34;Nom&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="340,1577" Top="0" Width="245,66945" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="false" Text="[Baza.&#34;Dat&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
